import{a as o,t as p,b as l,h as ze,d as ge,f as Ae,e as Ee}from"../chunks/disclose-version.KQatKnwM.js";import{i as Le}from"../chunks/legacy.D--LHvfs.js";import{p as Ne,t as c,a as Oe,c as r,r as e,s as a,f as W,o as Ce,l as Fe,b as He,g as t,d as A,m as ae}from"../chunks/index-client.BSaxjCgd.js";import{p as Pe,i as _}from"../chunks/props.CH69RCtx.js";import{a as De,e as me,i as be}from"../chunks/index.DsSMAhLM.js";import{s as de}from"../chunks/class.Beg04Fd9.js";import{a as Be}from"../chunks/index.vKWVQZ4k.js";import{S as Me}from"../chunks/StatusBadge.CaO23Fkx.js";import{L as Ge}from"../chunks/Loading.DkR_FJp9.js";import{E as qe}from"../chunks/ErrorDisplay.DZ0Gu5b_.js";import{S as Re,E as ke,t as Ke}from"../chunks/EvaluationResults.BAMCpLbq.js";import{f as Qe,i as Ue}from"../chunks/intervalToDuration.BpIG60gY.js";var Ve=p('<div><div class="text-2xl font-bold mb-1"><span> </span></div> <div>Tasks Passed</div> <div class="text-sm text-gray-500 mt-1"> </div></div>'),We=p('<div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-gray-300"></div> <span> </span></div>'),Xe=p('<div class="flex gap-1 h-2 rounded-full overflow-hidden bg-gray-100 w-full"><div class="bg-green-500"></div> <div class="bg-red-500"></div> <div class="bg-gray-300"></div></div> <div class="flex gap-6 text-sm mt-2"><div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-green-500"></div> <span> </span></div> <div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-red-500"></div> <span> </span></div> <!></div>',1),Ye=p('<div class="p-8 border-b"><div class="flex justify-between items-start mb-6"><div><h1 class="text-4xl font-bold mb-2"> </h1> <div class="text-gray-600"> </div></div> <!></div> <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-6"><div><h3 class="text-sm font-medium text-gray-500">Project</h3> <p class="mt-1 text-lg"> </p></div> <div><h3 class="text-sm font-medium text-gray-500">Status</h3> <p class="mt-1"><!></p></div> <div><h3 class="text-sm font-medium text-gray-500">Created</h3> <p class="mt-1 text-lg"> </p></div> <div><h3 class="text-sm font-medium text-gray-500">Model</h3> <p class="mt-1 text-lg"> </p></div></div> <!></div>');function Ze(fe,X){Ne(X,!1);let $=Pe(X,"runDetails",8),i=Pe(X,"taskStats",8);Le();var N=Ye(),E=r(N),O=r(E),M=r(O),ie=r(M);c(()=>l(ie,`Run Report: ${$().id.slice(-8)??""}`)),e(M);var C=a(M,2),xe=r(C);c(()=>l(xe,`Generated on ${new Date().toLocaleString()??""}`)),e(C),e(O);var u=a(O,2);_(u,i,T=>{var b=Ve(),x=r(b),y=r(x),K=r(y);e(y),e(x);var I=a(x,2),P=a(I,2),R=r(P);c(()=>l(R,`Avg Score: ${(i().avgScore*100).toFixed(0)??""}%`)),e(P),e(b),c(()=>{de(b,`text-center px-6 py-4 rounded-lg ${i().failed===0?"bg-green-50 border-2 border-green-200":"bg-red-50 border-2 border-red-200"}`),de(y,i().failed===0?"text-green-600":"text-red-600"),l(K,`${i().completed??""}/${i().total??""}`),de(I,`text-sm ${i().failed===0?"text-green-600":"text-red-600"}`)}),o(T,b)}),e(E);var n=a(E,2),h=r(n),F=a(r(h),2),se=r(F,!0);e(F),e(h);var Y=a(h,2),H=a(r(Y),2),B=r(H);Me(B,{get status(){return $().status}}),e(H),e(Y);var G=a(Y,2),q=a(r(G),2),he=r(q,!0);c(()=>l(he,new Date($().date).toLocaleString())),e(q),e(G);var Z=a(G,2),oe=a(r(Z),2),ye=r(oe,!0);e(oe),e(Z),e(n);var d=a(n,2);_(d,i,T=>{var b=Xe(),x=W(b),y=r(x),K=a(y,2),I=a(K,2);e(x);var P=a(x,2),R=r(P),ve=a(r(R),2),ne=r(ve);e(ve),e(R);var Q=a(R,2),le=a(r(Q),2),ce=r(le);e(le),e(Q);var pe=a(Q,2);_(pe,()=>i().inProgress>0,ee=>{var U=We(),te=a(r(U),2),we=r(te);e(te),e(U),c(()=>l(we,`${i().inProgress??""} in progress`)),o(ee,U)}),e(P),c(()=>{De(y,"style",`width: ${i().completed/i().total*100}%`),De(K,"style",`width: ${i().failed/i().total*100}%`),De(I,"style",`width: ${i().inProgress/i().total*100}%`),l(ne,`${i().completed??""} completed`),l(ce,`${i().failed??""} failed`)}),o(T,b)}),e(N),c(()=>{l(se,$().project.name),l(ye,$().details.model||"N/A")}),o(fe,N),Oe()}var et=p(`<style>@media screen {
            body {
                background: white;
                margin: 0;
                padding: 0;
            }
        }
        @media print {
            @page {
                margin: 1.5cm;
                size: A4;
            }
            body {
                margin: 0;
                padding: 0;
                color: black;
                background: white;
                font-size: 11pt;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            .no-print {
                display: none !important;
            }
            /* Ensure backgrounds and colors are printed */
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            /* Enhance borders for better print visibility */
            .border {
                border-width: 1.5px !important;
            }
            .border-b {
                border-bottom-width: 1.5px !important;
            }
            /* Enhance text contrast for print */
            .text-gray-500 {
                color: #4a5568 !important;
            }
            .text-gray-600 {
                color: #2d3748 !important;
            }
        }
        /* Hide header and footer */
        nav, footer, header {
            display: none !important;
        }</style>`),tt=p('<div><h4 class="text-sm font-semibold mb-2">Input</h4> <div class="bg-gray-50 p-4 rounded border border-gray-200 whitespace-pre-wrap font-mono text-xs"> </div></div>'),rt=p('<div><h4 class="text-sm font-semibold mb-2">Output</h4> <div class="bg-gray-50 p-4 rounded border border-gray-200 whitespace-pre-wrap font-mono text-xs"> </div></div>'),at=p('<div><div class="text-sm font-medium text-gray-600 mb-1"> </div> <div class="bg-gray-50 p-3 rounded border border-gray-200 whitespace-pre-wrap font-mono text-xs"> </div></div>'),dt=p('<div><h4 class="text-sm font-semibold mb-2">Details</h4> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3"></div></div>'),it=p('<div><h4 class="text-sm font-semibold mb-3">Evaluation Results</h4> <!></div>'),st=p("<span> </span>"),ot=p('<div class="p-3"><!></div>'),vt=p('<div class="mb-4 border rounded-lg overflow-hidden"><div class="flex items-center justify-between bg-gray-100 p-3 border-b"><h5 class="text-sm font-medium capitalize"> </h5> <div class="flex items-center"><!> <div><!></div></div></div> <!></div>'),nt=p('<div><h4 class="text-sm font-semibold mb-3">Evaluation Results</h4> <!></div>'),lt=p('<div><div class="text-sm font-medium text-gray-600 mb-1"> </div> <div class="bg-gray-50 p-3 rounded border border-gray-200 whitespace-pre-wrap font-mono text-xs"> </div></div>'),ct=p('<div><h4 class="text-sm font-semibold mb-2">Evaluation Details</h4> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3"></div></div>'),pt=p('<div class="task-card mb-8 border rounded-lg overflow-hidden"><div><div><h3 class="text-lg font-bold"> </h3> <div class="text-sm text-gray-500 mt-1"> <!> <!></div></div> <div class="flex items-center gap-4"><!> <!></div></div> <div class="p-6"><div class="grid grid-cols-1 lg:grid-cols-2 gap-8"><div class="space-y-6"><!> <!> <!></div> <div class="space-y-6 lg:border-l lg:pl-8"><!> <!></div></div></div></div>'),_t=p('<!> <div class="p-8"><h2 class="text-2xl font-bold mb-6">Tasks</h2> <!></div> <div class="fixed bottom-4 right-4 no-print"><button class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded shadow">Print Report</button></div>',1),ut=p('<div class="text-center text-gray-500 p-8">No run found</div>'),gt=p('<div class="min-h-screen bg-white"><!></div>');function Pt(fe,X){Ne(X,!1);const $=ae();let i=ae(null),N=ae(!0),E=ae(null),O=ae(null);function M(){const u=window.location.hash.slice(1);if(u){const[n,h]=u.split("/");n&&h&&(A(O,h),ie(t(O)))}}Ce(()=>(M(),window.addEventListener("hashchange",M),()=>{window.removeEventListener("hashchange",M)}));async function ie(u){A(N,!0),A(E,null);try{A(i,await Be(u))}catch(n){A(E,n instanceof Error?n.message:"Failed to load run details"),console.error(n)}finally{A(N,!1)}}Fe(()=>t(i),()=>{var u;A($,(u=t(i))!=null&&u.tasks?{total:t(i).tasks.length,completed:t(i).tasks.filter(n=>n.status==="completed").length,failed:t(i).tasks.filter(n=>n.status==="failed").length,inProgress:t(i).tasks.filter(n=>!["completed","failed"].includes(n.status)).length,avgScore:t(i).tasks.reduce((n,h)=>n+(h.eval_score||0),0)/t(i).tasks.length}:null)}),He(),Le();var C=gt();ze(u=>{var n=et();o(u,n)});var xe=r(C);_(xe,()=>t(N),u=>{Ge(u,{message:"Loading run details..."})},u=>{var n=ge(),h=W(n);_(h,()=>t(E),F=>{qe(F,{get errorMessage(){return t(E)},onRetry:()=>ie(t(O))})},F=>{var se=ge(),Y=W(se);_(Y,()=>t(i),H=>{var B=_t(),G=W(B);Ze(G,{get runDetails(){return t(i)},get taskStats(){return t($)}});var q=a(G,2),he=a(r(q),2);me(he,1,()=>t(i).tasks,be,(ye,d)=>{var T=pt(),b=r(T),x=r(b),y=r(x),K=r(y);c(()=>l(K,`Task ${t(d).id.slice(-8)??""}`)),e(y);var I=a(y,2),P=r(I);c(()=>l(P,`${new Date(t(d).created_at).toLocaleString()??""} `));var R=a(P);_(R,()=>t(d).finished_at,v=>{var s=Ee();c(()=>l(s,`· ${Qe(Ue({start:new Date(t(d).created_at),end:new Date(t(d).finished_at)}),{format:["minutes","seconds"]})??""}`)),o(v,s)});var ve=a(R,2);_(ve,()=>{var v;return(v=t(d).task_details)==null?void 0:v.model},v=>{var s=Ee();c(()=>l(s,`· ${t(d).task_details.model??""}`)),o(v,s)}),e(I),e(x);var ne=a(x,2),Q=r(ne);Me(Q,{get status(){return t(d).status},className:"px-3 py-1"});var le=a(Q,2);_(le,()=>t(d).eval_score!==null,v=>{Re(v,{get score(){return t(d).eval_score},includePrintStyles:!0,showMinScore:!1})}),e(ne),e(b);var ce=a(b,2),pe=r(ce),ee=r(pe),U=r(ee);_(U,()=>t(d).task_input,v=>{var s=tt(),g=a(r(s),2),f=r(g,!0);c(()=>l(f,typeof t(d).task_input=="object"&&"str"in t(d).task_input?t(d).task_input.str:JSON.stringify(t(d).task_input,null,2))),e(g),e(s),o(v,s)});var te=a(U,2);_(te,()=>t(d).task_output,v=>{var s=rt(),g=a(r(s),2),f=r(g,!0);c(()=>l(f,typeof t(d).task_output=="object"&&"str"in t(d).task_output?t(d).task_output.str:JSON.stringify(t(d).task_output,null,2))),e(g),e(s),o(v,s)});var we=a(te,2);_(we,()=>t(d).task_details,v=>{var s=dt(),g=a(r(s),2);me(g,5,()=>Object.entries(t(d).task_details),be,(f,D)=>{let k=()=>t(D)[0],w=()=>t(D)[1];var m=at(),j=r(m),J=r(j,!0);e(j);var S=a(j,2),z=r(S,!0);c(()=>l(z,typeof w()=="string"?k()==="prompt"?Ke(w()):w():JSON.stringify(w(),null,2))),e(S),e(m),c(()=>l(J,k())),o(f,m)}),e(g),e(s),o(v,s)}),e(ee);var je=a(ee,2),$e=r(je);_($e,()=>{var v;return(v=t(d).eval_details)==null?void 0:v.evaluations},v=>{var s=it(),g=a(r(s),2);ke(g,{get evaluations(){return t(d).eval_details.evaluations},get evalSpec(){return t(d).eval_spec},includePrintStyles:!0,filter:""}),e(s),o(v,s)},v=>{var s=ge(),g=W(s);_(g,()=>{var f;return(f=t(d).eval_details)==null?void 0:f.metrics},f=>{var D=nt(),k=a(r(D),2);me(k,1,()=>t(d).eval_details.metrics,be,(w,m)=>{var j=vt(),J=r(j),S=r(J),z=r(S,!0);e(S);var _e=a(S,2),re=r(_e);_(re,()=>t(m).passed!==void 0,V=>{var L=st(),Se=r(L,!0);e(L),c(()=>{de(L,`mr-2 text-xs px-2 py-0.5 rounded-full ${(t(m).passed?"bg-green-100 text-green-800 print:bg-green-50 border border-green-300":"bg-red-100 text-red-800 print:bg-red-50 border border-red-300")??""}`),l(Se,t(m).passed?"Passed":"Failed")}),o(V,L)});var ue=a(re,2),Ie=r(ue);Re(Ie,{get score(){return t(m).score},includePrintStyles:!0,showMinScore:!1}),e(ue),e(_e),e(J);var Je=a(J,2);_(Je,()=>{var V;return(V=t(m).details)==null?void 0:V.evaluations},V=>{var L=ot(),Se=r(L);ke(Se,{get evaluations(){return t(m).details.evaluations},get evalSpec(){return t(d).eval_spec},includePrintStyles:!0,filter:""}),e(L),o(V,L)}),e(j),c(()=>l(z,t(m).metric_type)),o(w,j)}),e(D),o(f,D)},null,!0),o(v,s)});var Te=a($e,2);_(Te,()=>t(d).eval_details,v=>{var s=ct(),g=a(r(s),2);me(g,5,()=>Object.entries(t(d).eval_details),be,(f,D)=>{let k=()=>t(D)[0],w=()=>t(D)[1];var m=ge(),j=W(m);_(j,()=>k()!=="evaluations"&&k()!=="metrics",J=>{var S=lt(),z=r(S),_e=r(z,!0);e(z);var re=a(z,2),ue=r(re,!0);c(()=>l(ue,typeof w()=="string"?w():JSON.stringify(w(),null,2))),e(re),e(S),c(()=>l(_e,k())),o(J,S)}),o(f,m)}),e(g),e(s),o(v,s)}),e(je),e(pe),e(ce),e(T),c(()=>de(b,`p-4 flex justify-between items-center
                        ${t(d).status==="completed"?"bg-green-50 border-b-2 border-green-200 print:border-green-300":t(d).status==="failed"?"bg-red-50 border-b-2 border-red-200 print:border-red-300":"bg-gray-50 border-b-2 border-gray-200 print:border-gray-300"}`)),o(ye,T)}),e(q);var Z=a(q,2),oe=r(Z);e(Z),Ae("click",oe,()=>window.print()),o(H,B)},H=>{var B=ut();o(H,B)},!0),o(F,se)},!0),o(u,n)}),e(C),o(fe,C),Oe()}export{Pt as component};
