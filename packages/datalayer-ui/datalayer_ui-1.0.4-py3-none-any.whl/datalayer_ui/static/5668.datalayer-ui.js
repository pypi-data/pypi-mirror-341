"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[5668],{46916:(e,s,a)=>{a.d(s,{E:()=>l});var n=a(71791),t=a(99180),i=a(38621),o=a(9387),r=a(18683);function l(e){const{commandRegistry:s,kernelDesc:a,save:l,sessionConnection:c}=e,[d,u]=(0,o.useState)();return(0,o.useEffect)((()=>{const e=()=>{u(c?.kernel?.status)};return e(),c?.statusChanged.connect(e),c?.connectionStatusChanged.connect(e),()=>{c?.statusChanged.disconnect(e),c?.connectionStatusChanged.disconnect(e)}}),[c]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.Q,{variant:"invisible",size:"small",leadingVisual:i.iKr,disabled:void 0===a?.location,onClick:l,children:"Save"}),(0,r.jsx)(t.Q,{variant:"invisible",size:"small",leadingVisual:i.udU,disabled:!a?.location||"busy"===d,onClick:e=>{s?.execute(n.nx.runAll)},children:"Run all"}),(0,r.jsx)(t.Q,{variant:"invisible",size:"small",leadingVisual:i.wFz,disabled:!a?.location||"busy"!==d,onClick:e=>{s?.execute(n.nx.interrupt)},children:"Interrupt"})]})}},95668:(e,s,a)=>{a.r(s),a.d(s,{LessonEdit:()=>B,default:()=>w});var n=a(9387),t=a(20568),i=a(3345),o=a(7856),r=a(98754),l=a(3556),c=a(99180),d=a(27698),u=a(64315),h=a(68125),m=a(92243),p=a(38621),x=a(2159),v=a(16476),y=a(74087),g=a(46916),f=a(17810),j=a(23530),b=a(53850),k=a(97734),A=a(50906),C=a(54520),S=a(18683);const B=()=>{const e=(0,n.useMemo)((()=>[new x._]),[]),{lessonId:s}=(0,t.g)();if(!s)return(0,S.jsx)(S.Fragment,{});const a=(0,f.J)(),B=(0,i.S)(),w=(0,j.Z)(),E=(0,A.mt)(),I=(0,v.Gx)(),N=E.layout().space,R=(0,C.OK)().saveRequest,z=I.selectNotebookModel(s),{cloneLesson:L,getLesson:O,refreshLesson:T,updateNotebook:V,updateNotebookModel:F}=(0,b.E)(),[Q,_]=(0,n.useState)("editor"),{enqueueToast:D}=(0,k.d)(),[M,P]=(0,n.useState)(),[J,q]=(0,n.useState)({name:"",description:""}),[K,U]=(0,n.useState)({name:void 0,description:void 0}),$=(e,s)=>{s.preventDefault(),E.layout().resetRightPortal(),_(e)};(0,n.useEffect)((()=>(E.layout().showBackdrop(),T(s).then((e=>{if(E.layout().hideBackdrop(),e.success){const e=O(s);e?(P(e),E.layout().setItem(e),q({name:e.name,description:e.description})):w("/")}})).finally((()=>{E.layout().hideBackdrop()})),()=>{P(void 0),I.reset(),E.layout().setItem(void 0)})),[s]);const G=()=>{z?.model?.cells&&(E.layout().showBackdrop("Saving the lesson..."),F(s,z.model.toJSON()).then((e=>{e.success&&(D("The lesson is successfully updated.",{variant:"success"}),E.layout().triggerItemsRefresh(),P({...M,nbformat:z.model.toJSON()}))})).finally((()=>{E.layout().hideBackdrop()})))};(0,n.useEffect)((()=>{R&&M&&G()}),[R]),(0,n.useEffect)((()=>{U({...K,name:void 0===J.name?void 0:J.name.length>2,description:void 0===J.description?void 0:J.description.length>2})}),[J]);const H=(0,n.useCallback)((async e=>{B({title:"Are you sure?",content:"Please confirm you want to clone this lesson in your private library."}).then((e=>{e&&(E.layout().showBackdrop(),L(s).then((e=>{E.layout().hideBackdrop(),e.success&&(D(e.message,{variant:"success"}),E.layout().triggerItemsRefresh(),w(`/${a?.handle}/library/lessons`))})).finally((()=>{E.layout().hideBackdrop()})))}))}),[B,M]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(o.z,{children:(0,S.jsxs)(r.A,{display:"flex",children:[(0,S.jsx)(r.A,{flex:1,children:(0,S.jsx)(l.A,{sx:{fontSize:3},children:"Lesson editor"})}),"editor"===Q&&(0,S.jsx)(r.A,{children:(0,S.jsx)(g.E,{commandRegistry:I.selectNotebookAdapter(s)?.commands,save:G})}),M&&N&&(0,S.jsx)(r.A,{children:(0,S.jsx)(c.Q,{variant:"invisible",size:"small",leadingVisual:p.Nc$,onClick:H,children:"Clone"})})]})}),M&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(d.O,{sx:{mt:3,mb:3},children:[(0,S.jsx)(d.O.Item,{href:"","aria-label":"","aria-current":"editor"===Q?"page":void 0,onClick:e=>$("editor",e),children:"Editor"}),(0,S.jsx)(d.O.Item,{href:"","aria-label":"","aria-current":"properties"===Q?"page":void 0,onClick:e=>$("properties",e),children:"Properties"})]}),"editor"===Q&&(0,S.jsx)(r.A,{children:M.nbformat&&(0,S.jsx)(y.g,{id:s,height:"calc(100vh - 240px)",maxHeight:"calc(100vh - 240px)",cellMetadataPanel:!0,nbformat:M.nbformat,extensions:e})}),"properties"===Q&&(0,S.jsx)(r.A,{display:"grid",gridTemplateColumns:"1fr 1fr",children:(0,S.jsx)(r.A,{children:(0,S.jsxs)(r.A,{sx:{label:{marginTop:2}},children:[(0,S.jsxs)(u.A,{children:[(0,S.jsx)(u.A.Label,{children:"Name"}),(0,S.jsx)(h.A,{block:!0,value:J.name,onChange:e=>{q((s=>({...s,name:e.target.value})))}}),!1===K.name&&(0,S.jsx)(u.A.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,S.jsxs)(u.A,{children:[(0,S.jsx)(u.A.Label,{children:"Description"}),(0,S.jsx)(m.Ay,{block:!0,value:J.description,onChange:e=>{q((s=>({...s,description:e.target.value})))}}),!1===K.description&&(0,S.jsx)(u.A.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,S.jsx)(u.A,{children:(0,S.jsx)(c.Q,{variant:"primary",disabled:!K.name||!K.description,sx:{marginTop:2},onClick:async()=>{E.layout().showBackdrop(),V(s,J.name,J.description).then((e=>{E.layout().hideBackdrop(),e.success&&(D("The lesson is successfully updated.",{variant:"success"}),E.layout().triggerItemsRefresh(),P({...M,name:J.name,description:J.description}))})).finally((()=>{E.layout().hideBackdrop()}))},children:"Update lesson"})})]})})})]})]})},w=B}}]);