"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[3206],{23206:(e,t,n)=>{n.r(t),n.d(t,{NotebookEdit:()=>at,default:()=>rt});var s=n(9387),a=n(20568),r=n(97789),i=n(16950),o=n(3345),l=n(7856),c=n(98754),d=n(99180),u=n(93054),m=n(48453),h=n(64315),p=n(68125),g=n(92243),f=n(3556),x=n(80006),v=n(38621),b=n(42389),j=n(16476),y=n(2159),k=n(5700),C=n(2606),A=n(72217),w=n(9403),S=n(18683);const _=e=>{const{data:t,fileName:n,variant:s,extension:a}=e;return(0,S.jsx)(d.Q,{variant:s,leadingVisual:v.s3U,onClick:e=>(0,w.xD)(t,n,a),children:"Download"})};_.defaultProps={variant:"default",name:"data",extension:"json"};var T=n(154),I=n(88106),R=n(59179),N=n(5279),P=n(9175),E=n(65047),D=n(3316),L=n(63948),$=n(43),U=n(39920),M=n(51857),V=function(e){return e[e.None=0]="None",e[e.New=1]="New",e[e.Transfer=2]="Transfer",e}(V||{});function z(e){const{assignKernel:t,sessionConnection:n}=e,{remoteKernels:a,multiServiceManager:r,jupyterLabAdapter:i}=(0,M.xb)(),[o,l]=(0,s.useState)(),[u,m]=(0,s.useState)({}),[h,p]=(0,s.useState)(V.None),[g,f]=(0,s.useState)("");(0,s.useEffect)((()=>{if(n){function e(e){f(`Runtime ${e.kernel?.connectionStatus} - Status: ${e.kernel?.status}`)}return e(n),n?.statusChanged.connect(e),n?.connectionStatusChanged.connect(e),()=>{n?.statusChanged.disconnect(e),n?.connectionStatusChanged.disconnect(e)}}f("No kernel")}),[n]);const x=(0,s.useCallback)((async()=>{r?.remote?.kernels&&await r.remote.kernels.refresh()}),[r?.remote?.kernels]),b=(0,s.useCallback)((()=>{p(V.New)}),[]),j=(0,s.useCallback)((e=>{if(e)switch(h){case V.New:x().then((()=>{l("remote"),t({kernelDesc:e,kernelModel:r?.remote?.kernels.get().find((t=>t.id===e.id))})}));break;case V.Transfer:l("remote"),t({kernelDesc:e,transferState:!0})}p(V.None)}),[x,r?.remote,h]);return(0,s.useEffect)((()=>{i?Promise.all([i.jupyterLab.resolveOptionalService(N.co),i.jupyterLab.resolveOptionalService(R.zG)]).then((e=>{m({[N.co.name]:e[0],[R.zG.name]:e[1]})})):m({})}),[i]),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(P.W,{children:[(0,S.jsx)(P.W.Button,{leadingVisual:()=>{switch(o){case"browser":return(0,S.jsx)(L.A,{});case"remote":return(0,S.jsx)(v.hpF,{});case void 0:return(0,S.jsx)(v.bMW,{})}return(0,S.jsx)(T.Cx,{type:"kernel"})},trailingVisual:()=>n?(0,S.jsx)(c.A,{sx:{paddingTop:"5px"},children:(0,S.jsx)(I.T1,{kernel:n.kernel})}):(0,S.jsx)(S.Fragment,{}),variant:"invisible",children:(0,S.jsx)(E.m,{text:g,direction:"s",children:(0,S.jsx)(d.Q,{variant:"invisible",children:n?.kernel?.name??"Runtimes"})})}),(0,S.jsx)(P.W.Overlay,{width:"medium",children:(0,S.jsxs)(D.l,{selectionVariant:"single",showDividers:!0,children:[(0,S.jsxs)(D.l.Group,{children:[(0,S.jsxs)(D.l.Item,{selected:void 0===o,onSelect:()=>{l(void 0),t({kernelDesc:void 0})},children:[(0,S.jsx)(D.l.LeadingVisual,{children:(0,S.jsx)(v.bMW,{})}),"Viewer",(0,S.jsx)(D.l.Description,{variant:"block",children:"A simple Notebook Viewer without Runtime."})]}),(0,S.jsxs)(D.l.Item,{selected:"browser"===o,onSelect:()=>{l("browser"),t({kernelDesc:{name:"pyodide",location:"browser",language:"python"}})},children:[(0,S.jsx)(D.l.LeadingVisual,{children:(0,S.jsx)(L.A,{})}),"Browser Runtime",(0,S.jsx)(D.l.Description,{variant:"block",children:"A Browser Runtime based on Pyodide."})]})]}),a.length>0&&(0,S.jsxs)(D.l.Group,{children:[(0,S.jsx)(D.l.GroupHeading,{children:"Cloud Runtimes"}),a.map((e=>(0,S.jsxs)(D.l.Item,{selected:n?.kernel?.id===e.id,onSelect:()=>{l("remote"),t({kernelDesc:{name:e.environment_name,language:"",location:"remote",displayName:e.kernel_given_name,id:e.id,burningRate:e.burning_rate,podName:e.jupyter_pod_name},kernelModel:e})},children:[(0,S.jsx)(D.l.LeadingVisual,{children:(0,S.jsx)(T.Cx,{type:"kernel"})}),e.kernel_given_name,(0,S.jsx)(D.l.Description,{variant:"block",children:e.environment_name})]},e.id)))]}),(0,S.jsx)(D.l.Divider,{}),(0,S.jsxs)(D.l.Group,{children:[(0,S.jsxs)(D.l.Item,{selected:!1,onSelect:b,children:[(0,S.jsx)(D.l.LeadingVisual,{children:(0,S.jsx)($.A,{})}),"Launch a new Runtime…"]}),(0,S.jsxs)(D.l.Item,{disabled:"browser"!==o,selected:!1,onSelect:()=>{p(V.Transfer)},title:"Transfer the state of the current Runtime to a new Remote Runtime.",children:[(0,S.jsx)(D.l.LeadingVisual,{children:(0,S.jsx)(v.e0J,{})}),"Transfer state to a new Runtime…"]})]})]})})]}),r?.remote&&h>0&&(0,S.jsx)(U.s,{dialogTitle:h===V.Transfer?"Switch to a new Cloud Runtime":void 0,manager:r.remote,onSubmit:j,markdownParser:u[N.co.name],sanitizer:u[R.zG.name],startKernel:h===V.Transfer?"defer":h===V.New})]})}var O=n(59651),W=n(46343),F=n(11471),G=n(48370),K=n(31906),B=n(95410),Q=n(97734),H=n(24991),q=n(48003),J=n(61783);function Y(e){const{children:t,connection:n,podName:a,multiServiceManager:r,disabled:i}=e,{addKernelSnapshot:o,jupyterRunUrl:l,kernelSnapshots:d,setKernelSnapshots:u}=(0,M.xb)(),{trackAsyncTask:m}=(0,Q.d)(),[p,g]=(0,s.useState)(!1),[f,x]=(0,s.useState)(!1),[v,b]=(0,s.useState)(!1),[j,y]=(0,s.useState)(d[0]?.id??""),[k,C]=(0,s.useState)();(0,s.useEffect)((()=>{(0,H.v2)().then((e=>{u(e),!j&&e.length>0&&y(e[0].id)})).catch((e=>{console.error(`Failed to fetch remote kernel snapshots; ${e}`)}))}),[l]);const A=(0,s.useCallback)((()=>{C(void 0),g(!0)}),[]),w=(0,s.useCallback)((e=>{y(e.target.value)}),[]),_=(0,s.useCallback)((async({id:e,connection:t,podName:n})=>{n?await(0,H.Wm)({id:n,from:e}):t&&await(0,q.M)({connection:t,id:e})}),[]),T=(0,s.useCallback)((async()=>{try{let e,t;b(!0);let s="",i="";if(a&&r?.remote)i=(0,J.m)("cloud"),t=r.remote.kernels.snapshot({podName:a,name:i,description:i,stop:!1}),s=a.split("-",2).reverse()[0],t.then((t=>{e=t}));else if(n&&r?.browser){const a=n.model;s=a.id,i=(0,J.m)("browser");let o=!0;t=(0,q._)({connection:r.browser.kernels.connectTo({model:a}),metadata:{filename:`${i}.data`},onUploadProgress:()=>{o&&(o=!1,(0,H.v2)().then((t=>{e=t.find((e=>e.name===i))})))}})}t&&(m(t,{error:{message:(e,t)=>"Empty snapshot"==e?`Runtime ${s} will not be snapshotted as it does not contain any serializable state.`:`Failed to pause runtime ${s} - ${e}`},pending:{message:`Taking a snapshot of runtime ${s}…`},success:{message:()=>`Runtime ${s} successfully snapshotted as ${i}.`}}),await t,e&&o(e))}finally{b(!1)}}),[n,a,r]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(P.W,{children:[(0,S.jsx)(P.W.Button,{leadingVisual:W.A,variant:"invisible",disabled:f||v||i,children:t}),(0,S.jsx)(P.W.Overlay,{children:(0,S.jsxs)(D.l,{children:[(0,S.jsx)(D.l.Item,{onSelect:A,disabled:f||0==d.length,children:"Load a runtime snapshot…"}),(0,S.jsx)(D.l.Item,{onSelect:T,disabled:v,children:"Take a runtime snapshot"})]})})]}),p&&(0,S.jsx)(B.l,{title:"Choose a runtime snapshot to load",onClose:()=>{g(!1)},footerButtons:[{buttonType:"default",content:"Cancel",onClick:e=>{e.defaultPrevented||(e.preventDefault(),g(!1))}},{buttonType:"primary",content:f?(0,S.jsx)(F.A,{size:"small"}):"Load",disabled:f,onClick:async e=>{if(!e.defaultPrevented){e.preventDefault(),x(!0);try{C(void 0);const e=d.find((e=>e.id===j));e&&(n||a)?await _({connection:n,id:e.id,podName:a}):C("No runtime snapshot found.")}finally{x(!1),g(!1)}}},autoFocus:!0}],children:(0,S.jsxs)(c.A,{as:"form",children:[(0,S.jsxs)(h.A,{children:[(0,S.jsx)(h.A.Label,{children:"Snapshot"}),(0,S.jsx)(G.A,{name:"snapshot",value:j,onChange:w,block:!0,children:d.map((e=>(0,S.jsx)(G.A.Option,{value:e.id,children:e.name?`${e.name} (${e.id})`:e.id},e.id)))})]}),k&&(0,S.jsx)(K.A,{variant:"danger",children:k})]})})]})}Y.defaultProps={disabled:!1};var X=n(63711),Z=n(98238),ee=n(58875),te=n(51066),ne=n(29525),se=n(48461),ae=n(55285),re=n(2381);function ie(e,t){let n=e.map((e=>({...e,fileType:t?.getFileTypeForModel(e)})));return n=n.filter((e=>!e.name.startsWith("."))),n.sort(((e,t)=>"directory"===e.type&&"directory"!==t.type?-1:"directory"!==e.type&&"directory"===t.type?1:e.name.localeCompare(t.name))),n}function oe(e){const{item:t,contents:n,current:a,documentRegistry:r,onContextMenu:i,onSelect:o}=e,l=(0,s.useRef)(null),[c,d]=(0,s.useState)(null),[u,m]=(0,s.useState)(!1),h=(0,s.useCallback)((()=>{m(!0),n.get(t.path).then((e=>{m(!1),d(ie(e.content,r))})).catch((()=>{m(!1)}))}),[n,t,r]),p=(0,s.useCallback)((async e=>{null===c&&e&&h()}),[c,t,n]);return(0,S.jsxs)(te.G.Item,{ref:l,id:`${t.type}-${t.name}`,onExpandedChange:p,onSelect:()=>{o(t,h)},current:t.path===a?.path,children:[(0,S.jsx)(te.G.LeadingVisual,{children:(0,S.jsx)(te.G.DirectoryIcon,{})}),(0,S.jsx)("span",{onContextMenu:e=>{e.preventDefault(),a?.path!==t.path&&o(t,h),i(l)},children:t.name}),(0,S.jsx)(te.G.SubTree,{state:u?"loading":(c?.length??-1)>=0?"done":"initial",children:c?.map((e=>"directory"===e.type?(0,S.jsx)(oe,{item:e,contents:n,current:a,documentRegistry:r,onContextMenu:i,onSelect:o},e.name):(0,S.jsx)(le,{item:e,current:e.path===a?.path,onSelect:e=>o(e,h),onContextMenu:i},e.name)))})]})}function le(e){const{item:t,current:n,onSelect:a,onContextMenu:r}=e,i=(0,s.useRef)(null),o=t.fileType?.icon;return(0,S.jsxs)(te.G.Item,{ref:i,id:`${t.type}-${t.name}`,current:n,onSelect:()=>{a(t)},children:[(0,S.jsx)(te.G.LeadingVisual,{children:o?(0,S.jsx)(o.react,{tag:"span"}):(0,S.jsx)(v.oSV,{})}),(0,S.jsx)("span",{onContextMenu:e=>{e.preventDefault(),n||a(t),r(i)},children:t.name})]},t.name)}const ce=1048576;function de(e){const{contents:t,localContents:n,documentRegistry:a}=e,r=(0,ae.aq)(),{trackAsyncTask:i}=(0,Q.d)(),[o,l]=(0,s.useState)(null),[d,u]=(0,s.useState)(!0),[m,h]=(0,s.useState)(null),[p,g]=(0,s.useState)(null),[x,v]=(0,s.useState)(!1),[b,j]=(0,s.useState)(!1),y=(0,s.useCallback)((()=>{t.get("").then((e=>{u(!1),l(ie(e.content,a))})).catch((e=>{u(!1),console.error(`Failed to fetch folder '' content for manager ${t.serverSettings.appUrl}.`,e)}))}),[t]);(0,s.useEffect)((()=>{y()}),[y]);const k=(0,s.useCallback)((async e=>{const n=()=>{if(!r())return Promise.reject(`Failed to upload ${e.name}; StorageBrowser component is unmounted.`)};n();const s=e.size>ce,a=m?"directory"===m.type?m.path:X.PathExt.dirname(m.path):"",o=a?X.PathExt.join(a,e.name):e.name,l=e.name,c=async(s,a)=>{n();const r=new FileReader;r.readAsDataURL(s),await new Promise(((t,n)=>{r.onload=t,r.onerror=t=>n(`Failed to upload "${e.name}":`+t)})),n();const i=r.result.split(",")[1],c={type:"file",format:"base64",name:l,chunk:a,content:i};return await t.save(o,c)},d={error:{message:t=>{const n=`Failed to upload ${e.name}.`;return console.error(n,t),n}},pending:{message:`Uploading ${e.name}…`},success:{message:()=>`${e.name} uploaded.`}};if(!s){const t=c(e);return i(t,d),t.then((()=>{m?m.refresh():y()})),t}{const t=new Z.PromiseDelegate;i(t.promise,d);try{let n;for(let s=0;!n;s+=ce){const a=s+ce,r=a>=e.size,i=r?-1:a/ce,o=await c(e.slice(s,a),i);r&&(n=o,t.resolve(n))}return m?m.refresh():y(),n}catch(e){throw t.reject(e),e}}}),[t,m,y]),C=(0,s.useCallback)((e=>{g(p===e?null:e)}),[p]),A=(0,s.useCallback)((()=>{v(!0)}),[]),w=(0,s.useCallback)((()=>{if(m){const e=t.delete(m.path);i(e,{success:{message:()=>`${m.path} deleted.`},pending:{message:`Deleting ${m.path}…`},error:{message:e=>{const t=`Failed to delete ${m.path}.`;return console.error(t,e),t}}}),e.finally((()=>{m.refresh()}))}v(!1)}),[t,m]),_=(0,s.useCallback)((()=>{j(!0)}),[]),T=(0,s.useCallback)((()=>{m&&n&&t.get(m.path).then((e=>{const t=n?.save(e.path,e);i(t,{success:{message:()=>`${m.path} copied to local.`},pending:{message:`Copying to local ${m.path}…`},error:{message:e=>{const t=`Failed to copy to local ${m.path}.`;return console.error(t,e),t}}}),t.finally((()=>{m.refresh()})),j(!1)}))}),[n,m]),I=(0,s.useCallback)(((e,t)=>{h(e.path===m?.path?null:{...e,refresh:t})}),[m]);return(0,S.jsxs)(c.A,{sx:{display:"grid",gridTemplateAreas:'"header" "content"'},children:[(0,S.jsxs)(c.A,{sx:{gridArea:"header",display:"flex",alignItems:"center"},children:[(0,S.jsx)(f.A,{as:"h4",sx:{fontSize:"var(--text-title-size-small)",lineHeight:"var(--text-title-lineHeight-medium)",fontWeight:"var(--text-title-weight-medium)",flex:"1 1 auto"},children:"Contents Browser"}),(0,S.jsxs)(c.A,{children:[(0,S.jsx)(ee.K,{variant:"invisible","aria-label":"Refresh contents browser.",title:"Refresh contents browser.",icon:se.A,onClick:y}),(0,S.jsx)(re.HF,{label:"Upload a file",multiple:!0,upload:k})]})]}),d?(0,S.jsx)(c.A,{sx:{gridArea:"content",display:"flex",alignItems:"center",justifyContent:"center",minHeight:"40px",height:"100vh"},children:(0,S.jsx)(F.A,{})}):(0,S.jsx)(c.A,{sx:{gridArea:"content"},children:o?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(te.G,{children:o?.map((e=>(e.fileType,"directory"===e.type?(0,S.jsx)(oe,{item:e,contents:t,current:m,documentRegistry:a,onContextMenu:C,onSelect:I},e.name):(0,S.jsx)(le,{item:e,current:m?.path===e.path,onSelect:e=>{I(e,y)},onContextMenu:C},e.name))))}),(0,S.jsx)(P.W,{anchorRef:p??void 0,open:null!==p?.current,onOpenChange:()=>{g(null)},children:(0,S.jsx)(P.W.Overlay,{children:(0,S.jsxs)(D.l,{children:[(0,S.jsx)(D.l.Item,{title:"Delete the active item.",onSelect:A,children:"Delete…"}),n&&(0,S.jsx)(D.l.Item,{title:"Copy the active item to the local drive.",onSelect:_,children:"Copy to local drive…"})]})})}),x&&(0,S.jsx)(B.l,{title:"Confirm deletion",onClose:()=>{v(!1)},footerButtons:[{buttonType:"default",content:"Cancel",onClick:()=>{v(!1)}},{buttonType:"danger",content:"Delete",onClick:()=>{w()}}],children:`Are you sure you want to delete ${m?.path}?`}),b&&(0,S.jsx)(B.l,{title:"Confirm copy to local",onClose:()=>{j(!1)},footerButtons:[{buttonType:"default",content:"Cancel",onClick:()=>{j(!1)}},{buttonType:"danger",content:"Copy to local",onClick:()=>{T()}}],children:`Are you sure you want to copy to local ${m?.path}?`})]}):(0,S.jsx)(ne.A,{children:(0,S.jsx)(ne.A.Heading,{children:"No contents"})})})]})}var ue=n(46916),me=n(77108),he=n(77606),pe=n(10815),ge=n(68822);const fe=28,xe="DatalayerSpacer",ve=3e4;var be=function(e){return e.PROGRESS="var(--borderColor-accent-emphasis)",e.ERROR="var(--borderColor-danger-emphasis)",e.SUCCESS="var(--borderColor-success-emphasis)",e}(be||{});const je={"-1":be.ERROR,0:be.PROGRESS,1:be.SUCCESS};function ye({awareness:e,currentUserHandle:t}){const[n,a]=(0,s.useState)([]);return(0,s.useEffect)((()=>{const n=()=>{const n=e.getStates();a(Array.from(n.values()).filter((e=>e.user&&e.user?.name!==t&&!(e.user?.agent??"").startsWith(xe))).reduce(((e,t)=>{const n=t.user,s=!((t.notification?.timestamp??0)+ve<Date.now()),a=n.agent?{avatarUrl:"https://static.vecteezy.com/system/resources/previews/006/662/139/large_2x/artificial-intelligence-ai-processor-chip-icon-symbol-for-graphic-design-logo-web-site-social-media-mobile-app-ui-illustration-free-vector.jpg",color:n.color,displayName:n.agent,handle:"agent",initials:"AI",username:n.agent,notification:s?`${t.notification?.message} ${(0,pe.g)(new Date(t.notification.timestamp))}`:void 0,notificationType:s&&void 0!==t.notification?.message_type?je[t.notification?.message_type.toString()]:void 0}:{avatarUrl:n.avatar_url,color:n.color,displayName:n.display_name,handle:n.name,initials:n.initials,username:n.username};return e.map((e=>e.username)).includes(a.username)||e.push(a),e}),[]))};n(),e.on("change",n);const s=setInterval(n,ve/3);return()=>{clearInterval(s),e.off("change",n)}}),[e,t]),(0,S.jsx)(me.A,{children:n.map((e=>{let t=`${e.displayName}\n${e.handle}`;return e.notification&&(t+=`\n${e.notification}`),(0,S.jsx)(he.A,{sx:{border:e.notificationType?`var(--borderWidth-thick) solid ${e.notificationType}`:"none"},title:t,src:e.avatarUrl?(0,ge.$K)(e.avatarUrl):(n=e.color,s=e.initials,"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="12" fill="${n}" stroke="none" /><text x="12" y="12" fill="black">${s}</text></svg>`)),size:fe},e.displayName);var n,s}))})}var ke=n(17810),Ce=n(23530),Ae=n(81390),we=n(64991);var Se=n(53850),_e=n(320),Te=n(44536),Ie=n(27199),Re=n(97283),Ne=n(7282);const Pe=(0,Re.y)(((e,t)=>({datasources:[],updateDatasources:t=>e((e=>({datasources:t})))})));function Ee(e){return(0,Ne.Pj)(Pe,e)}var De=n(20614),Le=n(88037),$e=n(41630);function Ue(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Me extends Le._Q{constructor(e){super(),Ue(this,"_rows",void 0),Ue(this,"_mimeType",void 0),this._mimeType=e.mimeType,this._rows=[]}renderModel(e){const t=e.data[this._mimeType].split("\n").map((e=>e.split(";")));return this._rows=t,Promise.resolve()}render(){return 0===(this._rows.length>0?this._rows[0].length:0)?(0,S.jsx)("div",{children:"No data found!"}):(0,S.jsx)($e.NP,{children:this._rows.map((e=>(0,S.jsx)(c.A,{mt:3,children:e})))})}}const Ve={safe:!0,mimeTypes:["application/vnd.datalayer.csv"],createRenderer:e=>new Me(e)};var ze=n(85961);function Oe(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class We{constructor(e){Oe(this,"iamProvider","linkedin"),Oe(this,"urn",void 0),Oe(this,"id",void 0),this.urn=e;const t=e.split(":");this.id=t[3]}getURL(){return`https://www.linkedin.com/feed/update/${this.urn}`}}var Fe=n(43715);const Ge=e=>{const{screenCapture:t}=(0,Ie.l5)(),{enqueueToast:n}=(0,Q.d)(),{user:a,iamProvidersAuthorizationURL:r,getIAMProviderAccessToken:i}=(0,Te.Y)(),{getLinkedinProfile:o,postLinkedinShareWithUpload:l}=(0,Se.E)(),{showBackdrop:u,hideBackdrop:p}=(0,Ie.l5)(),[f,x]=(0,s.useState)(),[v,b]=(0,s.useState)(""),[j,y]=(0,s.useState)({shareText:void 0}),[k,C]=(0,s.useState)({shareText:void 0});return(0,s.useEffect)((()=>{C({...k,shareText:void 0===j.shareText?void 0:j.shareText.length>2&&j.shareText.length<1e3})}),[j]),(0,s.useEffect)((()=>{if(a){const e=i(a,"linkedin");e&&o(e).then((e=>{x(e)}))}}),[a]),(0,S.jsx)(S.Fragment,{children:r[Fe.W.LinkedIn.name]?f&&(0,S.jsx)(c.A,{display:"flex",children:(0,S.jsxs)(c.A,{ml:3,sx:{width:"100%"},children:[(0,S.jsx)(c.A,{children:(0,S.jsxs)(h.A,{required:!0,children:[(0,S.jsx)(h.A.Label,{children:"Tell something nice"}),(0,S.jsx)(g.Ay,{block:!0,value:j.shareText,onChange:e=>{y((t=>({...t,shareText:e.target.value})))},rows:3}),!1===k.shareText&&(0,S.jsx)(h.A.Validation,{variant:"error",children:"Text must have more than 2 characters and less than 1000."})]})}),(0,S.jsxs)(c.A,{mt:3,children:[(0,S.jsx)(d.Q,{disabled:!k.shareText||!t,leadingVisual:ze.A,onClick:()=>{if(a&&f&&t){u("Posting on LinkedIn.");const e=i(a,"linkedin");l(f,j.shareText,t,e).then((e=>{if(e.success){const t=e.restli;if(t){const e=new We(t).getURL();return n("Your post is shared on LinkedIn.",{variant:"success"}),void b(e)}}n("Sorry, we were not able to share your content on LinkedIn...",{variant:"error"})})).finally((()=>{p()}))}},children:"Share on LinkedIn"}),v&&(0,S.jsx)(m.A,{href:v,target:"_blank",children:v})]})]})}):(0,S.jsx)(K.A,{variant:"warning",children:"This deployment is not configured for LinkedIn integration."})})};var Ke=n(14809),Be=n(17310),Qe=n(16181);function He(e){const{createAIAgent:t}=(0,we.w)(),{aiAgents:n,addAIAgent:a}=(0,Ae.Ks)(),{cell:r,extensionProps:i}=e,{notebookId:o}=i,[l,u]=(0,s.useState)(!1),[m,p]=(0,s.useState)(),[f,x]=(0,s.useState)({prompt:""}),[b,j]=(0,s.useState)({prompt:void 0});(0,s.useEffect)((()=>{const e=(e,t)=>{if("datalayer"==t.key&&m)for(const e of r.model.sharedModel.getMetadata("datalayer")?.ai?.messages??[])if(e.parent_id===m){p(void 0);break}};return r.model.sharedModel.metadataChanged.connect(e),()=>{r.model?.sharedModel.metadataChanged.disconnect(e)}}),[r,m]),(0,s.useEffect)((()=>{m||u(!1)}),[m]),(0,s.useEffect)((()=>{j({...b,prompt:void 0===f.prompt?void 0:f.prompt.length>0})}),[f]);const y=(0,s.useCallback)((async()=>{const e=i.panel.context.sessionContext.session?.kernel,s=e?.serverSettings,l=e?.id;n.find((e=>e.documentId==o&&e.runtimeId==l))||(await t(o,"notebook_persist",s?.baseUrl,s?.token,l),a({documentId:o,runtimeId:l}));const c=(0,Qe.f)();!function(e,t,n){const s=e.model.getMetadata("datalayer")??{},a=s.ai??{prompts:[],messages:[]},r=a.prompts??[];r.push({id:t,prompt:n,username:void 0,timestamp:Date.now()}),a.prompts=r,s.ai=a,e.model.setMetadata("datalayer",s),console.log("---",s)}(r,c,f.prompt),p(c)}),[n,r,i.panel.context.sessionContext.session?.kernel,f.prompt,o,t]),k=(0,s.useCallback)((e=>{e.ctrlKey&&"Enter"===e.key&&y()}),[y]);return(0,S.jsx)($e.NP,{children:(0,S.jsx)(c.A,{display:"flex",style:{justifyContent:"right"},children:(0,S.jsx)(c.A,{className:"dla-cell-ai-agent-button",children:(0,S.jsxs)(P.W,{open:l,onOpenChange:e=>u(e),children:[(0,S.jsx)(P.W.Anchor,{id:"custom-anchor-id",children:(0,S.jsx)(ee.K,{icon:v.SD8,variant:"invisible","aria-label":"AI Agents menu"})}),(0,S.jsx)(P.W.Overlay,{width:"large",children:(0,S.jsxs)(c.A,{as:"form",m:3,children:[(0,S.jsxs)(h.A,{children:[(0,S.jsx)(h.A.Label,{visuallyHidden:!0}),(0,S.jsx)(g.Ay,{block:!0,value:f.prompt,onChange:e=>{x((t=>({...t,prompt:e.target.value})))},disabled:!!m,onKeyDown:k})]}),(0,S.jsxs)(c.A,{sx:{display:"flex",width:"100%",gap:"2px",marginTop:"var(--stack-gap-normal)"},children:[(0,S.jsx)(c.A,{flexGrow:1}),(0,S.jsx)(d.Q,{onClick:e=>u(!1),variant:"default",children:"Cancel"}),(0,S.jsx)(d.Q,{leadingVisual:Be.A,onClick:y,disabled:!b.prompt||!!m,variant:"primary",children:m?(0,S.jsx)(F.A,{size:"small"}):"Ask AI"})]})]})})]})})})})}var qe=n(94247);const Je=e=>{const{cell:t}=e,{datasources:n}=Ee(),[a,r]=(0,s.useState)();(0,s.useEffect)((()=>{const e=(e,t)=>{if("datalayer"==(t?.key??"datalayer")){const t=(e=>{const t=e.getMetadata("datalayer");if(t){const e=t.datasource;if(e)return e.id}})(e);if(t)for(const e of n)if(t===e.id){r(t);break}}};return e(t.model),t.model.metadataChanged.connect(e),()=>{t.model?.metadataChanged.disconnect(e)}}),[t,n]);const i=e=>{const n=t.model.getMetadata("datalayer");e?(t.model.setMetadata("datalayer",{...n,sql:!0,datasource:{id:e.id,variant:e.variant,name:e.name,description:e.description,database:e.database,outputBucket:e.outputBucket,destinationVar:"df"}}),r(e.id),t.editor.model.mimeType=qe.bd):(t.model.setMetadata("datalayer",{...n,sql:!1,datasource:{}}),r(void 0),t.editor.model.mimeType=qe.dC)};return(0,S.jsx)($e.NP,{children:(0,S.jsx)(c.A,{display:"flex",style:{justifyContent:"right"},children:(0,S.jsx)(c.A,{className:"dla-cell-datasource-button",children:(0,S.jsxs)(P.W,{children:[(0,S.jsx)(P.W.Anchor,{id:"custom-anchor-id",children:(0,S.jsx)(ee.K,{icon:v.bN0,variant:"invisible","aria-label":"Open Datasources menu"})}),(0,S.jsx)(P.W.Overlay,{width:"medium",children:(0,S.jsx)(D.l,{selectionVariant:"single",showDividers:!0,children:(0,S.jsxs)(D.l.Group,{children:[(0,S.jsx)(D.l.GroupHeading,{children:"Datasources"}),0===n.length&&(0,S.jsxs)(D.l.Item,{onSelect:()=>{},children:["No Datasource available",(0,S.jsx)(D.l.Description,{variant:"block",children:"Create a new Datasource to connect your cell."})]}),n.map((e=>(0,S.jsxs)(D.l.Item,{onSelect:()=>i(e),selected:e.id===a,children:[e.name,(0,S.jsx)(D.l.Description,{variant:"block",children:e.description})]},e.id))),(0,S.jsx)(D.l.Divider,{}),(0,S.jsx)(D.l.Item,{children:(0,S.jsxs)(h.A,{children:[(0,S.jsx)(h.A.Label,{children:"Output Dataframe"}),(0,S.jsx)(p.A,{size:"small",value:"df",disabled:!0})]})}),(0,S.jsx)(D.l.Divider,{}),(0,S.jsx)(D.l.Item,{variant:"danger",onSelect:()=>i(void 0),children:"None"})]})})})]})})})})};function Ye(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Xe="dla-CellToolbar-Container";class Ze extends Le._Q{constructor(e,t){super(),Ye(this,"_cell",void 0),Ye(this,"_props",void 0),this._cell=e,this._props=t,this.addClass(Xe)}render(){return(0,S.jsxs)(c.A,{display:"flex",children:[(0,S.jsx)(c.A,{flexGrow:1}),(0,S.jsxs)(a.fS,{initialEntries:["/"],children:[(0,S.jsx)(a.BV,{children:(0,S.jsx)(a.qh,{path:"*",element:(0,S.jsx)(He,{cell:this._cell,extensionProps:this._props})})}),(0,S.jsx)(Je,{cell:this._cell,extensionProps:this._props})]})]})}}function et(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class tt extends Ke.x0{constructor(e,t){super(),et(this,"_panel",void 0),et(this,"_props",void 0),this._panel=e,this._props=t,this.updateConnectedCell=this.updateConnectedCell.bind(this);const n=()=>{const e=this._panel.content.model?.cells;if(e){e.changed.connect(this.updateConnectedCell);for(let t=0;t<e.length;++t)this._registerCellChanges(e.get(t))}};n(),this._panel.content.modelChanged.connect((()=>{n()}))}updateConnectedCell(e,t){t.oldValues.forEach(this._deregisterCellChanges.bind(this)),t.newValues.forEach(this._registerCellChanges.bind(this))}_deregisterCellChanges(e){}_registerCellChanges(e){const t=this._getCodeCell(e);t?(t.displayChanged.connect((()=>{this._updateCodeCell(t)})),t.inViewportChanged.connect((()=>{this._updateCodeCell(t)})),this._updateCodeCell(t)):"code"===e.type&&console.error(`Could not find code cell for model: ${e}`)}_getCodeCell(e){return"code"===e.type?this._panel.content.widgets.find((t=>t.model===e)):null}_updateCodeCell(e){if(e.inputArea){const t=e.layout;if(t){const n=t;n.widgets[1].hasClass(Xe)||n.insertWidget(1,new Ze(e,this._props))}}}}class nt{constructor(){var e,t,n;e=this,n=void 0,(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t="_props"))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}init(e){this._props=e}createNew(e,t){new tt(e,this._props)}get component(){return null}}const st=new b.Od;function at(){const{notebookId:e}=(0,a.g)();if(!e)return(0,S.jsx)(S.Fragment,{});const t=(0,ke.J)(),b=(0,o.S)(),w=(0,Ce.Z)(),I=function(e){const{getAIAgent:t}=(0,we.w)(),{aiAgents:n,addAIAgent:a,deleteAIAgent:r,updateAIAgent:i}=(0,Ae.Ks)();return(0,s.useEffect)((()=>{let s;const o=setInterval((async()=>{s=new AbortController;try{const o=await t(e,{signal:s.signal});if(!o.success)return void r(e);const l=n.find((t=>t.documentId==e)),c=o.agent.runtime?.id;l?l.runtimeId!==c&&i(e,c):a({documentId:e,runtimeId:c})}catch(t){r(e)}}),6e4);return()=>{s?.abort("Component unmounted"),clearInterval(o)}}),[n,e]),n.find((t=>t.documentId===e))}(e),{configuration:R}=(0,_e._O)(),{credits:N,token:P}=(0,Te.Y)(),{configuration:E,multiServiceManager:D,jupyterLabAdapter:L,remoteKernels:$}=(0,M.xb)(),[U,V]=(0,s.useState)(st),[W,F]=(0,s.useState)(void 0),[G,K]=(0,s.useState)(),[B,J]=(0,s.useState)(!1),[X,Z]=(0,s.useState)(),[ee,te]=(0,s.useState)(!1),[ne,se]=(0,s.useState)(!0),[ae,re]=(0,s.useState)(""),[ie,oe]=(0,s.useState)(null),[le,ce]=(0,s.useState)(),[me,he]=(0,s.useState)(),[pe,ge]=(0,s.useState)(null),[fe,xe]=(0,s.useState)({name:"",nameConfirm:"",description:""}),[ve,be]=(0,s.useState)({name:void 0,nameConfirm:void 0,description:void 0}),{enqueueToast:je,trackAsyncTask:Re}=(0,Q.d)(),{selectNotebookModel:Ne,reset:Pe}=(0,j.Gx)(),{hideBackdrop:Le,screenCapture:$e,setItem:Ue,setScreenCapture:Me,showBackdrop:ze,showScreenshot:Oe,space:We,triggerItemsRefresh:Fe}=(0,Ie.l5)(),{cloneNotebook:Ke,deleteItem:Be,getDatasources:Qe,getNotebook:He,refreshDatasources:qe,refreshNotebook:Je,updateNotebook:Ye,updateNotebookModel:Xe}=(0,Se.E)(),{updateDatasources:Ze}=Ee(),{updateAIAgent:et}=(0,Ae.Ks)(),{patchAIAgent:tt}=(0,we.w)(),at=(0,s.useMemo)((()=>({baseURL:R.spacerRunUrl,token:P,roomName:e,type:"datalayer"})),[R.spacerRunUrl,e,P]),rt=(0,s.useMemo)((()=>[new nt,new y._({factory:k.N})]),[]),it=(0,s.useMemo)((()=>new i.J),[]),ot=(0,s.useMemo)((()=>[Ve]),[]),lt=(0,s.useMemo)((()=>(0,De.Kp)()),[]);(0,s.useEffect)((()=>{if($&&$.length>0&&!X){const e=$[0];dt({kernelDesc:{name:e.environment_name,language:"",location:"remote",displayName:e.kernel_given_name,id:e.id,burningRate:e.burning_rate,podName:e.jupyter_pod_name},kernelModel:e})}}),[$]),(0,s.useEffect)((()=>{ie&&ie.sharedModel.awareness.setLocalStateField("user",{username:t.id,name:t.handle,display_name:t.displayName,initials:`${t.firstName[0]?.toLocaleUpperCase()??"?"}${t.lastName[0]?.toLocaleUpperCase()||"?"}`,color:lt,avatar_url:t.avatarUrl})}),[ie,t,lt]),(0,s.useEffect)((()=>(ze(),Je(e).then((t=>{if(Le(),t.success){const t=He(e);t?(ce(t),he(t.nbformat),Ue(t),xe({name:t.name,nameConfirm:"",description:t.description})):w("/")}else je(t.message,{variant:"error"})})).finally((()=>{Le()})),()=>{U.dispose(),ce(void 0),Pe(),Ue(void 0)})),[e]),(0,s.useEffect)((()=>{qe().then((e=>{if(e.success){const e=Qe();Ze(e)}}))}),[e]),(0,s.useEffect)((()=>{I&&ae&&I.runtimeId!==W&&(tt(e,U.serverSettings.baseUrl,U.serverSettings.token,W),et(e,W))}),[I,W,e,ae,U]),(0,s.useEffect)((()=>{be({...ve,name:void 0===fe.name?void 0:fe.name.length>2,nameConfirm:fe.nameConfirm===le?.name,description:void 0===fe.description?void 0:fe.description.length>2})}),[fe]);const ct=(0,s.useCallback)((async()=>{ze(),Ye(e,fe.name,fe.description).then((e=>{e.success&&(je("The notebook is successfully updated.",{variant:"success"}),Fe(),ce({...le,name:fe.name,description:fe.description}))})).finally((()=>{Le()}))}),[e,fe.name,fe.description,le]),dt=(0,s.useCallback)((async({kernelDesc:s,kernelModel:a,transferState:i})=>{const o=Ne(e);o?.model&&he(o.model.toJSON()),K(s);const l=s?.location;switch(re(""),l){case void 0:F(void 0),se(!0),J(!1),V(st);break;case"browser":if(D?.browser){if(L){if(!L.jupyterLab.hasPlugin("@jupyterlite/pyodide-kernel-extension:kernel")){const e=await Promise.all([n.e(484),n.e(5378)]).then(n.bind(n,28924));L.jupyterLab.registerPluginModule(e)}L.jupyterLab.isPluginActivated("@jupyterlite/pyodide-kernel-extension:kernel")||await L.jupyterLab.activatePlugin("@jupyterlite/pyodide-kernel-extension:kernel")}F(void 0),se(!1),J(!0),V(D.browser)}else console.error("Unable to use browser kernel. No service manager for it.");break;case"remote":{if(!D?.remote){console.error("Unable to use a remote kernel. No service manager for it.");break}let e;if(i&&U&&U===D?.browser&&X?.kernel)try{ze();let t=!0;const n=X.kernel.id,s=`pyodide-${n}`,a=(0,q._)({connection:X.kernel,metadata:{filename:`${s}.data`},onUploadProgress:()=>{t&&(t=!1,(0,H.v2)().then((t=>{e=t.find((e=>e.name===s))})))}});if(Re(a,{error:{message:e=>`Failed to save the browser kernel state. ${e}`},pending:{message:"Saving the browser kernel state…"},success:{message:()=>"Browser kernel state saved."}}),await a,!e)throw Error("Unable to find snapshot for pyodide state.");await D.browser.kernels.shutdown(n)}finally{Le()}if(!a){const{name:n,displayName:r,params:i}=s,o=await(D?.remote?.kernels.startNew({name:n,kernelType:"notebook",givenName:r,creditsLimit:i?.creditsLimit??(N?.available??0)/Math.max(E.maxCellKernels-$.filter((e=>"cell"!==e.kernel_type)).length,1),capabilities:i?.capabilities,snapshot:e?.id},{username:t?.handle,handleComms:!0}));a=await D.remote.kernels.findById(o.id),o.dispose()}J(!1),F(a.id),se(!1);const n=D.remote.kernels.getServices(a.jupyter_pod_name);re(a.jupyter_pod_name);const o=new r.ServiceManager({contents:n?.contents,kernels:n?.kernels,kernelspecs:n?.kernelspecs,serverSettings:n?.serverSettings,sessions:n?.sessions,events:{dispose:()=>{}},terminals:{connectionFailure:{connect:()=>{}},dispose:()=>{},isAvailable:()=>!1}});V(o),ge("storage");break}}ht(void 0)}),[E,N,L,e,D,$,U,X]),ut=(0,s.useCallback)((async n=>{b({title:"Are you sure?",content:"Please confirm you want to clone this notebook in your private library."}).then((n=>{n&&(ze(),Ke(e).then((e=>{Le(),e.success&&(je(e.message,{variant:"success"}),Fe(),w(`/${t.handle}/library/notebooks`))})))}))}),[b,le]),mt=(0,s.useCallback)((e=>{oe(e)}),[]),ht=(0,s.useCallback)((e=>{Z(e||void 0)}),[]),pt=(0,s.useCallback)((()=>{if(!ne&&ie?.cells){ze("Saving the notebook...");const t=ie.toJSON();Xe(e,t).then((n=>{n.success&&(je("The notebook is successfully updated.",{variant:"success"}),ce({...le,id:e,nbformat:t}))})).finally((()=>{Le()}))}}),[e,ie,ne]),gt=(0,s.useCallback)((()=>{ge("storage"!==pe&&U&&U!==st?"storage":null)}),[pe,U]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(l.z,{"aria-label":"Notebook Editor",children:[(0,S.jsx)(l.z.TitleArea,{variant:"subtitle",children:(0,S.jsx)(l.z.Title,{children:"Notebook Editor"})}),(0,S.jsx)(l.z.Actions,{children:le&&We&&(0,S.jsxs)(c.A,{sx:{flex:"0 0 auto",display:"flex",alignItems:"center"},children:[D?.remote&&X&&X.kernel&&(0,S.jsx)(O.m,{kernelId:X.kernel.id,serviceManager:D.remote,onClick:()=>{w("/runtimes")}},"credits-indicator"),(0,S.jsx)(z,{assignKernel:dt,sessionConnection:X},"kernel-picker"),(0,S.jsx)(Y,{connection:X?.kernel??void 0,multiServiceManager:D,podName:ae,disabled:void 0===G?.location,children:"Snapshots"}),(0,S.jsx)(d.Q,{title:"Browse content on the Remote Runtime",variant:"invisible",size:"small",disabled:!U||U===st,leadingVisual:()=>(0,S.jsx)(T.Cx,{type:"content"}),onClick:gt,children:"Storage"},"content"),(0,S.jsx)(ue.E,{commandRegistry:it,kernelDesc:G,save:pt,sessionConnection:X},"toolbar"),(0,S.jsx)(d.Q,{variant:"invisible",size:"small",leadingVisual:v.Nc$,onClick:ut,children:"Clone"},"clone"),(0,S.jsx)(d.Q,{title:"Capture screen",variant:"invisible",size:"small",leadingVisual:()=>(0,S.jsx)(v.rVi,{}),onClick:()=>{Oe()},children:"Capture"},"capture-screen"),(0,S.jsx)(d.Q,{title:"Share",variant:"invisible",size:"small",leadingVisual:()=>(0,S.jsx)(T.Cx,{type:"share"}),onClick:e=>te(!ee),children:"Share"},"share"),(0,S.jsx)(d.Q,{variant:"invisible",size:"small",leadingVisual:()=>(0,S.jsx)(T.Cx,{type:"page"}),onClick:t=>w(`/new/page/notebook/${e}`),children:"Publish"},"public"),(0,S.jsx)(d.Q,{variant:"invisible",size:"small",leadingVisual:v.L64,onClick:e=>{ge("properties"===pe?null:"properties")},children:"Properties"},"properties"),"datalayer"===at.type&&ie&&(0,S.jsx)(ye,{awareness:ie.sharedModel.awareness,currentUserHandle:t.handle},"peers")]})})]}),(0,S.jsxs)(u.O7,{children:[(0,S.jsxs)(u.O7.Content,{"aria-label":"Notebook Editor",width:"full",padding:"none",children:[$e&&(0,S.jsx)(c.A,{mt:3,children:(0,S.jsxs)(c.A,{display:"flex",children:[(0,S.jsx)(c.A,{children:(0,S.jsx)("img",{src:$e})}),(0,S.jsx)(c.A,{children:(0,S.jsx)(m.A,{href:"javascript: return false;",onClick:e=>Me(void 0),children:(0,S.jsx)(v.uv5,{})})})]})}),ee&&(0,S.jsx)(c.A,{sx:{flexGrow:1},children:(0,S.jsx)(Ge,{})}),me&&(void 0===G?.location?(0,S.jsx)(c.A,{sx:{"& .jp-Cell":{marginTop:30}},children:(0,S.jsx)(C.j,{nbformat:me,outputs:!0})}):(0,S.jsx)(c.A,{sx:{"& .jp-WindowedPanel":{margin:0},"& .jp-WindowedPanel-viewport":{padding:0},"& .dla-CellSidebar-Container":{position:"relative",marginLeft:"auto"},"& .jp-Cell .dla-CellSidebar-Container":{display:"none"},"& .jp-Cell.jp-mod-active .dla-CellSidebar-Container":{display:"block"}},children:(0,S.jsx)(A.k,{commands:it,extensions:rt,id:e,collaborationServer:at,nbformat:me,readonly:ne,renderers:ot,kernelId:W,serviceManager:U,startDefaultKernel:B,height:"calc(100vh - 150px)",maxHeight:"calc(100vh - 150px)",onNotebookModelChanged:mt,onSessionConnection:ht})}))]}),null!==pe&&(0,S.jsx)(u.O7.Pane,{"aria-label":"storage"===pe?"Remote Runtime Storage":"Notebook Properties",position:"start",width:"large",children:"storage"===pe&&U.contents?(0,S.jsx)(de,{contents:U.contents,documentRegistry:L?.jupyterLab.docRegistry}):"properties"===pe?(0,S.jsxs)(c.A,{as:"form",sx:{label:{marginTop:2}},children:[(0,S.jsxs)(h.A,{children:[(0,S.jsx)(h.A.Label,{children:"Name"}),(0,S.jsx)(p.A,{block:!0,value:fe.name,onChange:e=>{xe((t=>({...t,name:e.target.value})))}}),!1===ve.name&&(0,S.jsx)(h.A.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,S.jsxs)(h.A,{children:[(0,S.jsx)(h.A.Label,{children:"Description"}),(0,S.jsx)(g.Ay,{block:!0,value:fe.description,onChange:e=>{xe((t=>({...t,description:e.target.value})))}}),!1===ve.description&&(0,S.jsx)(h.A.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,S.jsx)(h.A,{children:(0,S.jsx)(d.Q,{variant:"primary",disabled:!ve.name||!ve.description,sx:{marginTop:2},onClick:ct,children:"Update Notebook Properties"})}),(0,S.jsx)(c.A,{mt:3}),(0,S.jsx)(_,{variant:"default",data:me,fileName:`notebook-${e}`,extension:"ipynb"}),(0,S.jsxs)(c.A,{sx:{marginTop:3},children:[(0,S.jsx)(f.A,{as:"h2",sx:{fontSize:4,fontWeight:"normal",color:"danger.fg",mb:2},children:"Danger zone"}),(0,S.jsxs)(c.A,{sx:{border:"1px solid",borderColor:"danger.emphasis",borderRadius:2,p:3,alignItems:"center",justifyContent:"space-between",gap:3},children:[(0,S.jsxs)(c.A,{sx:{display:"grid",gap:1},children:[(0,S.jsx)(x.A,{sx:{fontSize:1,fontWeight:"bold",color:"danger.fg"},children:"Confirm the notebook name to delete"}),(0,S.jsx)(h.A,{children:(0,S.jsx)(p.A,{block:!0,value:fe.nameConfirm,onChange:e=>{xe((t=>({...t,nameConfirm:e.target.value})))}})}),(0,S.jsx)(x.A,{sx:{fontSize:1,color:"fg.muted"},children:"This operation is not reversible."})]}),(0,S.jsx)(d.Q,{variant:"danger",disabled:!ve.nameConfirm,onClick:async()=>{ze("Deleting the notebook..."),Be(le.id).then((e=>{e.success&&(je("The notebook is successfully deleted.",{variant:"success"}),w("/my-library"))})).finally((()=>{Le()}))},children:"Delete notebook"})]})]})]}):(0,S.jsx)(S.Fragment,{})})]})]})}const rt=at},46916:(e,t,n)=>{n.d(t,{E:()=>l});var s=n(71791),a=n(99180),r=n(38621),i=n(9387),o=n(18683);function l(e){const{commandRegistry:t,kernelDesc:n,save:l,sessionConnection:c}=e,[d,u]=(0,i.useState)();return(0,i.useEffect)((()=>{const e=()=>{u(c?.kernel?.status)};return e(),c?.statusChanged.connect(e),c?.connectionStatusChanged.connect(e),()=>{c?.statusChanged.disconnect(e),c?.connectionStatusChanged.disconnect(e)}}),[c]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.Q,{variant:"invisible",size:"small",leadingVisual:r.iKr,disabled:void 0===n?.location,onClick:l,children:"Save"}),(0,o.jsx)(a.Q,{variant:"invisible",size:"small",leadingVisual:r.udU,disabled:!n?.location||"busy"===d,onClick:e=>{t?.execute(s.nx.runAll)},children:"Run all"}),(0,o.jsx)(a.Q,{variant:"invisible",size:"small",leadingVisual:r.wFz,disabled:!n?.location||"busy"!==d,onClick:e=>{t?.execute(s.nx.interrupt)},children:"Interrupt"})]})}},64991:(e,t,n)=>{n.d(t,{w:()=>i});var s=n(49370),a=n(320),r=n(63711);const i=(e="api/ai-agents/v1")=>{const{configuration:t}=(0,a._O)(),{requestRun:n}=(0,s.X)({notifyOnError:!1});return{createAIAgent:(s,a,i,o,l,{signal:c,baseUrl:d=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,d,"agents"),method:"POST",body:{room_id:s,room_type:a,runtime:{ingress:i,token:o,kernel_id:l}},signal:c}),getAIAgents:({signal:s,baseUrl:a=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,a,"agents"),method:"GET",signal:s}),deleteAIAgent:(s,{signal:a,baseUrl:i=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,i,"agents",s),method:"DELETE",signal:a}),getAIAgent:(s,{signal:a,baseUrl:i=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,i,"agents",s),method:"GET",signal:a}),patchAIAgent:(s,a,i,o,{signal:l,baseUrl:c=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,c,"agents",s),method:"PATCH",body:{runtime:a&&i&&o?{ingress:a,token:i,kernel_id:o}:null},signal:l})}}},81390:(e,t,n)=>{n.d(t,{Ks:()=>i});var s=n(97283),a=n(7282);const r=(0,s.y)((e=>({aiAgents:[],addAIAgent:t=>{e((e=>e.aiAgents.includes(t)?{}:{aiAgents:e.aiAgents.concat([t])}))},deleteAIAgent:t=>{e((e=>({aiAgents:e.aiAgents.filter((e=>e.documentId===t))})))},updateAIAgent:(t,n)=>{e((e=>{const s=e.aiAgents.findIndex((e=>e.documentId===t));return s>=0?(e.aiAgents[s].runtimeId=n,{aiAgents:[...e.aiAgents]}):{}}))}})));function i(e){return(0,a.Pj)(r,e)}}}]);