"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[5388],{15388:(e,n,s)=>{s.r(n),s.d(n,{AssignmentEdit:()=>V,default:()=>z});var t=s(9387),i=s(20568),a=s(3345),r=s(7856),l=s(98754),o=s(3556),c=s(46508),d=s(99180),u=s(27698),h=s(64315),m=s(68125),g=s(92243),p=s(31906),x=s(94706),v=s(38621),f=s(85383),y=s(16476),j=s(2159),b=s(84271),k=s(74087),A=s(17810),S=s(23530),C=s(53850),w=s(97734),N=s(50906),B=s(54520),I=s(46916),O=s(18683);const V=()=>{const{assignmentId:e}=(0,i.g)();if(!e)return(0,O.jsx)(O.Fragment,{});const n=(0,A.J)(),s=(0,a.S)(),V=(0,S.Z)(),z=(0,N.mt)(),E=(0,y.Gx)(),R=(0,B.OK)(),Q=z.layout().space,_=R.saveRequest,D=E.selectNotebookModel(e),{cloneAssignment:F,getAssignment:T,getAssignmentStudentVersion:J,refreshAssignment:M,updateNotebookModel:L,updateNotebook:U}=(0,C.E)(),{enqueueToast:P}=(0,w.d)(),[$,q]=(0,t.useState)("editor"),[G,H]=(0,t.useState)(!1),[K,Z]=(0,t.useState)(void 0),[W,X]=(0,t.useState)([]),[Y,ee]=(0,t.useState)(),[ne,se]=(0,t.useState)({name:"",description:""}),[te,ie]=(0,t.useState)({name:void 0,description:void 0}),ae=(0,t.useMemo)((()=>[new j._]),[]),re=(0,t.useMemo)((()=>[new j._({factory:b.a})]),[]),le=(e,n)=>{n.preventDefault(),z.layout().resetRightPortal(),X([]),q(e)};(0,t.useEffect)((()=>{if(e&&"editor"===$)return z.layout().showBackdrop("Loading the assignment..."),M(e).then((n=>{if(n.success){const n=T(e);n?(ee(n),z.layout().setItem(n),se({name:n.name,description:n.description})):V("/")}})).finally((()=>{z.layout().hideBackdrop()})),()=>{E.reset(),z.layout().setItem(void 0)}}),[e,$]);const oe=()=>{D?.model?.cells&&(z.layout().showBackdrop("Saving the assignment..."),L(e,D.model.toJSON()).then((e=>{e.success&&(P("The assignment is successfully updated.",{variant:"success"}),z.layout().triggerItemsRefresh(),ee({...Y,nbformat:D.model.toJSON()}))})).finally((()=>{z.layout().hideBackdrop()})))},ce=n=>{D?.model?.cells&&(n.preventDefault(),z.layout().showBackdrop("Generating the student version of the assignment..."),L(e,D.model.toJSON()),J(e).then((e=>{H(!0),le("student",n),e.success?Z(JSON.parse(e.notebook)):e.errors&&X(e.errors)})).finally((()=>{z.layout().hideBackdrop()})))};(0,t.useEffect)((()=>{_&&Y&&oe()}),[_]),(0,t.useEffect)((()=>{ie({...te,name:void 0===ne.name?void 0:ne.name.length>2,description:void 0===ne.description?void 0:ne.description.length>2})}),[ne]);const de=(0,t.useCallback)((async t=>{s({title:"Are you sure?",content:"Please confirm you want to clone this assignment in your private library."}).then((s=>{s&&(z.layout().showBackdrop(),F(e).then((e=>{e.success&&(P(e.message,{variant:"success"}),z.layout().triggerItemsRefresh(),V(`/${n?.handle}/library/assignments`))})).finally((()=>{z.layout().hideBackdrop()})))}))}),[s,Y]);return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(r.z,{children:(0,O.jsxs)(l.A,{display:"flex",children:[(0,O.jsx)(l.A,{flex:1,children:(0,O.jsx)(o.A,{sx:{fontSize:3},children:"Assignment editor"})}),"student"!==$&&(0,O.jsxs)(l.A,{display:"flex",children:[(0,O.jsx)(I.E,{commandRegistry:E.selectNotebookAdapter(e)?.commands,save:oe}),(0,O.jsx)(c.A,{children:(0,O.jsx)(d.Q,{variant:"invisible",size:"small",leadingVisual:f.A,onClick:e=>ce(e),children:"Student version"})}),Y&&Q&&(0,O.jsx)(d.Q,{variant:"invisible",size:"small",leadingVisual:v.Nc$,onClick:de,children:"Clone"})]})]})}),Y&&(0,O.jsxs)(O.Fragment,{children:[(0,O.jsxs)(u.O,{sx:{mt:3,mb:3},children:[(0,O.jsx)(u.O.Item,{href:"","aria-label":"","aria-current":"editor"===$?"page":void 0,onClick:e=>le("editor",e),children:"Editor"}),(0,O.jsx)(u.O.Item,{href:"","aria-label":"","aria-current":"properties"===$?"page":void 0,onClick:e=>le("properties",e),children:"Properties"}),(0,O.jsx)(u.O.Item,{href:"","aria-label":"","aria-current":"student"===$?"page":void 0,onClick:e=>ce(e),children:"Student version"})]}),"editor"===$&&(0,O.jsx)(l.A,{children:Y.nbformat&&(0,O.jsx)(k.g,{id:e,height:"calc(100vh - 240px)",maxHeight:"calc(100vh - 240px)",nbformat:Y.nbformat,extensions:ae,cellSidebarMargin:200})}),"properties"===$&&(0,O.jsx)(l.A,{display:"grid",gridTemplateColumns:"1fr 1fr",children:(0,O.jsx)(l.A,{children:(0,O.jsxs)(l.A,{sx:{label:{marginTop:2}},children:[(0,O.jsxs)(h.A,{children:[(0,O.jsx)(h.A.Label,{children:"Name"}),(0,O.jsx)(m.A,{block:!0,value:ne.name,onChange:e=>{se((n=>({...n,name:e.target.value})))}}),!1===te.name&&(0,O.jsx)(h.A.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,O.jsxs)(h.A,{children:[(0,O.jsx)(h.A.Label,{children:"Description"}),(0,O.jsx)(g.Ay,{block:!0,value:ne.description,onChange:e=>{se((n=>({...n,description:e.target.value})))}}),!1===te.description&&(0,O.jsx)(h.A.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,O.jsx)(h.A,{children:(0,O.jsx)(d.Q,{variant:"primary",disabled:!te.name||!te.description,sx:{marginTop:2},onClick:async()=>{z.layout().showBackdrop("Updating assignment..."),U(e,ne.name,ne.description).then((e=>{e.success&&(P("The assignment is successfully updated.",{variant:"success"}),z.layout().triggerItemsRefresh(),ee({...Y,name:ne.name,description:ne.description}))})).finally((()=>{z.layout().hideBackdrop()}))},children:"Update assignment"})})]})})}),"student"===$&&(0,O.jsxs)(l.A,{ml:3,mr:3,children:[(0,O.jsx)(p.A,{variant:"warning",children:"Student version of the assignment."}),W.map((e=>(0,O.jsxs)(p.A,{variant:"danger",children:[(0,O.jsx)(x.A,{icon:v._0O}),e]}))),K&&0===W.length&&(0,O.jsx)(k.g,{id:`${e}-student`,height:"calc(100vh - 240px)",maxHeight:"calc(100vh - 240px)",nbformat:K,readonly:!0,extensions:re})]})]})]})},z=V},46916:(e,n,s)=>{s.d(n,{E:()=>o});var t=s(71791),i=s(99180),a=s(38621),r=s(9387),l=s(18683);function o(e){const{commandRegistry:n,kernelDesc:s,save:o,sessionConnection:c}=e,[d,u]=(0,r.useState)();return(0,r.useEffect)((()=>{const e=()=>{u(c?.kernel?.status)};return e(),c?.statusChanged.connect(e),c?.connectionStatusChanged.connect(e),()=>{c?.statusChanged.disconnect(e),c?.connectionStatusChanged.disconnect(e)}}),[c]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.Q,{variant:"invisible",size:"small",leadingVisual:a.iKr,disabled:void 0===s?.location,onClick:o,children:"Save"}),(0,l.jsx)(i.Q,{variant:"invisible",size:"small",leadingVisual:a.udU,disabled:!s?.location||"busy"===d,onClick:e=>{n?.execute(t.nx.runAll)},children:"Run all"}),(0,l.jsx)(i.Q,{variant:"invisible",size:"small",leadingVisual:a.wFz,disabled:!s?.location||"busy"!==d,onClick:e=>{n?.execute(t.nx.interrupt)},children:"Interrupt"})]})}},84271:(e,n,s)=>{s.d(n,{a:()=>c});var t=s(18683),i=s(38621),a=s(98754),r=s(99180),l=s(71791),o=s(84604);function c(e){const{commands:n}=e;return(0,t.jsx)(a.A,{className:o.VL,sx:{"& p":{marginBottom:"0 !important"}},children:(0,t.jsx)(r.Q,{trailingVisual:i.udU,size:"small",variant:"invisible",onClick:e=>{e.preventDefault(),n.execute(l.nx.run).catch((e=>{console.error("Failed to run cell.",e)}))},children:"Run"})})}}}]);