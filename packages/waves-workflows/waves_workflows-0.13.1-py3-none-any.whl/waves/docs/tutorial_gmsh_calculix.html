
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tutorial: Gmsh+CalculiX &#8212; WAVES 0.13.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=cb027bf8" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=cb027bf8" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=aec58b01"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=5c42fc81"></script>
    <script src="_static/custom.js?v=070b234d"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorial_gmsh_calculix';</script>
    <link rel="icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ModSim Templates" href="templates.html" />
    <link rel="prev" title="Tutorial: Quinoa" href="tutorial_quinoa.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Apr 16, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/waves_logo_brandmark_smaller.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="_static/waves_logo_brandmark_smaller.png" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">0.13.1</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Computational Practices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="computational_practices_introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_practices_version_control.html">Version Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_practices_documentation.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_practices_build_system.html">Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_practices_compute_environment.html">Compute Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_practices_regression_testing.html">Regression Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_practices_archival.html">Data Archival</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">User Manual</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="abstract.html">Why WAVES?</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="waves_quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_introduction.html">Tutorial Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial_core.html">Core Lessons</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial_00_scons.html">Tutorial 00: SConstruct</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_01_geometry.html">Tutorial 01: Geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_02_partition_mesh.html">Tutorial 02: Partition and Mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_03_solverprep.html">Tutorial 03: SolverPrep</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_04_simulation.html">Tutorial 04: Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_05_parameter_substitution.html">Tutorial 05: Parameter Substitution</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_06_include_files.html">Tutorial 06: Include Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_07_cartesian_product.html">Tutorial 07: Cartesian Product</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_08_data_extraction.html">Tutorial 08: Data Extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_09_post_processing.html">Tutorial 09: Post-Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_10_unit_testing.html">Tutorial 10: Unit Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_11_regression_testing.html">Tutorial 11: Regression Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_12_archival.html">Tutorial 12: Data Archival</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial_supplemental.html">Supplemental Lessons</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="scons_quickstart.html">SCons Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="scons_multiactiontask.html">SCons Multi-Action Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_argparse_types.html">Tutorial: Input Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_cubit_abaqus.html">Tutorial: Cubit+Abaqus</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_cubit_sierra.html">Tutorial: Cubit+Sierra</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_cubit_fierro.html">Tutorial: Cubit+Fierro</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_escape_sequences.html">Tutorial: Escape Sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_07_latin_hypercube.html">Tutorial 07: Latin Hypercube</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_07_sobol_sequence.html">Tutorial 07: Sobol Sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_07_one_at_a_time.html">Tutorial 07: One-at-a-Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_mesh_convergence.html">Tutorial: Mesh Convergence</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_part_image.html">Tutorial: Part Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_sensitivity_study.html">Tutorial: Sensitivity Study</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_abaqus_cae.html">Tutorial: Abaqus CAE</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="tutorial_wip.html">Work-in-progress Lessons</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial_writing_builders.html">Tutorial: Writing Builders</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_remote_execution.html">Tutorial: Simulation via SSH</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_sbatch.html">Tutorial: Simulation via SLURM</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_extend_study.html">Automatically Extending a Parameter Study</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_task_reuse.html">Tutorial: Task Definition Reuse</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_setuptools_scm.html">Tutorial: setuptools_scm</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_quinoa.html">Tutorial: Quinoa</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Tutorial: Gmsh+CalculiX</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="templates.html">ModSim Templates</a></li>

<li class="toctree-l1"><a class="reference internal" href="api.html">External API</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command-Line Utilities</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Help and Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="license.html">LICENSE</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="internal_api.html">Internal API</a></li>
<li class="toctree-l1"><a class="reference internal" href="devops.html">Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_philosophy.html">Release Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="tutorial_api.html">WAVES-TUTORIAL API</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_cli.html">WAVES-TUTORIAL CLI</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="tutorial_wip.html" class="nav-link">Work-in-progress Lessons</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Tutorial:...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/lanl-aea/waves" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/lanl-aea/waves/blob/main/docs/tutorial_gmsh_calculix.rst?plain=1" target="_blank"
   class="btn btn-sm btn-source-file-button dropdown-item"
   title="Show source"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">Show source</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/tutorial_gmsh_calculix.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tutorial: Gmsh+CalculiX</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#environment">Environment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#directory-structure">Directory Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sconscript">SConscript</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gmsh-python-script">Gmsh Python script</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculix-input-file">CalculiX Input File</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sconstruct">SConstruct</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-targets">Build Targets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#output-files">Output Files</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="tutorial-gmsh-calculix">
<span id="id1"></span><h1>Tutorial: Gmsh+CalculiX<a class="headerlink" href="#tutorial-gmsh-calculix" title="Link to this heading">#</a></h1>
<p>This tutorial mirrors the Abaqus-based core tutorials with a fully open-source, conda-forge workflow. The geometry is
created and meshed with <a class="reference external" href="https://gmsh.info/">Gmsh</a>. The finite element simulation is performed with <a class="reference external" href="http://www.dhondt.de/">CalculiX</a>. Finally, the data is
extracted with <a class="reference external" href="https://github.com/calculix/ccx2paraview">ccx2paraview</a> and <a class="reference external" href="https://github.com/nschloe/meshio">meshio</a> for scripted quantity of interest (QoI) calculations and post-processing.</p>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://gmsh.info/">Gmsh</a> <span id="id2">[<a class="reference internal" href="zreferences.html#id76" title="Christophe Geuzaine and Jean-François Remacle. Gmsh: a 3-d finite element mesh generator with built-in pre- and post-processing facilities. International Journal for Numerical Methods in Engineering, 79(11):1309-1331, 2009. URL: https://onlinelibrary.wiley.com/doi/abs/10.1002/nme.2579, arXiv:https://onlinelibrary.wiley.com/doi/pdf/10.1002/nme.2579, doi:https://doi.org/10.1002/nme.2579.">73</a>, <a class="reference internal" href="zreferences.html#id77" title="Christophe Geuzaine and Jean-François Remacl. Gmsh. 2024. URL: https://gmsh.info/ (visited on 2024-10-15).">74</a>]</span></p></li>
<li><p><a class="reference external" href="http://www.dhondt.de/">CalculiX</a> <span id="id3">[<a class="reference internal" href="zreferences.html#id78" title="Guido Dhondt and Klaus Wittig. CalculiX. 2024. URL: http://www.calculix.de/ (visited on 2024-10-15).">75</a>]</span></p></li>
<li><p><a class="reference external" href="https://github.com/calculix/ccx2paraview">ccx2paraview</a> <span id="id4">[<a class="reference internal" href="zreferences.html#id79" title="Ihor Mirzov. ccx2paraview. 2024. URL: https://github.com/calculix/ccx2paraview (visited on 2024-10-15).">76</a>]</span></p></li>
<li><p><a class="reference external" href="https://github.com/nschloe/meshio">meshio</a> <span id="id5">[<a class="reference internal" href="zreferences.html#id80" title="Nico Schlömer. meshio: Tools for mesh files. URL: https://github.com/nschloe/meshio, doi:10.5281/zenodo.1173115.">62</a>]</span></p></li>
</ul>
</section>
<section id="environment">
<h2>Environment<a class="headerlink" href="#environment" title="Link to this heading">#</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The Gmsh+CalculiX tutorial requires a different compute environment than the other tutorials. The following commands
create a dedicated environment for the use of this tutorial. You can also use your existing tutorial environment with
the <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span></code> command while your environment is active.</p>
</div>
<p>All of the software required for this tutorial can be installed in a <a class="reference external" href="https://docs.conda.io/en/latest/">Conda</a> environment with the <a class="reference external" href="https://docs.conda.io/en/latest/">Conda</a> package
manager. See the <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/install/index.html">Conda installation</a> and <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html">Conda environment management</a> documentation for more details about using
<a class="reference external" href="https://docs.conda.io/en/latest/">Conda</a>.</p>
<ol class="arabic">
<li><p>Create the Gmsh+ tutorial environment if it doesn’t exist</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda create --name waves-gmsh-env --channel conda-forge waves &#39;scons&gt;=4.6&#39; python-gmsh calculix &#39;ccx2paraview&gt;=3.2&#39; meshio
</pre></div>
</div>
</li>
<li><p>Activate the environment</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda activate waves-gmsh-env
</pre></div>
</div>
</li>
</ol>
</section>
<section id="directory-structure">
<h2>Directory Structure<a class="headerlink" href="#directory-structure" title="Link to this heading">#</a></h2>
<ol class="arabic simple" start="3">
<li><p>Create and change to a new project root directory to house the tutorial files if you have not already done so. For example</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>~/waves-tutorials
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~/waves-tutorials
$<span class="w"> </span><span class="nb">pwd</span>
/home/roppenheimer/waves-tutorials
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Create a new <code class="docutils literal notranslate"><span class="pre">tutorial_gmsh</span></code> directory with the <code class="docutils literal notranslate"><span class="pre">waves</span> <span class="pre">fetch</span></code> command below</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">pwd</span>
/home/roppenheimer/waves-tutorials
$<span class="w"> </span>waves<span class="w"> </span>fetch<span class="w"> </span>--destination<span class="w"> </span>tutorial_gmsh<span class="w"> </span>tutorials/tutorial_gmsh
$<span class="w"> </span>ls<span class="w"> </span>tutorial_gmsh
SConscript<span class="w">  </span>SConstruct<span class="w">  </span>environment.yml<span class="w">  </span>post_processing.py<span class="w">  </span>rectangle.py<span class="w">  </span>rectangle_compression.inp<span class="w">  </span>strip_heading.py<span class="w">  </span>vtu2xarray.py
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Make the new <code class="docutils literal notranslate"><span class="pre">tutorial_gmsh</span></code> directory the current working directory</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">pwd</span>
/home/roppenheimer/waves-tutorials
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>tutorial_gmsh
$<span class="w"> </span><span class="nb">pwd</span>
/home/roppenheimer/waves-tutorials/tutorial_gmsh
$<span class="w"> </span>ls
SConscript<span class="w">  </span>SConstruct<span class="w">  </span>environment.yml<span class="w">  </span>post_processing.py<span class="w">  </span>rectangle.py<span class="w">  </span>rectangle_compression.inp<span class="w">  </span>strip_heading.py<span class="w">  </span>vtu2xarray.py
</pre></div>
</div>
</section>
<section id="sconscript">
<h2>SConscript<a class="headerlink" href="#sconscript" title="Link to this heading">#</a></h2>
<ol class="arabic simple" start="6">
<li><p>Review the <code class="docutils literal notranslate"><span class="pre">SConscript</span></code> workflow configuration file.</p></li>
</ol>
<p>The structure is sufficiently different from the core tutorials that a diff view is not as useful. Instead the contents
of the new SConscript files are duplicated below.</p>
<div class="admonition-waves-tutorials-tutorial-gmsh-sconscript admonition">
<p class="admonition-title">waves-tutorials/tutorial_gmsh/SConscript</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="ch">#! /usr/bin/env python</span>
<span class="linenos"> 2</span><span class="kn">import</span><span class="w"> </span><span class="nn">waves</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="n">Import</span><span class="p">(</span><span class="s2">&quot;env&quot;</span><span class="p">)</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="c1"># Collect the target nodes to build concise target alias(es)</span>
<span class="linenos"> 7</span><span class="n">artifacts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos"> 8</span><span class="n">workflow</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1"># Geometry, Partition, Mesh</span>
<span class="linenos">11</span><span class="n">artifacts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
<span class="linenos">12</span>    <span class="n">env</span><span class="o">.</span><span class="n">PythonScript</span><span class="p">(</span>
<span class="linenos">13</span>        <span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rectangle_gmsh.inp&quot;</span><span class="p">],</span>
<span class="linenos">14</span>        <span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rectangle.py&quot;</span><span class="p">],</span>
<span class="linenos">15</span>        <span class="n">subcommand_options</span><span class="o">=</span><span class="s2">&quot;--output-file=$</span><span class="si">{TARGET.abspath}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="linenos">16</span>        <span class="n">action_suffix</span><span class="o">=</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;action_suffix&quot;</span><span class="p">],</span>
<span class="linenos">17</span>    <span class="p">)</span>
<span class="linenos">18</span><span class="p">)</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="n">artifacts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
<span class="linenos">21</span>    <span class="n">env</span><span class="o">.</span><span class="n">PythonScript</span><span class="p">(</span>
<span class="linenos">22</span>        <span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rectangle_mesh.inp&quot;</span><span class="p">],</span>
<span class="linenos">23</span>        <span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;strip_heading.py&quot;</span><span class="p">,</span> <span class="s2">&quot;rectangle_gmsh.inp&quot;</span><span class="p">],</span>
<span class="linenos">24</span>        <span class="n">subcommand_options</span><span class="o">=</span><span class="s2">&quot;--input-file=$</span><span class="si">{SOURCES[1].abspath}</span><span class="s2"> --output-file=$</span><span class="si">{TARGET.abspath}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="linenos">25</span>        <span class="n">action_suffix</span><span class="o">=</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;action_suffix&quot;</span><span class="p">],</span>
<span class="linenos">26</span>    <span class="p">)</span>
<span class="linenos">27</span><span class="p">)</span>
<span class="linenos">28</span>
<span class="linenos">29</span><span class="c1"># CalculiX Solve</span>
<span class="linenos">30</span><span class="n">artifacts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
<span class="linenos">31</span>    <span class="n">env</span><span class="o">.</span><span class="n">CalculiX</span><span class="p">(</span>
<span class="linenos">32</span>        <span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;rectangle_compression.</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;frd&quot;</span><span class="p">,</span> <span class="s2">&quot;dat&quot;</span><span class="p">,</span> <span class="s2">&quot;sta&quot;</span><span class="p">,</span> <span class="s2">&quot;cvg&quot;</span><span class="p">,</span> <span class="s2">&quot;12d&quot;</span><span class="p">)],</span>
<span class="linenos">33</span>        <span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rectangle_compression.inp&quot;</span><span class="p">],</span>
<span class="linenos">34</span>        <span class="n">action_suffix</span><span class="o">=</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;action_suffix&quot;</span><span class="p">],</span>
<span class="linenos">35</span>    <span class="p">)</span>
<span class="linenos">36</span><span class="p">)</span>
<span class="linenos">37</span>
<span class="linenos">38</span><span class="c1"># Extract</span>
<span class="linenos">39</span><span class="n">artifacts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
<span class="linenos">40</span>    <span class="n">env</span><span class="o">.</span><span class="n">Command</span><span class="p">(</span>
<span class="linenos">41</span>        <span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rectangle_compression.vtu&quot;</span><span class="p">,</span> <span class="s2">&quot;rectangle_compression.vtu.stdout&quot;</span><span class="p">],</span>
<span class="linenos">42</span>        <span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rectangle_compression.frd&quot;</span><span class="p">],</span>
<span class="linenos">43</span>        <span class="n">action</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cd $</span><span class="si">{TARGET.dir.abspath}</span><span class="s2"> &amp;&amp; ccx2paraview $</span><span class="si">{SOURCES[0].abspath}</span><span class="s2"> vtu $</span><span class="si">{action_suffix}</span><span class="s2">&quot;</span><span class="p">],</span>
<span class="linenos">44</span>        <span class="n">action_suffix</span><span class="o">=</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;action_suffix&quot;</span><span class="p">],</span>
<span class="linenos">45</span>    <span class="p">)</span>
<span class="linenos">46</span><span class="p">)</span>
<span class="linenos">47</span><span class="n">workflow</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
<span class="linenos">48</span>    <span class="n">env</span><span class="o">.</span><span class="n">PythonScript</span><span class="p">(</span>
<span class="linenos">49</span>        <span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rectangle_compression.h5&quot;</span><span class="p">],</span>
<span class="linenos">50</span>        <span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;vtu2xarray.py&quot;</span><span class="p">,</span> <span class="s2">&quot;rectangle_compression.vtu&quot;</span><span class="p">],</span>
<span class="linenos">51</span>        <span class="n">subcommand_options</span><span class="o">=</span><span class="s2">&quot;--input-file $</span><span class="si">{SOURCES[1].abspath}</span><span class="s2"> --output-file $</span><span class="si">{TARGET.abspath}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="linenos">52</span>        <span class="n">action_suffix</span><span class="o">=</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;action_suffix&quot;</span><span class="p">],</span>
<span class="linenos">53</span>    <span class="p">)</span>
<span class="linenos">54</span><span class="p">)</span>
<span class="linenos">55</span>
<span class="linenos">56</span><span class="c1"># Post-processing</span>
<span class="linenos">57</span><span class="n">script_options</span> <span class="o">=</span> <span class="s2">&quot;--input-file $</span><span class="si">{SOURCES[1:].abspath}</span><span class="s2">&quot;</span>
<span class="linenos">58</span><span class="n">script_options</span> <span class="o">+=</span> <span class="s2">&quot; --output-file $</span><span class="si">{TARGET.file}</span><span class="s2"> --x-units mm/mm --y-units MPa&quot;</span>
<span class="linenos">59</span><span class="n">workflow</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
<span class="linenos">60</span>    <span class="n">env</span><span class="o">.</span><span class="n">PythonScript</span><span class="p">(</span>
<span class="linenos">61</span>        <span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;stress_strain_comparison.pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;stress_strain_comparison.csv&quot;</span><span class="p">],</span>
<span class="linenos">62</span>        <span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;post_processing.py&quot;</span><span class="p">,</span> <span class="s2">&quot;rectangle_compression.h5&quot;</span><span class="p">],</span>
<span class="linenos">63</span>        <span class="n">subcommand_options</span><span class="o">=</span><span class="n">script_options</span><span class="p">,</span>
<span class="linenos">64</span>    <span class="p">)</span>
<span class="linenos">65</span><span class="p">)</span>
<span class="linenos">66</span><span class="n">artifacts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">workflow</span><span class="p">)</span>
<span class="linenos">67</span>
<span class="linenos">68</span><span class="c1"># Collector alias named after the model simulation</span>
<span class="linenos">69</span><span class="n">env</span><span class="o">.</span><span class="n">Alias</span><span class="p">(</span><span class="s2">&quot;rectangle&quot;</span><span class="p">,</span> <span class="n">workflow</span><span class="p">)</span>
<span class="linenos">70</span>
<span class="linenos">71</span><span class="k">if</span> <span class="ow">not</span> <span class="n">env</span><span class="p">[</span><span class="s2">&quot;unconditional_build&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">env</span><span class="p">[</span><span class="s2">&quot;CCX_PROGRAM&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">env</span><span class="p">[</span><span class="s2">&quot;ccx2paraview&quot;</span><span class="p">]):</span>
<span class="linenos">72</span>    <span class="nb">print</span><span class="p">(</span>
<span class="linenos">73</span>        <span class="s2">&quot;Program &#39;CalculiX (ccx)&#39; or &#39;ccx2paraview&#39; was not found in construction environment. &quot;</span>
<span class="linenos">74</span>        <span class="s2">&quot;Ignoring &#39;rectangle&#39; target(s)&quot;</span>
<span class="linenos">75</span>    <span class="p">)</span>
<span class="linenos">76</span>    <span class="n">Ignore</span><span class="p">([</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;rectangle&quot;</span><span class="p">],</span> <span class="n">workflow</span> <span class="o">+</span> <span class="n">artifacts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="gmsh-python-script">
<h2>Gmsh Python script<a class="headerlink" href="#gmsh-python-script" title="Link to this heading">#</a></h2>
<ol class="arabic simple" start="7">
<li><p>Review the Gmsh Python script <code class="docutils literal notranslate"><span class="pre">rectangle.py</span></code>.</p></li>
</ol>
<p>The Gmsh script differs from the Abaqus journal files introduced in <a class="reference internal" href="tutorial_02_partition_mesh.html#tutorial-partition-mesh"><span class="std std-ref">Tutorial 02: Partition and Mesh</span></a>. Besides the
differences in Abaqus and Gmsh commands, one major difference between the Abaqus and Gmsh scripts is the
opportunity to use Python 3 with Gmsh, where Abaqus journal files must use the Abaqus controlled installation of Python
2. The Gmsh script creates the geometry, partition (sets), and mesh in a single script because the output formats used
by Gmsh can not contain both the geometry definition and the mesh information.</p>
<div class="admonition-waves-tutorials-tutorial-gmsh-rectangle-py admonition">
<p class="admonition-title">waves-tutorials/tutorial_gmsh/rectangle.py</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="kn">import</span><span class="w"> </span><span class="nn">typing</span>
<span class="linenos">  2</span><span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>
<span class="linenos">  3</span><span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<span class="linenos">  4</span>
<span class="linenos">  5</span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
<span class="linenos">  6</span><span class="kn">import</span><span class="w"> </span><span class="nn">gmsh</span>
<span class="linenos">  7</span>
<span class="linenos">  8</span>
<span class="linenos">  9</span><span class="n">script_name</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="linenos"> 10</span><span class="c1"># Set default parameter values</span>
<span class="linenos"> 11</span><span class="n">default_output_file</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">script_name</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.msh&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="linenos"> 12</span><span class="n">default_width</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos"> 13</span><span class="n">default_height</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos"> 14</span><span class="n">default_global_seed</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos"> 15</span>
<span class="linenos"> 16</span>
<span class="linenos"> 17</span><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span>
<span class="linenos"> 18</span>    <span class="n">output_file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span> <span class="o">=</span> <span class="n">default_output_file</span><span class="p">,</span>
<span class="linenos"> 19</span>    <span class="n">width</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">default_width</span><span class="p">,</span>
<span class="linenos"> 20</span>    <span class="n">height</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">default_height</span><span class="p">,</span>
<span class="linenos"> 21</span>    <span class="n">global_seed</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">default_global_seed</span><span class="p">,</span>
<span class="linenos"> 22</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 23</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a simple rectangle geometry.</span>
<span class="linenos"> 24</span>
<span class="linenos"> 25</span><span class="sd">    This script creates a simple Gmsh model with a single rectangle part.</span>
<span class="linenos"> 26</span>
<span class="linenos"> 27</span><span class="sd">    :param output_file: The output file for the Gmsh model. Extension must match a supported Gmsh file type.</span>
<span class="linenos"> 28</span><span class="sd">    :param width: The rectangle width</span>
<span class="linenos"> 29</span><span class="sd">    :param height: The rectangle height</span>
<span class="linenos"> 30</span><span class="sd">    :param global_seed: The global mesh seed size</span>
<span class="linenos"> 31</span>
<span class="linenos"> 32</span><span class="sd">    :returns: writes ``output_file``</span>
<span class="linenos"> 33</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos"> 34</span>    <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<span class="linenos"> 35</span>    <span class="n">gmsh</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="linenos"> 36</span>    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;rectangle&quot;</span><span class="p">)</span>
<span class="linenos"> 37</span>
<span class="linenos"> 38</span>    <span class="c1"># Geometry</span>
<span class="linenos"> 39</span>    <span class="n">rectangle_tag</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">addRectangle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
<span class="linenos"> 40</span>    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
<span class="linenos"> 41</span>
<span class="linenos"> 42</span>    <span class="c1"># Partition</span>
<span class="linenos"> 43</span>    <span class="c1"># TODO: Move to separate function/script</span>
<span class="linenos"> 44</span>    <span class="n">rectangle_group_tag</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">rectangle_tag</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;rectangle&quot;</span><span class="p">)</span>
<span class="linenos"> 45</span>
<span class="linenos"> 46</span>    <span class="n">tolerance</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
<span class="linenos"> 47</span>    <span class="n">bottom_left</span> <span class="o">=</span> <span class="n">get_entities_at_coordinates</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="linenos"> 48</span>    <span class="n">top_right</span> <span class="o">=</span> <span class="n">get_entities_at_coordinates</span><span class="p">((</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="linenos"> 49</span>    <span class="c1"># fmt: off</span>
<span class="linenos"> 50</span>    <span class="n">top</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getEntitiesInBoundingBox</span><span class="p">(</span>
<span class="linenos"> 51</span>        <span class="mf">0.0</span>    <span class="o">-</span> <span class="n">tolerance</span><span class="p">,</span>  <span class="c1"># noqa: E221 X-min</span>
<span class="linenos"> 52</span>        <span class="n">height</span> <span class="o">-</span> <span class="n">tolerance</span><span class="p">,</span>  <span class="c1"># noqa: E221 Y-min</span>
<span class="linenos"> 53</span>        <span class="mf">0.0</span>    <span class="o">-</span> <span class="n">tolerance</span><span class="p">,</span>  <span class="c1"># noqa: E221 Z-min</span>
<span class="linenos"> 54</span>        <span class="n">width</span>  <span class="o">+</span> <span class="n">tolerance</span><span class="p">,</span>  <span class="c1"># noqa: E221 X-max</span>
<span class="linenos"> 55</span>        <span class="n">height</span> <span class="o">+</span> <span class="n">tolerance</span><span class="p">,</span>  <span class="c1"># noqa: E221 Y-max</span>
<span class="linenos"> 56</span>        <span class="mf">0.0</span>    <span class="o">+</span> <span class="n">tolerance</span><span class="p">,</span>  <span class="c1"># noqa: E221 Z-max</span>
<span class="linenos"> 57</span>        <span class="mi">0</span>  <span class="c1"># Entity dimension: points</span>
<span class="linenos"> 58</span>    <span class="p">)</span>
<span class="linenos"> 59</span>    <span class="n">bottom</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getEntitiesInBoundingBox</span><span class="p">(</span>
<span class="linenos"> 60</span>        <span class="mf">0.0</span>    <span class="o">-</span> <span class="n">tolerance</span><span class="p">,</span>  <span class="c1"># noqa: E221 X-min</span>
<span class="linenos"> 61</span>        <span class="mf">0.0</span>    <span class="o">-</span> <span class="n">tolerance</span><span class="p">,</span>  <span class="c1"># noqa: E221 Y-min</span>
<span class="linenos"> 62</span>        <span class="mf">0.0</span>    <span class="o">-</span> <span class="n">tolerance</span><span class="p">,</span>  <span class="c1"># noqa: E221 Z-min</span>
<span class="linenos"> 63</span>        <span class="n">width</span>  <span class="o">+</span> <span class="n">tolerance</span><span class="p">,</span>  <span class="c1"># noqa: E221 X-max</span>
<span class="linenos"> 64</span>        <span class="mf">0.0</span>    <span class="o">+</span> <span class="n">tolerance</span><span class="p">,</span>  <span class="c1"># noqa: E221 Y-max</span>
<span class="linenos"> 65</span>        <span class="mf">0.0</span>    <span class="o">+</span> <span class="n">tolerance</span><span class="p">,</span>  <span class="c1"># noqa: E221 Z-max</span>
<span class="linenos"> 66</span>        <span class="mi">0</span>  <span class="c1"># Entity dimension: points</span>
<span class="linenos"> 67</span>    <span class="p">)</span>
<span class="linenos"> 68</span>    <span class="n">left</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getEntitiesInBoundingBox</span><span class="p">(</span>
<span class="linenos"> 69</span>        <span class="mf">0.0</span>    <span class="o">-</span> <span class="n">tolerance</span><span class="p">,</span>  <span class="c1"># noqa: E221 X-min</span>
<span class="linenos"> 70</span>        <span class="mf">0.0</span>    <span class="o">-</span> <span class="n">tolerance</span><span class="p">,</span>  <span class="c1"># noqa: E221 Y-min</span>
<span class="linenos"> 71</span>        <span class="mf">0.0</span>    <span class="o">-</span> <span class="n">tolerance</span><span class="p">,</span>  <span class="c1"># noqa: E221 Z-min</span>
<span class="linenos"> 72</span>        <span class="mf">0.0</span>    <span class="o">+</span> <span class="n">tolerance</span><span class="p">,</span>  <span class="c1"># noqa: E221 X-max</span>
<span class="linenos"> 73</span>        <span class="n">height</span> <span class="o">+</span> <span class="n">tolerance</span><span class="p">,</span>  <span class="c1"># noqa: E221 Y-max</span>
<span class="linenos"> 74</span>        <span class="mf">0.0</span>    <span class="o">+</span> <span class="n">tolerance</span><span class="p">,</span>  <span class="c1"># noqa: E221 Z-max</span>
<span class="linenos"> 75</span>        <span class="mi">0</span>  <span class="c1"># Entity dimension: points</span>
<span class="linenos"> 76</span>    <span class="p">)</span>
<span class="linenos"> 77</span>    <span class="c1"># fmt: on</span>
<span class="linenos"> 78</span>    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tags_from_dimTags</span><span class="p">(</span><span class="n">bottom_left</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;bottom_left&quot;</span><span class="p">)</span>
<span class="linenos"> 79</span>    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tags_from_dimTags</span><span class="p">(</span><span class="n">top_right</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;top_right&quot;</span><span class="p">)</span>
<span class="linenos"> 80</span>    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tags_from_dimTags</span><span class="p">(</span><span class="n">top</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
<span class="linenos"> 81</span>    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tags_from_dimTags</span><span class="p">(</span><span class="n">bottom</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
<span class="linenos"> 82</span>    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tags_from_dimTags</span><span class="p">(</span><span class="n">left</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="linenos"> 83</span>
<span class="linenos"> 84</span>    <span class="c1"># Mesh</span>
<span class="linenos"> 85</span>    <span class="c1"># TODO: Move to separate function/script</span>
<span class="linenos"> 86</span>    <span class="n">points</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos"> 87</span>    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setSize</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">global_seed</span><span class="p">)</span>
<span class="linenos"> 88</span>    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="linenos"> 89</span>    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">recombine</span><span class="p">()</span>
<span class="linenos"> 90</span>
<span class="linenos"> 91</span>    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.SaveGroupsOfElements&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="linenos"> 92</span>    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.SaveGroupsOfNodes&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="linenos"> 93</span>
<span class="linenos"> 94</span>    <span class="n">gmsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_file</span><span class="p">))</span>
<span class="linenos"> 95</span>    <span class="n">gmsh</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="linenos"> 96</span>    <span class="n">gmsh</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
<span class="linenos"> 97</span>
<span class="linenos"> 98</span>
<span class="linenos"> 99</span><span class="k">def</span><span class="w"> </span><span class="nf">tags_from_dimTags</span><span class="p">(</span><span class="n">dimTags</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="linenos">100</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return tags from Gmsh entity ``dimTags`` list of tuples</span>
<span class="linenos">101</span>
<span class="linenos">102</span><span class="sd">    :returns: list of tags</span>
<span class="linenos">103</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">104</span>    <span class="k">return</span> <span class="p">[</span><span class="n">dimTag</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">dimTag</span> <span class="ow">in</span> <span class="n">dimTags</span><span class="p">]</span>
<span class="linenos">105</span>
<span class="linenos">106</span>
<span class="linenos">107</span><span class="k">def</span><span class="w"> </span><span class="nf">get_entities_at_coordinates</span><span class="p">(</span>
<span class="linenos">108</span>    <span class="n">coordinates</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
<span class="linenos">109</span>    <span class="n">dimension</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="linenos">110</span>    <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0e-6</span><span class="p">,</span>
<span class="linenos">111</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<span class="linenos">112</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return Gmsh ``dimTags`` of entities of dimension within bounding box determined by coordinates and tolerance</span>
<span class="linenos">113</span>
<span class="linenos">114</span><span class="sd">    :param coordinates: 3D coordinates (X, Y, Z) for center of bounding box</span>
<span class="linenos">115</span><span class="sd">    :param dimension: Return entities matching dimension</span>
<span class="linenos">116</span><span class="sd">    :param tolerance: Distance from center of bounding box to edges of bounding box</span>
<span class="linenos">117</span>
<span class="linenos">118</span><span class="sd">    :returns: Gmsh entity ``dimTags``</span>
<span class="linenos">119</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">120</span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
<span class="linenos">121</span>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;coordinates must have length 3&quot;</span><span class="p">)</span>
<span class="linenos">122</span>    <span class="n">center</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
<span class="linenos">123</span>    <span class="n">tolerance_array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tolerance</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">])</span>
<span class="linenos">124</span>    <span class="n">min_coordinate</span> <span class="o">=</span> <span class="n">center</span> <span class="o">-</span> <span class="n">tolerance_array</span>
<span class="linenos">125</span>    <span class="n">max_coordinate</span> <span class="o">=</span> <span class="n">center</span> <span class="o">+</span> <span class="n">tolerance_array</span>
<span class="linenos">126</span>    <span class="k">return</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getEntitiesInBoundingBox</span><span class="p">(</span><span class="o">*</span><span class="n">min_coordinate</span><span class="p">,</span> <span class="o">*</span><span class="n">max_coordinate</span><span class="p">,</span> <span class="n">dimension</span><span class="p">)</span>
<span class="linenos">127</span>
<span class="linenos">128</span>
<span class="linenos">129</span><span class="k">def</span><span class="w"> </span><span class="nf">get_parser</span><span class="p">():</span>
<span class="linenos">130</span>    <span class="n">prog</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;python </span><span class="si">{</span><span class="n">script_name</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> &quot;</span>
<span class="linenos">131</span>    <span class="n">cli_description</span> <span class="o">=</span> <span class="s2">&quot;Create a simple rectangle geometry and write an ``output_file``.msh Gmsh model file.&quot;</span>
<span class="linenos">132</span>    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="n">cli_description</span><span class="p">,</span> <span class="n">prog</span><span class="o">=</span><span class="n">prog</span><span class="p">)</span>
<span class="linenos">133</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">134</span>        <span class="s2">&quot;--output-file&quot;</span><span class="p">,</span>
<span class="linenos">135</span>        <span class="nb">type</span><span class="o">=</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
<span class="linenos">136</span>        <span class="n">default</span><span class="o">=</span><span class="n">default_output_file</span><span class="p">,</span>
<span class="linenos">137</span>        <span class="c1"># fmt: off</span>
<span class="linenos">138</span>        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The output file for the Gmsh model. Extension must match a supported Gmsh file type, e.g. &quot;</span>
<span class="linenos">139</span>             <span class="s2">&quot;``output_file``.msh (default: </span><span class="si">%(default)s</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="linenos">140</span>        <span class="c1"># fmt: on</span>
<span class="linenos">141</span>    <span class="p">)</span>
<span class="linenos">142</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">143</span>        <span class="s2">&quot;--width&quot;</span><span class="p">,</span>
<span class="linenos">144</span>        <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
<span class="linenos">145</span>        <span class="n">default</span><span class="o">=</span><span class="n">default_width</span><span class="p">,</span>
<span class="linenos">146</span>        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The rectangle width&quot;</span><span class="p">,</span>
<span class="linenos">147</span>    <span class="p">)</span>
<span class="linenos">148</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">149</span>        <span class="s2">&quot;--height&quot;</span><span class="p">,</span>
<span class="linenos">150</span>        <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
<span class="linenos">151</span>        <span class="n">default</span><span class="o">=</span><span class="n">default_height</span><span class="p">,</span>
<span class="linenos">152</span>        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The rectangle height&quot;</span><span class="p">,</span>
<span class="linenos">153</span>    <span class="p">)</span>
<span class="linenos">154</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">155</span>        <span class="s2">&quot;--global-seed&quot;</span><span class="p">,</span>
<span class="linenos">156</span>        <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
<span class="linenos">157</span>        <span class="n">default</span><span class="o">=</span><span class="n">default_global_seed</span><span class="p">,</span>
<span class="linenos">158</span>        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The global mesh seed size (default: </span><span class="si">%(default)s</span><span class="s2">)&quot;</span><span class="p">,</span>
<span class="linenos">159</span>    <span class="p">)</span>
<span class="linenos">160</span>    <span class="k">return</span> <span class="n">parser</span>
<span class="linenos">161</span>
<span class="linenos">162</span>
<span class="linenos">163</span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="linenos">164</span>    <span class="n">parser</span> <span class="o">=</span> <span class="n">get_parser</span><span class="p">()</span>
<span class="linenos">165</span>    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="linenos">166</span>    <span class="n">main</span><span class="p">(</span>
<span class="linenos">167</span>        <span class="n">output_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">output_file</span><span class="p">,</span>
<span class="linenos">168</span>        <span class="n">width</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
<span class="linenos">169</span>        <span class="n">height</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
<span class="linenos">170</span>        <span class="n">global_seed</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">global_seed</span><span class="p">,</span>
<span class="linenos">171</span>    <span class="p">)</span>
</pre></div>
</div>
</div>
<p>The other Python scripts will not be discussed in detail. They are small content handling and data conversion utilities
or discussed in greater depth in other tutorials.</p>
</section>
<section id="calculix-input-file">
<h2>CalculiX Input File<a class="headerlink" href="#calculix-input-file" title="Link to this heading">#</a></h2>
<ol class="arabic simple" start="8">
<li><p>Create or review the <a class="reference external" href="http://www.dhondt.de/">CalculiX</a> input file from the contents below</p></li>
</ol>
<div class="admonition-waves-tutorials-tutorial-gmsh-rectangle-compression-inp admonition">
<p class="admonition-title">waves-tutorials/tutorial_gmsh/rectangle_compression.inp</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="o">**</span>
<span class="linenos"> 2</span><span class="o">*</span><span class="n">HEADING</span>
<span class="linenos"> 3</span><span class="n">Compressing</span> <span class="n">a</span> <span class="n">rectangle</span>
<span class="linenos"> 4</span><span class="o">**</span>
<span class="linenos"> 5</span><span class="o">*</span><span class="n">INCLUDE</span><span class="p">,</span> <span class="n">INPUT</span><span class="o">=</span><span class="n">rectangle_mesh</span><span class="o">.</span><span class="n">inp</span>
<span class="linenos"> 6</span><span class="o">*</span><span class="n">SOLID</span> <span class="n">SECTION</span><span class="p">,</span> <span class="n">ELSET</span><span class="o">=</span><span class="n">RECTANGLE</span><span class="p">,</span> <span class="n">MATERIAL</span><span class="o">=</span><span class="n">mock</span>
<span class="linenos"> 7</span><span class="o">**</span>
<span class="linenos"> 8</span><span class="o">*</span><span class="n">MATERIAL</span><span class="p">,</span> <span class="n">NAME</span><span class="o">=</span><span class="n">mock</span>
<span class="linenos"> 9</span><span class="o">*</span><span class="n">ELASTIC</span>
<span class="linenos">10</span><span class="mi">100</span><span class="p">,</span> <span class="mf">.3</span>
<span class="linenos">11</span><span class="o">*</span><span class="n">DENSITY</span>
<span class="linenos">12</span><span class="mf">.27000E-08</span><span class="p">,</span>
<span class="linenos">13</span><span class="o">*</span><span class="n">SPECIFIC</span> <span class="n">HEAT</span>
<span class="linenos">14</span><span class="mf">8.96E+08</span>
<span class="linenos">15</span><span class="o">*</span><span class="n">CONDUCTIVITY</span>
<span class="linenos">16</span><span class="mi">132</span><span class="p">,</span> <span class="mi">200</span>
<span class="linenos">17</span><span class="o">*</span><span class="n">EXPANSION</span><span class="p">,</span><span class="n">ZERO</span><span class="o">=</span><span class="mf">293.15</span>
<span class="linenos">18</span><span class="mf">23.58E-06</span>
<span class="linenos">19</span><span class="o">**</span>
<span class="linenos">20</span><span class="o">*************************************************************************</span>
<span class="linenos">21</span><span class="o">**</span>  <span class="n">STEP</span><span class="o">-</span><span class="mi">1</span> <span class="n">LOAD</span> <span class="n">STEP</span>
<span class="linenos">22</span><span class="o">*************************************************************************</span>
<span class="linenos">23</span><span class="o">*</span><span class="n">STEP</span><span class="p">,</span> <span class="n">NLGEOM</span><span class="o">=</span><span class="n">NO</span><span class="p">,</span> <span class="n">INC</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">AMPLITUDE</span><span class="o">=</span><span class="n">RAMP</span>
<span class="linenos">24</span><span class="o">*</span><span class="n">STATIC</span>
<span class="linenos">25</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="linenos">26</span><span class="o">**</span>
<span class="linenos">27</span><span class="o">*</span><span class="n">BOUNDARY</span>
<span class="linenos">28</span><span class="n">bottom_left</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<span class="linenos">29</span><span class="n">bottom</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span>
<span class="linenos">30</span><span class="n">top</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mf">0.01</span>
<span class="linenos">31</span><span class="o">**</span>
<span class="linenos">32</span><span class="o">*</span><span class="n">EL</span> <span class="n">FILE</span>
<span class="linenos">33</span><span class="n">E</span><span class="p">,</span> <span class="n">S</span>
<span class="linenos">34</span><span class="o">*</span><span class="n">NODE</span> <span class="n">FILE</span>
<span class="linenos">35</span><span class="n">U</span>
<span class="linenos">36</span><span class="o">**</span>
<span class="linenos">37</span><span class="o">*</span><span class="n">END</span> <span class="n">STEP</span>
</pre></div>
</div>
</div>
</section>
<section id="sconstruct">
<h2>SConstruct<a class="headerlink" href="#sconstruct" title="Link to this heading">#</a></h2>
<p>Note that CalculiX differs from other solvers in the tutorials. CalculiX is deployed as a Conda package and is available in
the launching Conda environment. It is still good practice to check if the executable is available and provide helpful
feedback to developers about the excutable status and workflow configuration.</p>
<p>The structure has changed enough from the core tutorials that a diff view is not as useful. Instead the contents of the
SConstruct file is duplicated below.</p>
<div class="admonition-waves-tutorials-tutorial-gmsh-sconstruct admonition">
<p class="admonition-title">waves-tutorials/tutorial_gmsh/SConstruct</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">platform</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">waves</span>

<span class="c1"># Add build directory CLI arg</span>
<span class="n">AddOption</span><span class="p">(</span>
    <span class="s2">&quot;--build-dir&quot;</span><span class="p">,</span>
    <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;build_dir&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="s2">&quot;build&quot;</span><span class="p">,</span>
    <span class="n">nargs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store&quot;</span><span class="p">,</span>
    <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;DIR&quot;</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;SCons build (variant) root directory. Relative or absolute path. (default: &#39;</span><span class="si">%d</span><span class="s2">efault&#39;)&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">AddOption</span><span class="p">(</span>
    <span class="s2">&quot;--unconditional-build&quot;</span><span class="p">,</span>
    <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;unconditional_build&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Boolean to force building of conditionally ignored targets. (default: &#39;</span><span class="si">%d</span><span class="s2">efault&#39;)&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">AddOption</span><span class="p">(</span>
    <span class="s2">&quot;--verbose-tasks&quot;</span><span class="p">,</span>
    <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;verbose_tasks&quot;</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Boolean to &#39;tee&#39; output for interactive and verbose task execution. (default: &#39;</span><span class="si">%d</span><span class="s2">efault&#39;)&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Inherit user&#39;s full environment</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">waves</span><span class="o">.</span><span class="n">scons_extensions</span><span class="o">.</span><span class="n">WAVESEnvironment</span><span class="p">(</span>
    <span class="n">ENV</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
    <span class="n">build_dir</span><span class="o">=</span><span class="n">GetOption</span><span class="p">(</span><span class="s2">&quot;build_dir&quot;</span><span class="p">),</span>
    <span class="n">unconditional_build</span><span class="o">=</span><span class="n">GetOption</span><span class="p">(</span><span class="s2">&quot;unconditional_build&quot;</span><span class="p">),</span>
    <span class="n">verbose_tasks</span><span class="o">=</span><span class="n">GetOption</span><span class="p">(</span><span class="s2">&quot;verbose_tasks&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Action suffix</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="k">if</span> <span class="n">env</span><span class="p">[</span><span class="s2">&quot;verbose_tasks&quot;</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">system</span> <span class="o">==</span> <span class="s2">&quot;windows&quot;</span><span class="p">:</span>  <span class="c1"># Assume PowerShell</span>
        <span class="n">env</span><span class="p">[</span><span class="s2">&quot;action_suffix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;$(| Tee-Object -FilePath $</span><span class="si">{TARGETS[-1].abspath}</span><span class="s2">$)&quot;</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># *Nix style tee</span>
        <span class="n">env</span><span class="p">[</span><span class="s2">&quot;action_suffix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;$(2&gt;&amp;1 | tee $</span><span class="si">{TARGETS[-1].abspath}</span><span class="s2">$)&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># Default WAVES action suffix</span>
    <span class="n">env</span><span class="p">[</span><span class="s2">&quot;action_suffix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;$(&gt; $</span><span class="si">{TARGETS[-1].abspath}</span><span class="s2"> 2&gt;&amp;1$)&quot;</span>

<span class="c1"># Always copy (no sym-links) when duplicating</span>
<span class="n">env</span><span class="o">.</span><span class="n">SetOption</span><span class="p">(</span><span class="s2">&quot;duplicate&quot;</span><span class="p">,</span> <span class="s2">&quot;copy&quot;</span><span class="p">)</span>

<span class="c1"># Always print failed task *.stdout files</span>
<span class="n">env</span><span class="o">.</span><span class="n">PrintBuildFailures</span><span class="p">(</span><span class="n">print_stdout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Empty defaults list to avoid building all simulation targets by default</span>
<span class="n">env</span><span class="o">.</span><span class="n">Default</span><span class="p">()</span>

<span class="c1"># Find required programs for conditional target ignoring and absolute path for use in target actions</span>
<span class="n">env</span><span class="p">[</span><span class="s2">&quot;CCX_PROGRAM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">AddProgram</span><span class="p">([</span><span class="s2">&quot;ccx&quot;</span><span class="p">])</span>
<span class="n">env</span><span class="p">[</span><span class="s2">&quot;ccx2paraview&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">AddProgram</span><span class="p">([</span><span class="s2">&quot;ccx2paraview&quot;</span><span class="p">])</span>

<span class="c1"># Abaqus input file implicit dependency scanner</span>
<span class="c1"># Works for CalculiX because CalculiX uses the Abaqus include keyword semantics and input file extension</span>
<span class="n">env</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">SCANNERS</span><span class="o">=</span><span class="n">waves</span><span class="o">.</span><span class="n">scons_extensions</span><span class="o">.</span><span class="n">abaqus_input_scanner</span><span class="p">())</span>

<span class="c1"># Call SConscript file</span>
<span class="n">SConscript</span><span class="p">(</span><span class="s2">&quot;SConscript&quot;</span><span class="p">,</span> <span class="n">variant_dir</span><span class="o">=</span><span class="n">env</span><span class="p">[</span><span class="s2">&quot;build_dir&quot;</span><span class="p">],</span> <span class="n">exports</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;env&quot;</span><span class="p">:</span> <span class="n">env</span><span class="p">},</span> <span class="n">duplicate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># List all aliases in help message.</span>
<span class="c1"># This must come *after* all expected Alias definitions and SConscript files.</span>
<span class="n">env</span><span class="o">.</span><span class="n">ProjectHelp</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="build-targets">
<h2>Build Targets<a class="headerlink" href="#build-targets" title="Link to this heading">#</a></h2>
<ol class="arabic simple" start="9">
<li><p>Build the new targets</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">pwd</span>
/path/to/waves-tutorials/tutorial_gmsh
$<span class="w"> </span>scons<span class="w"> </span>fierro
scons:<span class="w"> </span>Reading<span class="w"> </span>SConscript<span class="w"> </span>files<span class="w"> </span>...
Checking<span class="w"> </span>whether<span class="w"> </span><span class="s1">&#39;ccx&#39;</span><span class="w"> </span>program<span class="w"> </span>exists.../home/roppenheimer/anaconda3/envs/waves-gmsh-env/bin/ccx
Checking<span class="w"> </span>whether<span class="w"> </span><span class="s1">&#39;ccx2paraview&#39;</span><span class="w"> </span>program<span class="w"> </span>exists.../home/roppenheimer/anaconda3/envs/waves-gmsh-env/bin/ccx2paraview
scons:<span class="w"> </span><span class="k">done</span><span class="w"> </span>reading<span class="w"> </span>SConscript<span class="w"> </span>files.
scons:<span class="w"> </span>Building<span class="w"> </span>targets<span class="w"> </span>...
<span class="nb">cd</span><span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>python<span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build/rectangle.py<span class="w"> </span>--output-file<span class="o">=</span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build/rectangle_gmsh.inp<span class="w"> </span>&gt;<span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build/rectangle_gmsh.inp.stdout<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="nb">cd</span><span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>python<span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build/strip_heading.py<span class="w"> </span>--input-file<span class="o">=</span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build/rectangle_gmsh.inp<span class="w"> </span>--output-file<span class="o">=</span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build/rectangle_mesh.inp<span class="w"> </span>&gt;<span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build/rectangle_mesh.inp.stdout<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="nb">cd</span><span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>/home/roppenheimer/anaconda3/envs/waves-gmsh-env/bin/ccx<span class="w"> </span>-i<span class="w"> </span>rectangle_compression<span class="w"> </span>&gt;<span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build/rectangle_compression.frd.stdout<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="nb">cd</span><span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>ccx2paraview<span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build/rectangle_compression.frd<span class="w"> </span>&gt;<span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build/rectangle_compression.vtu.stdout<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="nb">cd</span><span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>python<span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build/vtu2xarray.py<span class="w"> </span>--input-file<span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build/rectangle_compression.vtu<span class="w"> </span>--output-file<span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build/rectangle_compression.h5<span class="w"> </span>&gt;<span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build/rectangle_compression.h5.stdout<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="nb">cd</span><span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>python<span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build/post_processing.py<span class="w"> </span>--input-file<span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build/rectangle_compression.h5<span class="w"> </span>--output-file<span class="w"> </span>stress_strain_comparison.pdf<span class="w"> </span>--x-units<span class="w"> </span>mm/mm<span class="w"> </span>--y-units<span class="w"> </span>MPa<span class="w"> </span>&gt;<span class="w"> </span>/home/roppenheimer/waves-tutorials/tutorial_gmsh/build/stress_strain_comparison.pdf.stdout<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
scons:<span class="w"> </span><span class="k">done</span><span class="w"> </span>building<span class="w"> </span>targets.
</pre></div>
</div>
</section>
<section id="output-files">
<h2>Output Files<a class="headerlink" href="#output-files" title="Link to this heading">#</a></h2>
<p>Explore the contents of the <code class="docutils literal notranslate"><span class="pre">build</span></code> directory using the <code class="docutils literal notranslate"><span class="pre">find</span></code> command against the <code class="docutils literal notranslate"><span class="pre">build</span></code> directory, as shown
below.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">pwd</span>
/home/roppenheimer/waves-tutorials/tutorial_cubit
$<span class="w"> </span>find<span class="w"> </span>build<span class="w"> </span>-type<span class="w"> </span>f
build/rectangle_compression.h5
build/rectangle_compression.inp
build/rectangle_compression.h5.stdout
build/rectangle_compression.sta
build/rectangle_compression.dat
build/rectangle_mesh.inp
build/rectangle_compression.vtu.stdout
build/rectangle_compression.12d
build/spooles.out
build/rectangle_gmsh.inp
build/rectangle_compression.cvg
build/stress_strain_comparison.pdf.stdout
build/rectangle_compression.frd.stdout
build/rectangle_compression.vtu
build/rectangle.py
build/stress_strain_comparison.pdf
build/post_processing.py
build/rectangle_gmsh.inp.stdout
build/SConscript
build/rectangle_compression.frd
build/strip_heading.py
build/vtu2xarray.py
build/stress_strain_comparison.csv
build/rectangle_mesh.inp.stdout
</pre></div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="tutorial_quinoa.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tutorial: Quinoa</p>
      </div>
    </a>
    <a class="right-next"
       href="templates.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">ModSim Templates</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#environment">Environment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#directory-structure">Directory Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sconscript">SConscript</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gmsh-python-script">Gmsh Python script</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculix-input-file">CalculiX Input File</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sconstruct">SConstruct</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-targets">Build Targets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#output-files">Output Files</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kyle Brindley, Prabhu S. Khalsa, Thomas Roberts, Sergio Cordova, Matthew Fister, and Scott Ouellette
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2025 Triad National Security, LLC. All Rights Reserved.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Apr 16, 2025.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>