(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1716:(e,s,t)=>{Promise.resolve().then(t.bind(t,6169))},6169:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var a=t(5155),l=t(2115),r=t(3096);function n(e){let{filename:s}=e,[t,n]=(0,l.useState)([]),[i,d]=(0,l.useState)(!0),[o,c]=(0,l.useState)(null),[x,m]=(0,l.useState)(null);return(0,l.useEffect)(()=>{s&&(d(!0),c(null),fetch("/api/logs?filename=".concat(encodeURIComponent(s))).then(e=>{if(!e.ok)throw Error("Failed to fetch logs");return e.json()}).then(e=>{n(e),d(!1)}).catch(e=>{c(e.message),d(!1)}))},[s]),(0,a.jsxs)("div",{className:"p-4",children:[i&&(0,a.jsx)("span",{className:"text-gray-500",children:"Loading logs..."}),o&&(0,a.jsxs)("span",{className:"text-red-600",children:["Error: ",o]}),!i&&!o&&(0,a.jsx)("div",{className:"overflow-auto rounded-2xl shadow-lg border border-gray-200 bg-white",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"w-8"}),(0,a.jsx)("th",{className:"px-3 py-2 font-semibold text-gray-700",children:"Type"}),(0,a.jsx)("th",{className:"px-3 py-2 font-semibold text-gray-700",children:"Start Time"}),(0,a.jsx)("th",{className:"px-3 py-2 font-semibold text-gray-700",children:"Response Format"}),(0,a.jsx)("th",{className:"px-3 py-2 font-semibold text-gray-700",children:"Last Prompt Message"}),(0,a.jsx)("th",{className:"px-3 py-2 font-semibold text-gray-700",children:"Response"}),(0,a.jsx)("th",{className:"px-3 py-2 font-semibold text-gray-700",children:"Reasoning Effort"}),(0,a.jsx)("th",{className:"px-3 py-2 font-semibold text-gray-700",children:"Temp"}),(0,a.jsx)("th",{className:"px-3 py-2 font-semibold text-gray-700",children:"Elapsed (s)"}),(0,a.jsx)("th",{className:"px-3 py-2 font-semibold text-gray-700",children:"Finish"}),(0,a.jsx)("th",{className:"px-3 py-2 font-semibold text-gray-700",children:"Comp. Tokens"}),(0,a.jsx)("th",{className:"px-3 py-2 font-semibold text-gray-700",children:"Prompt Tokens"}),(0,a.jsx)("th",{className:"px-3 py-2 font-semibold text-gray-700",children:"Reasoning Tokens"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-100",children:t.map((e,s)=>{var t,n,i;let d,o="",c="",p="",h=!!e.response_format&&"None"!==e.response_format;if(p=e.start_time?new Date(1e3*e.start_time).toLocaleString():"<no start_time>","embeddings"===e.type){let s=e.texts||[];o=Array.isArray(s)&&s.length>0?s[0].replace(/\s+/g," ").slice(0,120)+(s[0].length>120?" ...":""):"<no texts>",c=""}else{let s=(Array.isArray(e.messages)?e.messages:[]).filter(e=>"user"===e.role),t=(d=s[s.length-1])?d.content.replace(/\s+/g," "):"";o=t.length>120?t.slice(0,120)+" ...":t,c=e.response&&e.response.replace(/\s+/g," ").length>120?e.response.replace(/\s+/g," ").slice(0,120)+" ...":e.response}return(0,a.jsxs)(l.Fragment,{children:[(0,a.jsxs)("tr",{className:x===s?"bg-blue-50 transition":"transition",children:[(0,a.jsx)("td",{className:"align-top px-2 py-2",children:(0,a.jsx)("button",{className:"rounded-md p-1 border ".concat(x===s?"bg-blue-100 border-blue-300 text-blue-600":"bg-gray-50 border-gray-200 text-gray-400"," hover:bg-blue-100 hover:text-blue-700 transition"),onClick:()=>m(x===s?null:s),"aria-label":x===s?"Hide all messages":"Show all messages",children:x===s?(0,a.jsx)(r.Mtm,{}):(0,a.jsx)(r.D3D,{})})}),(0,a.jsx)("td",{className:"px-3 py-2 font-bold text-indigo-700 align-top",children:e.type}),(0,a.jsx)("td",{className:"px-3 py-2 align-top",children:p}),(0,a.jsx)("td",{className:"px-3 py-2 align-top",children:h?(0,a.jsx)("span",{className:"text-green-700 font-semibold",children:"Yes"}):(0,a.jsx)("span",{className:"text-gray-400",children:"No"})}),(0,a.jsx)("td",{className:"px-3 py-2 text-gray-500 align-top",children:o}),(0,a.jsx)("td",{className:"px-3 py-2 align-top",children:c}),(0,a.jsx)("td",{className:"px-3 py-2 text-blue-600 align-top",children:e.reasoning_effort}),(0,a.jsx)("td",{className:"px-3 py-2 align-top",children:e.temperature}),(0,a.jsx)("td",{className:"px-3 py-2 align-top",children:null!=e.elapsed_time?e.elapsed_time.toFixed(2):""}),(0,a.jsx)("td",{className:"px-3 py-2 align-top",children:e.finish_reason}),(0,a.jsx)("td",{className:"px-3 py-2 align-top",children:e.completion_tokens}),(0,a.jsx)("td",{className:"px-3 py-2 align-top",children:e.prompt_tokens}),(0,a.jsx)("td",{className:"px-3 py-2 align-top",children:null!=e.reasoning_tokens?e.reasoning_tokens:""})]}),x===s&&(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{}),(0,a.jsxs)("td",{colSpan:11,className:"bg-blue-50 rounded-b-xl shadow-inner px-6 py-4",children:[h&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("span",{className:"font-semibold text-blue-700",children:"Response Format:"}),(0,a.jsx)("div",{className:"mt-1 bg-blue-100 rounded p-2",children:(0,a.jsx)("span",{className:"text-sm break-all",children:"string"==typeof e.response_format?e.response_format:JSON.stringify(e.response_format)})})]}),"embeddings"===e.type?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"font-semibold mb-2",children:"Texts:"}),(0,a.jsx)("div",{className:"space-y-2",children:Array.isArray(e.texts)&&(null!=(n=null==(t=e.texts)?void 0:t.length)?n:0)>0?(0,a.jsx)("div",{className:"flex flex-col gap-2",children:(null!=(i=e.texts)?i:[]).map((e,s)=>(0,a.jsx)("div",{className:"border-b border-gray-200 pb-1",children:(0,a.jsx)("span",{className:"text-sm",children:e})},s))}):(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"No texts"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"font-semibold mb-2",children:"All Messages:"}),(0,a.jsx)("div",{className:"space-y-4",children:0===e.messages.length?(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"No messages"}):(0,a.jsx)("div",{className:"flex flex-col gap-4",children:e.messages.map((e,s)=>(0,a.jsxs)("div",{className:"rounded-lg bg-gray-50 border border-gray-200 p-3 shadow-sm",children:[(0,a.jsx)("div",{className:"flex items-center mb-1",children:(0,a.jsx)("span",{className:"text-xs font-semibold text-blue-700 uppercase mr-2",children:e.role})}),(0,a.jsx)("div",{className:"whitespace-pre-line text-sm text-gray-800 break-words",children:e.content})]},s))})}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("span",{className:"font-semibold text-blue-700",children:"Full Response:"}),(0,a.jsx)("div",{className:"mt-1 bg-blue-100 rounded p-2",children:(0,a.jsx)("div",{className:"text-sm whitespace-pre-line",children:e.response})})]})]})]})]})]},s)})})]})})]})}function i(){let[e,s]=(0,l.useState)([]),[t,r]=(0,l.useState)(null),[i,d]=(0,l.useState)(!0),[o,c]=(0,l.useState)(null);return(0,l.useEffect)(()=>{fetch("/api/files").then(e=>{if(!e.ok)throw Error("Failed to fetch file list");return e.json()}).then(e=>{s(e),r(e[0]||null),d(!1)}).catch(e=>{c(e.message),d(!1)})},[]),(0,a.jsxs)("main",{className:"p-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"LLM Trace Viewer"}),i&&(0,a.jsx)("div",{className:"text-gray-500",children:"Loading file list..."}),o&&(0,a.jsxs)("div",{className:"text-red-600",children:["Error: ",o]}),!i&&!o&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("div",{className:"font-semibold mb-2",children:"Available log files:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:e.map(e=>(0,a.jsx)("button",{className:"px-3 py-1 rounded border text-sm font-mono transition ".concat(t===e?"bg-blue-600 text-white border-blue-700":"bg-white text-blue-700 border-blue-300 hover:bg-blue-100"),onClick:()=>r(e),children:e},e))})]}),t&&(0,a.jsx)(n,{filename:t})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[105,441,684,358],()=>s(1716)),_N_E=e.O()}]);