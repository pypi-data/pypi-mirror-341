<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The r2lab API &#8212; r2lab v0.6.2</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxdoc.css?v=d59dc883" />
    <script src="_static/documentation_options.js?v=1c28bd9a"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="&lt;no title&gt;" href="CHANGELOG.html" />
    <link rel="prev" title="&lt;no title&gt;" href="README.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="CHANGELOG.html" title="&lt;no title&gt;"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="README.html" title="&lt;no title&gt;"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">r2lab v0.6.2</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">The r2lab API</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="the-r2lab-api">
<h1>The r2lab API<a class="headerlink" href="#the-r2lab-api" title="Link to this heading">¶</a></h1>
<section id="module-r2lab.prepare">
<span id="testbed-preparation"></span><h2>Testbed preparation<a class="headerlink" href="#module-r2lab.prepare" title="Link to this heading">¶</a></h2>
<p>This module contains a utility for preparing the testbed.</p>
<p>The logic is that you write a scheduler that implements your
pure experimental logic.</p>
<p>You can then pass this scheduler to <code class="docutils literal notranslate"><span class="pre">r2lab_prepare_scheduler()</span></code>,
that returns a scheduler where your original one is embedded.</p>
<p>This overall scheduler will prepend instructions for preparing the testbed,
in terms of loading images on nodes, turning off unused nodes, and similar.</p>
<dl class="py function">
<dt class="sig sig-object py" id="r2lab.prepare.prepare_testbed_scheduler">
<span class="sig-prename descclassname"><span class="pre">r2lab.prepare.</span></span><span class="sig-name descname"><span class="pre">prepare_testbed_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gateway</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_flag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiment_scheduler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">images_mapping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodes_left_alone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdrs_left_alone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phones_left_alone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/prepare.html#prepare_testbed_scheduler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.prepare.prepare_testbed_scheduler" title="Link to this definition">¶</a></dt>
<dd><p>This function is designed as a standard way for experiments to warm up.
Experimenters only need to write a scheduler that defines the behaviour
of their core experiment, this function will add additional steps that
take care of a) checking for a valid lease, b) load images on nodes, and
c) turn off unused devices.</p>
<p>It is generally desirable to write an experiment script that has a
<cite>–load/-l</cite> boolean flag; typically, one would use the <code class="docutils literal notranslate"><span class="pre">--load</span></code> flag the
first time that an experiment is launched during a given timeslot, while
subsequent calls won’t. That is the purpose of the <code class="docutils literal notranslate"><span class="pre">load_flag</span></code> below;
when set to False, only step a) is performed, otherwise the resulting
scheduler will go for the full monty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gateway_sshnode</strong> – the ssh handle to the gateway</p></li>
<li><p><strong>load_flag</strong> (<em>bool</em>) – if not set, only the lease is checked</p></li>
<li><p><strong>experiment_scheduler</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scheduler</span></code></span>) – core scheduler for the experiment</p></li>
<li><p><strong>images_mapping</strong> – a dictionary that specifies images to be loaded on nodes;
see examples below</p></li>
<li><p><strong>nodes_left_alone</strong> – a list of node numbers that should be left intact,
neither loaded nor turned off;</p></li>
<li><p><strong>phones_left_alone</strong> – a list of node numbers that should be left intact,
i.e. not switched to airplane mode.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Return :</dt><dd><p>The overall scheduler where the input <code class="docutils literal notranslate"><span class="pre">experiment_scheduler</span></code> is embedded.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Specify a mapping like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">images_mapping</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;ubuntu&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s2">&quot;gnuradio&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">]}</span>
</pre></div>
</div>
<p>Note that the format for <code class="docutils literal notranslate"><span class="pre">images_mapping</span></code>, is flexible;
if only one node is to be loaded, the iterable level is optional;
also each node can be specified as an <code class="docutils literal notranslate"><span class="pre">int</span></code>, a <code class="docutils literal notranslate"><span class="pre">bytes</span></code>, a <code class="docutils literal notranslate"><span class="pre">str</span></code>,
in which case non numeric characters are ignored. So this is a legitimate
requirement as well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">images_mapping</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;openair-cn&#39;</span><span class="p">:</span> <span class="mi">12</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span>
                   <span class="s1">&#39;openair-enodeb&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;fit32&#39;</span><span class="p">,),</span>
                   <span class="s1">&#39;ubuntu&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;reboot1&#39;</span><span class="p">,</span> <span class="s1">&#39;004&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;you-get-the-picture-34&#39;</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

</section>
<hr class="docutils" />
<section id="module-r2lab.r2labmap">
<span id="dimension-grid"></span><h2>2-Dimension grid<a class="headerlink" href="#module-r2lab.r2labmap" title="Link to this heading">¶</a></h2>
<p>The R2labMap class is a convenience for mapping node numbers to a
2-dimensional grid coordinates, and backwards.</p>
<dl class="py class">
<dt class="sig sig-object py" id="r2lab.r2labmap.R2labMap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">r2lab.r2labmap.</span></span><span class="sig-name descname"><span class="pre">R2labMap</span></span><a class="reference internal" href="_modules/r2lab/r2labmap.html#R2labMap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.r2labmap.R2labMap" title="Link to this definition">¶</a></dt>
<dd><p>Inherits <a class="reference internal" href="#r2lab.r2labmap.R2labMapGeneric" title="r2lab.r2labmap.R2labMapGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">R2labMapGeneric</span></code></a></p>
<p>A map object where coordinates start at 1,
and where the Y coordinate goes upwards;
so typically in this map node 1 is at (1, 5)
and node 37 is at (9, 1).</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="r2lab.r2labmap.R2labMapGeneric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">r2lab.r2labmap.</span></span><span class="sig-name descname"><span class="pre">R2labMapGeneric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swap_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swap_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/r2labmap.html#R2labMapGeneric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.r2labmap.R2labMapGeneric" title="Link to this definition">¶</a></dt>
<dd><p>The most general form allows to specifiy
mapper functions in both directions.
Or to simply specify an integer offset and boolean swap.</p>
<dl class="py method">
<dt class="sig sig-object py" id="r2lab.r2labmap.R2labMapGeneric.indexes">
<span class="sig-name descname"><span class="pre">indexes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/r2labmap.html#R2labMapGeneric.indexes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.r2labmap.R2labMapGeneric.indexes" title="Link to this definition">¶</a></dt>
<dd><p>Object that can be used to create a pandas index
on the nodes; essentially this is range(1, 38)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="r2lab.r2labmap.R2labMapGeneric.iterate_holes">
<span class="sig-name descname"><span class="pre">iterate_holes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/r2labmap.html#R2labMapGeneric.iterate_holes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.r2labmap.R2labMapGeneric.iterate_holes" title="Link to this definition">¶</a></dt>
<dd><p>An iterator that yields tuples of the form (x, y) for all the
possible (x, y) that do not match a node</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="r2lab.r2labmap.R2labMapGeneric.iterate_nodes">
<span class="sig-name descname"><span class="pre">iterate_nodes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/r2labmap.html#R2labMapGeneric.iterate_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.r2labmap.R2labMapGeneric.iterate_nodes" title="Link to this definition">¶</a></dt>
<dd><p>An iterator that yields 37 tuples of the form
(node_id, (x, y))</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="r2lab.r2labmap.R2labMapGeneric.node">
<span class="sig-name descname"><span class="pre">node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/r2labmap.html#R2labMapGeneric.node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.r2labmap.R2labMapGeneric.node" title="Link to this definition">¶</a></dt>
<dd><p>Finds about the node at that position</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – coordinate along the horizontal axis - int or str</p></li>
<li><p><strong>y</strong> – coordinate along the vertical axis - int or str</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a node number, in the range (1..37) - or None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="r2lab.r2labmap.R2labMapGeneric.position">
<span class="sig-name descname"><span class="pre">position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/r2labmap.html#R2labMapGeneric.position"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.r2labmap.R2labMapGeneric.position" title="Link to this definition">¶</a></dt>
<dd><p>Returns a (x, y) tuple that is the position of node &lt;node&gt;</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>node</strong> – a node number - may be an int or a str</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a position on the grid</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(int, int)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<hr class="docutils" />
<section id="module-r2lab.mapdataframe">
<span id="dataframes"></span><h2>Dataframes<a class="headerlink" href="#module-r2lab.mapdataframe" title="Link to this heading">¶</a></h2>
<p>A standard pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> for storing results
on a node by node basis together with their
map coordinates.</p>
<dl class="py class">
<dt class="sig sig-object py" id="r2lab.mapdataframe.MapDataFrame">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">r2lab.mapdataframe.</span></span><span class="sig-name descname"><span class="pre">MapDataFrame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r2labmap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/mapdataframe.html#MapDataFrame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.mapdataframe.MapDataFrame" title="Link to this definition">¶</a></dt>
<dd><p>A <code class="docutils literal notranslate"><span class="pre">MapDataFrame</span></code> is a dataframe that has one line per node, together with
their x and y coordinates as specified in the map object, plus additional
columns as specified in the constructor. Is is indexed by node numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map</strong> – a R2labMap object that primarily provides nodes coordinates</p></li>
<li><p><strong>columns</strong> – an dictionary - preferrably an <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> if using
an older Python - that specifies each column name (key)
and corresponding initial value (value).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<hr class="docutils" />
<section id="module-r2lab.sidecar">
<span id="probing-the-testbed-status"></span><h2>Probing the testbed status<a class="headerlink" href="#module-r2lab.sidecar" title="Link to this heading">¶</a></h2>
<p>The R2lab sidecar is a websocket service that runs on
<code class="docutils literal notranslate"><span class="pre">wss://r2lab.inria.fr:999/</span></code> and that exposes the status of the testbed.</p>
<p>This module implements client classes, for interacting with the sidecar service.</p>
<p>The core of the implementation is <code class="docutils literal notranslate"><span class="pre">asyncio</span></code>-friendly and accessible
through the <a class="reference internal" href="#r2lab.sidecar.SidecarAsyncClient" title="r2lab.sidecar.SidecarAsyncClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">SidecarAsyncClient</span></code></a> class, but for
convenience some features are also available to synchronous code through
the <a class="reference internal" href="#r2lab.sidecar.SidecarSyncClient" title="r2lab.sidecar.SidecarSyncClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">SidecarSyncClient</span></code></a> class.</p>
<dl class="py class">
<dt class="sig sig-object py" id="r2lab.sidecar.SidecarAsyncClient">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">r2lab.sidecar.</span></span><span class="sig-name descname"><span class="pre">SidecarAsyncClient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wss://r2lab.inria.fr:999/'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/sidecar.html#SidecarAsyncClient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.sidecar.SidecarAsyncClient" title="Link to this definition">¶</a></dt>
<dd><p>This class behaves as an asynchronous context manager for
talking with the R2lab sidecar server.</p>
<p>Optional arguments <cite>args</cite> and <cite>kwds</cite> are passed as-is to
<cite>websockets.client.connect</cite>, see
<a class="reference external" href="https://websockets.readthedocs.io/en/stable/api.html#websockets.client.connect">https://websockets.readthedocs.io/en/stable/api.html#websockets.client.connect</a></p>
<p class="rubric">Example</p>
<p>Set a node as available from some asynchronous code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">with</span> <span class="n">SidecarAsyncClient</span><span class="p">()</span> <span class="k">as</span> <span class="n">sidecar</span><span class="p">:</span>
    <span class="k">await</span> <span class="n">sidecar</span><span class="o">.</span><span class="n">set_node_attribute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;available&#39;</span><span class="p">,</span> <span class="s1">&#39;ok&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, the <code class="docutils literal notranslate"><span class="pre">sidecar</span></code> object is
a <a class="reference internal" href="#r2lab.sidecar.SidecarProtocol" title="r2lab.sidecar.SidecarProtocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">SidecarProtocol</span></code></a> instance.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>About SSL server certificate verification:</strong>
Verifying server certificates relies on a set of “trusted” CAs.
Web browsers do come with a maintained set of such trust anchors,
however the standard Python installation has no such knowledge;
and for that reason attempting to check for the testbed’s certificate
will fail unless you’ve taken the time to somehow configure all this.</p>
<p>If you just want to probe the testbed though, this looks like a lot
of hassle. In that case you can turn off server verification as foolows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ssl</span>
<span class="n">ssl_context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">SSLContext</span><span class="p">()</span>
<span class="c1"># this is where we ask for no verification</span>
<span class="n">ssl_context</span><span class="o">.</span><span class="n">verify_mode</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">CERT_NONE</span>
<span class="k">async</span> <span class="k">with</span> <span class="n">SidecarSyncClient</span><span class="p">(</span><span class="n">ssl</span><span class="o">=</span><span class="n">ssl_context</span><span class="p">)</span> <span class="k">as</span> <span class="n">sidecar</span><span class="p">:</span>
    <span class="k">await</span> <span class="n">sidecar</span><span class="o">.</span><span class="n">set_node_attribute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;available&#39;</span><span class="p">,</span> <span class="s1">&#39;ok&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="r2lab.sidecar.SidecarProtocol">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">r2lab.sidecar.</span></span><span class="sig-name descname"><span class="pre">SidecarProtocol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extensions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subprotocols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_headers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_agent_header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Python/3.11</span> <span class="pre">websockets/12.0'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/sidecar.html#SidecarProtocol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.sidecar.SidecarProtocol" title="Link to this definition">¶</a></dt>
<dd><p>The SidecarProtocol class is an asyncio-compliant implementation
of the R2lab sidecar system.</p>
<p>It inherits <code class="docutils literal notranslate"><span class="pre">websockets.client.WebSocketClientProtocol</span></code>
as documented here:
<a class="reference external" href="https://websockets.readthedocs.io/en/stable/api.html#module-websockets.client">https://websockets.readthedocs.io/en/stable/api.html#module-websockets.client</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="r2lab.sidecar.SidecarProtocol.nodes_status">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nodes_status</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/sidecar.html#SidecarProtocol.nodes_status"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.sidecar.SidecarProtocol.nodes_status" title="Link to this definition">¶</a></dt>
<dd><p>A function call that returns the JSON nodes status for the complete testbed.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A python dictionary indexed by integers 1 to 37, whose values are
dictionaries with keys corresponding to each node’s attributes at that time.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Get the complete testbed status:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">with</span> <span class="n">SidecarAsyncClient</span><span class="p">()</span> <span class="k">as</span> <span class="n">sidecar</span><span class="p">:</span>
    <span class="n">nodes_status</span> <span class="o">=</span> <span class="k">await</span> <span class="n">sidecar</span><span class="o">.</span><span class="n">nodes_status</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nodes_status</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;usrp_type&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="r2lab.sidecar.SidecarProtocol.phones_status">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">phones_status</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/sidecar.html#SidecarProtocol.phones_status"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.sidecar.SidecarProtocol.phones_status" title="Link to this definition">¶</a></dt>
<dd><p>Just like <code class="docutils literal notranslate"><span class="pre">nodes_status</span></code> but on phones</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="r2lab.sidecar.SidecarProtocol.recv_payload">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">recv_payload</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/sidecar.html#SidecarProtocol.recv_payload"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.sidecar.SidecarProtocol.recv_payload" title="Link to this definition">¶</a></dt>
<dd><p>Receives and returns a
<code class="xref py py-class docutils literal notranslate"><span class="pre">SidecarPayload</span></code> object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="r2lab.sidecar.SidecarProtocol.recv_umbrella">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">recv_umbrella</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/sidecar.html#SidecarProtocol.recv_umbrella"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.sidecar.SidecarProtocol.recv_umbrella" title="Link to this definition">¶</a></dt>
<dd><p>Read one payload, and returns it as a dict with 3 keys.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="r2lab.sidecar.SidecarProtocol.send_payload">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">send_payload</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">payload</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/sidecar.html#SidecarProtocol.send_payload"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.sidecar.SidecarProtocol.send_payload" title="Link to this definition">¶</a></dt>
<dd><p>Send a <code class="xref py py-class docutils literal notranslate"><span class="pre">SidecarPayload</span></code>
object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="r2lab.sidecar.SidecarProtocol.send_umbrella">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">send_umbrella</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">category</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/sidecar.html#SidecarProtocol.send_umbrella"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.sidecar.SidecarProtocol.send_umbrella" title="Link to this definition">¶</a></dt>
<dd><p>Set one payload, constructed from its parts</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="r2lab.sidecar.SidecarProtocol.set_node_attribute">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_node_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/sidecar.html#SidecarProtocol.set_node_attribute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.sidecar.SidecarProtocol.set_node_attribute" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> – a node_id as an int or str</p></li>
<li><p><strong>attribute</strong> (<em>str</em>) – the name of the attribute to be written</p></li>
<li><p><strong>value</strong> (<em>str</em>) – the new value</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>To mark node 1 as unavailable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">await</span> <span class="n">sidecar</span><span class="o">.</span><span class="n">set_node_attribute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;available&#39;</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="r2lab.sidecar.SidecarProtocol.set_nodes_triples">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_nodes_triples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">triples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/sidecar.html#SidecarProtocol.set_nodes_triples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.sidecar.SidecarProtocol.set_nodes_triples" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>triples</strong> – each argument is expected to be a tuple (or list)
of the form <code class="docutils literal notranslate"><span class="pre">id,</span> <span class="pre">attribute,</span> <span class="pre">value</span></code>. The same node
id can be used in several triples.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>To mark node 1 as unavailable and node 2 as turned off:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">await</span> <span class="n">sidecar</span><span class="o">.</span><span class="n">set_nodes_triples</span><span class="p">(</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;available&#39;</span><span class="p">,</span> <span class="s1">&#39;ok&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;cmc_on_off&#39;</span><span class="p">,</span> <span class="s1">&#39;off&#39;</span><span class="p">),</span>
   <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="r2lab.sidecar.SidecarProtocol.set_phone_attribute">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_phone_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/sidecar.html#SidecarProtocol.set_phone_attribute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.sidecar.SidecarProtocol.set_phone_attribute" title="Link to this definition">¶</a></dt>
<dd><p>Similar to <code class="docutils literal notranslate"><span class="pre">set_node_attribute</span></code> on a phone</p>
<p class="rubric">Example</p>
<p>To mark phone 2 as being turned off (although this is constantly
recomputed by the phones monitor):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">await</span> <span class="n">sidecar</span><span class="o">.</span><span class="n">set_phone_attribute</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;airplane_mode&#39;</span><span class="p">,</span> <span class="s1">&#39;on&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="r2lab.sidecar.SidecarProtocol.set_phones_triples">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_phones_triples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">triples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/sidecar.html#SidecarProtocol.set_phones_triples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.sidecar.SidecarProtocol.set_phones_triples" title="Link to this definition">¶</a></dt>
<dd><p>Identical to <code class="docutils literal notranslate"><span class="pre">set_nodes_triples</span></code> but on phones</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="r2lab.sidecar.SidecarSyncClient">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">r2lab.sidecar.</span></span><span class="sig-name descname"><span class="pre">SidecarSyncClient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wss://r2lab.inria.fr:999/'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/sidecar.html#SidecarSyncClient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.sidecar.SidecarSyncClient" title="Link to this definition">¶</a></dt>
<dd><p>A synchronous wrapper to perform the same operations
from sequential code without having to worry about the
event loop, asynchronous context manager and coroutine business.</p>
<p class="rubric">Example</p>
<p>Set a node as available from some synchronous code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">SidecarSyncClient</span><span class="p">()</span> <span class="k">as</span> <span class="n">sidecar</span><span class="p">:</span>
    <span class="n">sidecar</span><span class="o">.</span><span class="n">set_node_attribute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;available&#39;</span><span class="p">,</span> <span class="s1">&#39;ok&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is a convenience only, it would be unwise, obviously,
to call this from asynchronous code; if it works at all.
Use <a class="reference internal" href="#r2lab.sidecar.SidecarAsyncClient" title="r2lab.sidecar.SidecarAsyncClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">SidecarAsyncClient</span></code></a> instead
in this use case.</p>
</div>
</dd></dl>

</section>
<hr class="docutils" />
<section id="module-r2lab.argparse_additions">
<span id="classes-for-argparse"></span><h2>Classes for <code class="docutils literal notranslate"><span class="pre">argparse</span></code><a class="headerlink" href="#module-r2lab.argparse_additions" title="Link to this heading">¶</a></h2>
<p>The classes in this module extend the argparse ecosystem.</p>
<p>Purpose is to enable the creation of CLI options that would behave a bit like
<code class="docutils literal notranslate"><span class="pre">action=append</span></code>, but with a check on choices, that is to say:</p>
<ul class="simple">
<li><p><strong>accumulative</strong> : <em>dest</em> holds a list of strings - it’s possible to use the type system as well</p></li>
<li><p><strong>restrictive</strong> : all elements in the list must be in <em>choices</em></p></li>
<li><dl class="simple">
<dt>optionnally <strong>reset-able</strong><span class="classifier">it should be possible for add_argument to specify a non-void default</span></dt><dd><p>and in this case we need a means for the CLI to explicitly void the value</p>
</dd>
</dl>
</li>
</ul>
<p>In practical terms, we want to specify one or several values for a parameter
that is itself constrained, like an antenna mask that must be among ‘1’, ‘3’ and ‘7’</p>
<p>As of this writing at least, using ‘append’ as an action won’t work
it is possible to write a code that uses
action=append, choices=[‘a’, ‘b’, ‘c’] and default=[‘a’, ‘b’]
but then defaults are always returned…</p>
<p><strong>Resetting</strong></p>
<p>The actual syntax offered by your CLI for actually resetting the target list may vary from one need to another</p>
<p>As an example, let us consider a use case where we have 2 physical
phones, and we want to be able to select any number of them. Let us
further imagine that the code expects that selection to be expressed as a
list of integers in the <em>1-2</em> range.</p>
<p>So we’d like to say e.g.:</p>
<p><code class="docutils literal notranslate"><span class="pre">parser.add_argument(&quot;-p&quot;,</span> <span class="pre">&quot;--phones&quot;,</span> <span class="pre">default=[1],</span> <span class="pre">choices=(1,</span> <span class="pre">2),</span> <span class="pre">type=int,</span> <span class="pre">...)</span></code></p>
<p>And with that in place, we’d like to have</p>
<ul class="simple">
<li><p>no option: results in <code class="docutils literal notranslate"><span class="pre">phones</span> <span class="pre">=</span> <span class="pre">[1]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">2</span></code>:      <code class="docutils literal notranslate"><span class="pre">phones</span> <span class="pre">=</span> <span class="pre">[2]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">1</span> <span class="pre">-p</span> <span class="pre">2</span></code>: <code class="docutils literal notranslate"><span class="pre">phones</span> <span class="pre">=</span> <span class="pre">[1,</span> <span class="pre">2]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">0</span></code>:      <code class="docutils literal notranslate"><span class="pre">phones</span> <span class="pre">=</span> <span class="pre">[]</span></code></p></li>
</ul>
<p>Now, it is <strong>not possible</strong> to adopt a convention where e.g.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">none</span></code> would mean <code class="docutils literal notranslate"><span class="pre">phones</span> <span class="pre">=</span> <span class="pre">[]</span></code></p></li>
</ul>
<p>because we have this <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">int</span></code> setting to <code class="docutils literal notranslate"><span class="pre">add_argument</span></code>, which
causes the string <code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code> to be rejected as an input.</p>
<dl class="py class">
<dt class="sig sig-object py" id="r2lab.argparse_additions.ListOfChoices">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">r2lab.argparse_additions.</span></span><span class="sig-name descname"><span class="pre">ListOfChoices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/argparse_additions.html#ListOfChoices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.argparse_additions.ListOfChoices" title="Link to this definition">¶</a></dt>
<dd><p>The generic class assumes there is a means_resetting method
that is used to check for special incoming values that mean resetting</p>
<p class="rubric">Example</p>
<p>Not resettable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="n">choices</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">],</span>
                    <span class="n">typeaction</span><span class="o">=</span><span class="n">ListOfChoices</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="r2lab.argparse_additions.ListOfChoicesNullReset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">r2lab.argparse_additions.</span></span><span class="sig-name descname"><span class="pre">ListOfChoicesNullReset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/argparse_additions.html#ListOfChoicesNullReset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.argparse_additions.ListOfChoicesNullReset" title="Link to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<p>Resettable with <code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">0</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="n">choices</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
                    <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">typeaction</span><span class="o">=</span><span class="n">ListOfChoicesNullReset</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Note</strong> make sure to mention <code class="docutils literal notranslate"><span class="pre">0</span></code> in the <cite>choices</cite>.</p>
</dd></dl>

</section>
<hr class="docutils" />
<section id="module-r2lab.utils">
<span id="general-utilities"></span><h2>General utilities<a class="headerlink" href="#module-r2lab.utils" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="r2lab.utils.find_local_embedded_script">
<span class="sig-prename descclassname"><span class="pre">r2lab.utils.</span></span><span class="sig-name descname"><span class="pre">find_local_embedded_script</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">script</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_paths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/utils.html#find_local_embedded_script"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.utils.find_local_embedded_script" title="Link to this definition">¶</a></dt>
<dd><p>This helper is designed to find a script that typically comes with
the <code class="docutils literal notranslate"><span class="pre">r2lab-embedded</span></code> repo, specifically in its <code class="docutils literal notranslate"><span class="pre">shell</span></code>
subdirectory.</p>
<p>It knows of a few heuristics to locate your <code class="docutils literal notranslate"><span class="pre">r2lab-embedded</span></code>
repo, relative to your home and current directories. You can
specify additional places to search for in <code class="docutils literal notranslate"><span class="pre">extra_paths</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>script</strong> (<em>str</em>) – the simple name of a script to find</p></li>
<li><p><strong>extra_paths</strong> (<em>List</em><em>(</em><em>str</em><em>)</em>) – optional, a list of paths
(can be <code class="docutils literal notranslate"><span class="pre">Path</span></code> instances too) where to search too</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a valid path in the local filesystem, or <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>FileNotFoundError</strong><strong>(</strong><strong>script</strong><strong>)</strong><strong>` if script can't be foun</strong> – </p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Search for <code class="docutils literal notranslate"><span class="pre">oai-enb.sh</span></code> so as to run it remotely:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">local_script</span> <span class="o">=</span> <span class="n">find_local_embedded_script</span><span class="p">(</span><span class="s2">&quot;oai-enb.sh&quot;</span><span class="p">)</span>
<span class="n">RunScript</span><span class="p">(</span><span class="n">localscript</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Should this also look for some env. variable ?</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="r2lab.utils.r2lab_data">
<span class="sig-prename descclassname"><span class="pre">r2lab.utils.</span></span><span class="sig-name descname"><span class="pre">r2lab_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/utils.html#r2lab_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.utils.r2lab_data" title="Link to this definition">¶</a></dt>
<dd><p>Same as <code class="docutils literal notranslate"><span class="pre">r2lab_hostname</span></code> but returns an interface name of the form <code class="docutils literal notranslate"><span class="pre">data01</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="r2lab.utils.r2lab_hostname">
<span class="sig-prename descclassname"><span class="pre">r2lab.utils.</span></span><span class="sig-name descname"><span class="pre">r2lab_hostname</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/utils.html#r2lab_hostname"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.utils.r2lab_hostname" title="Link to this definition">¶</a></dt>
<dd><p>Return a valid hostname like <code class="docutils literal notranslate"><span class="pre">fit01</span></code> from an input that can be
either <code class="docutils literal notranslate"><span class="pre">1</span></code> (int), <code class="docutils literal notranslate"><span class="pre">1</span></code> (str), <code class="docutils literal notranslate"><span class="pre">01</span></code> (str) , <code class="docutils literal notranslate"><span class="pre">fit1</span></code>, <code class="docutils literal notranslate"><span class="pre">fit01</span></code> or even <code class="docutils literal notranslate"><span class="pre">reboot01</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>str</em>) – loosely typed input that reflects node number</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Simple use case:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r2lab_hostname</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;fit01&#39;</span>
</pre></div>
</div>
<p>And:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rl2ab_hostname</span><span class="p">(</span><span class="s1">&#39;reboot1&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;fit01&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="r2lab.utils.r2lab_id">
<span class="sig-prename descclassname"><span class="pre">r2lab.utils.</span></span><span class="sig-name descname"><span class="pre">r2lab_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anything</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/utils.html#r2lab_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.utils.r2lab_id" title="Link to this definition">¶</a></dt>
<dd><p>Returns an integer from an input that can be either <code class="docutils literal notranslate"><span class="pre">1</span></code> (int),
<code class="docutils literal notranslate"><span class="pre">1</span></code> (str), b``1``(bytes), <code class="docutils literal notranslate"><span class="pre">01</span></code> (str) ,
<code class="docutils literal notranslate"><span class="pre">fit1</span></code>, <code class="docutils literal notranslate"><span class="pre">fit01</span></code> or even <code class="docutils literal notranslate"><span class="pre">reboot01</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="r2lab.utils.r2lab_parse_slice">
<span class="sig-prename descclassname"><span class="pre">r2lab.utils.</span></span><span class="sig-name descname"><span class="pre">r2lab_parse_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slice</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/utils.html#r2lab_parse_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.utils.r2lab_parse_slice" title="Link to this definition">¶</a></dt>
<dd><p>returns username and hostname from a slice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>slice</strong> (<em>str</em>) – can be either <code class="docutils literal notranslate"><span class="pre">username&#64;hostname</span></code> or just <code class="docutils literal notranslate"><span class="pre">username</span></code>.
In the latter case the hostname defaults to
the R2lab gateway i.e. <code class="docutils literal notranslate"><span class="pre">faraday.inria.fr</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">slice</span></code>, <code class="docutils literal notranslate"><span class="pre">hostname</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Typical usage is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">slice</span><span class="p">,</span> <span class="n">hostname</span> <span class="o">=</span> <span class="n">r2lab_parse_slice</span><span class="p">(</span><span class="s2">&quot;inria_r2lab.tutorial&quot;</span><span class="p">)</span>

<span class="nb">slice</span><span class="p">,</span> <span class="n">hostname</span> <span class="o">=</span> <span class="n">r2lab_parse_slice</span><span class="p">(</span><span class="s2">&quot;inria_r2lab.tutorial@faraday.inria.fr&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="r2lab.utils.r2lab_reboot">
<span class="sig-prename descclassname"><span class="pre">r2lab.utils.</span></span><span class="sig-name descname"><span class="pre">r2lab_reboot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/r2lab/utils.html#r2lab_reboot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#r2lab.utils.r2lab_reboot" title="Link to this definition">¶</a></dt>
<dd><p>Same as <code class="docutils literal notranslate"><span class="pre">r2lab_hostname</span></code> but returns a hostname of the form <code class="docutils literal notranslate"><span class="pre">reboot01</span></code>.</p>
</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">The r2lab API</a><ul>
<li><a class="reference internal" href="#module-r2lab.prepare">Testbed preparation</a><ul>
<li><a class="reference internal" href="#r2lab.prepare.prepare_testbed_scheduler"><code class="docutils literal notranslate"><span class="pre">prepare_testbed_scheduler()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-r2lab.r2labmap">2-Dimension grid</a><ul>
<li><a class="reference internal" href="#r2lab.r2labmap.R2labMap"><code class="docutils literal notranslate"><span class="pre">R2labMap</span></code></a></li>
<li><a class="reference internal" href="#r2lab.r2labmap.R2labMapGeneric"><code class="docutils literal notranslate"><span class="pre">R2labMapGeneric</span></code></a><ul>
<li><a class="reference internal" href="#r2lab.r2labmap.R2labMapGeneric.indexes"><code class="docutils literal notranslate"><span class="pre">R2labMapGeneric.indexes()</span></code></a></li>
<li><a class="reference internal" href="#r2lab.r2labmap.R2labMapGeneric.iterate_holes"><code class="docutils literal notranslate"><span class="pre">R2labMapGeneric.iterate_holes()</span></code></a></li>
<li><a class="reference internal" href="#r2lab.r2labmap.R2labMapGeneric.iterate_nodes"><code class="docutils literal notranslate"><span class="pre">R2labMapGeneric.iterate_nodes()</span></code></a></li>
<li><a class="reference internal" href="#r2lab.r2labmap.R2labMapGeneric.node"><code class="docutils literal notranslate"><span class="pre">R2labMapGeneric.node()</span></code></a></li>
<li><a class="reference internal" href="#r2lab.r2labmap.R2labMapGeneric.position"><code class="docutils literal notranslate"><span class="pre">R2labMapGeneric.position()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-r2lab.mapdataframe">Dataframes</a><ul>
<li><a class="reference internal" href="#r2lab.mapdataframe.MapDataFrame"><code class="docutils literal notranslate"><span class="pre">MapDataFrame</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-r2lab.sidecar">Probing the testbed status</a><ul>
<li><a class="reference internal" href="#r2lab.sidecar.SidecarAsyncClient"><code class="docutils literal notranslate"><span class="pre">SidecarAsyncClient</span></code></a></li>
<li><a class="reference internal" href="#r2lab.sidecar.SidecarProtocol"><code class="docutils literal notranslate"><span class="pre">SidecarProtocol</span></code></a><ul>
<li><a class="reference internal" href="#r2lab.sidecar.SidecarProtocol.nodes_status"><code class="docutils literal notranslate"><span class="pre">SidecarProtocol.nodes_status()</span></code></a></li>
<li><a class="reference internal" href="#r2lab.sidecar.SidecarProtocol.phones_status"><code class="docutils literal notranslate"><span class="pre">SidecarProtocol.phones_status()</span></code></a></li>
<li><a class="reference internal" href="#r2lab.sidecar.SidecarProtocol.recv_payload"><code class="docutils literal notranslate"><span class="pre">SidecarProtocol.recv_payload()</span></code></a></li>
<li><a class="reference internal" href="#r2lab.sidecar.SidecarProtocol.recv_umbrella"><code class="docutils literal notranslate"><span class="pre">SidecarProtocol.recv_umbrella()</span></code></a></li>
<li><a class="reference internal" href="#r2lab.sidecar.SidecarProtocol.send_payload"><code class="docutils literal notranslate"><span class="pre">SidecarProtocol.send_payload()</span></code></a></li>
<li><a class="reference internal" href="#r2lab.sidecar.SidecarProtocol.send_umbrella"><code class="docutils literal notranslate"><span class="pre">SidecarProtocol.send_umbrella()</span></code></a></li>
<li><a class="reference internal" href="#r2lab.sidecar.SidecarProtocol.set_node_attribute"><code class="docutils literal notranslate"><span class="pre">SidecarProtocol.set_node_attribute()</span></code></a></li>
<li><a class="reference internal" href="#r2lab.sidecar.SidecarProtocol.set_nodes_triples"><code class="docutils literal notranslate"><span class="pre">SidecarProtocol.set_nodes_triples()</span></code></a></li>
<li><a class="reference internal" href="#r2lab.sidecar.SidecarProtocol.set_phone_attribute"><code class="docutils literal notranslate"><span class="pre">SidecarProtocol.set_phone_attribute()</span></code></a></li>
<li><a class="reference internal" href="#r2lab.sidecar.SidecarProtocol.set_phones_triples"><code class="docutils literal notranslate"><span class="pre">SidecarProtocol.set_phones_triples()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#r2lab.sidecar.SidecarSyncClient"><code class="docutils literal notranslate"><span class="pre">SidecarSyncClient</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-r2lab.argparse_additions">Classes for <code class="docutils literal notranslate"><span class="pre">argparse</span></code></a><ul>
<li><a class="reference internal" href="#r2lab.argparse_additions.ListOfChoices"><code class="docutils literal notranslate"><span class="pre">ListOfChoices</span></code></a></li>
<li><a class="reference internal" href="#r2lab.argparse_additions.ListOfChoicesNullReset"><code class="docutils literal notranslate"><span class="pre">ListOfChoicesNullReset</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-r2lab.utils">General utilities</a><ul>
<li><a class="reference internal" href="#r2lab.utils.find_local_embedded_script"><code class="docutils literal notranslate"><span class="pre">find_local_embedded_script()</span></code></a></li>
<li><a class="reference internal" href="#r2lab.utils.r2lab_data"><code class="docutils literal notranslate"><span class="pre">r2lab_data()</span></code></a></li>
<li><a class="reference internal" href="#r2lab.utils.r2lab_hostname"><code class="docutils literal notranslate"><span class="pre">r2lab_hostname()</span></code></a></li>
<li><a class="reference internal" href="#r2lab.utils.r2lab_id"><code class="docutils literal notranslate"><span class="pre">r2lab_id()</span></code></a></li>
<li><a class="reference internal" href="#r2lab.utils.r2lab_parse_slice"><code class="docutils literal notranslate"><span class="pre">r2lab_parse_slice()</span></code></a></li>
<li><a class="reference internal" href="#r2lab.utils.r2lab_reboot"><code class="docutils literal notranslate"><span class="pre">r2lab_reboot()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="README.html"
                          title="previous chapter">&lt;no title&gt;</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="CHANGELOG.html"
                          title="next chapter">&lt;no title&gt;</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/API.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="CHANGELOG.html" title="&lt;no title&gt;"
             >next</a> |</li>
        <li class="right" >
          <a href="README.html" title="&lt;no title&gt;"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">r2lab v0.6.2</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">The r2lab API</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2016, Thierry Parmentelat.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>