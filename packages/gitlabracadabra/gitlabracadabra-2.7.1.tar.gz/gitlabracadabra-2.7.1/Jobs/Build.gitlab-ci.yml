build-deb:
  stage: build
  image: debian:bookworm@sha256:00cd074b40c4d99ff0c24540bdde0533ca3791edcdac0de36d6b9fb3260d89e2
  before_script:
    - apt-get update
    - apt-get install -y git-buildpackage --no-install-recommends
  script:
    - apt-get build-dep -y .
    - gbp buildpackage --git-ignore-branch --git-no-pbuilder --git-export-dir=${CI_PROJECT_DIR}/debian/output -us -uc
  rules:
    - if: '$CI_COMMIT_TAG || $CI_COMMIT_BRANCH'
  artifacts:
    name: "$CI_JOB_NAME:$CI_COMMIT_REF_NAME"
    paths:
      - ${CI_PROJECT_DIR}/debian/output/
