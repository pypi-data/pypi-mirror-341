"use strict";(self.webpackChunkmlflow_oidc_auth_front=self.webpackChunkmlflow_oidc_auth_front||[]).push([["src_app_features_admin-page_admin-page_module_ts"],{7070:(ze,j,l)=>{l.r(j),l.d(j,{AdminPageModule:()=>He});var P=l(177),B=l(9417),d=l(8498),f=l(5964),r=l(5558),u=l(8141),D=l(6354),F=l(4049),c=function(n){return n.EDIT="EDIT",n.DELETE="DELETE",n.REVOKE="REVOKE",n.ADD="ADD",n.MANAGE="MANAGE",n}(c||{});const g={ADD:{name:"Add",icon:"add",action:c.ADD},EDIT:{name:"Edit",icon:"edit",action:c.EDIT},DELETE:{name:"Delete",icon:"delete",action:c.DELETE},REVOKE:{name:"Reset to fallback",icon:"key_off",action:c.REVOKE}},Y=[g.EDIT,g.REVOKE],K=[{title:"User name",key:"username"},{title:"Permissions",key:"permission"}];var e=l(9498),y=l(1659),p=l(3160),v=l(113);let M=(()=>{class n{constructor(t){this.dialog=t}openEditPermissionsModal(t,i,s){return this.dialog.open(F.rs,{data:{targetEntity:i,entity:t,currentPermission:s}}).afterClosed()}openGrantPermissionModal(t=v.D2.EXPERIMENT,i,s){return this.dialog.open(F.Kb,{data:{entityType:t,entities:i,targetName:s}}).afterClosed()}static{this.\u0275fac=function(i){return new(i||n)(e.KVO(y.j))}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var E=l(5417),x=l(1551),G=l(2798);let H=(()=>{class n{constructor(t,i,s,o,m,h,U){this.dialog=t,this.experimentDataService=i,this.permissionDataService=s,this.userDataService=o,this.route=m,this.permissionModalService=h,this.snackBarService=U,this.userColumnConfig=K,this.actions=Y,this.userDataSource=[]}ngOnInit(){this.experimentId=this.route.snapshot.paramMap.get("id")??"",this.experimentDataService.getUsersForExperiment(this.experimentId).subscribe(t=>this.userDataSource=t)}handleUserEdit(t){this.permissionModalService.openEditPermissionsModal(this.experimentId,t.username,t.permission).pipe((0,f.p)(Boolean),(0,r.n)(i=>this.permissionDataService.updateExperimentPermission({experiment_id:this.experimentId,permission:i,user_name:t.username})),(0,u.M)(()=>this.snackBarService.openSnackBar("Permissions updated successfully")),(0,r.n)(()=>this.experimentDataService.getUsersForExperiment(this.experimentId))).subscribe(i=>{this.userDataSource=i})}handleActions(t){const s={[c.EDIT]:this.handleUserEdit.bind(this),[c.REVOKE]:this.revokePermissionForUser.bind(this)}[t.action.action];s&&s(t.item)}revokePermissionForUser(t){this.permissionDataService.deleteExperimentPermission({experiment_id:this.experimentId,user_name:t.username}).pipe((0,u.M)(()=>this.snackBarService.openSnackBar("Permission revoked successfully")),(0,r.n)(()=>this.loadUsersForExperiment(this.experimentId))).subscribe(i=>this.userDataSource=i)}addUser(){this.userDataService.getAllUsers().pipe((0,D.T)(({users:t})=>t.filter(i=>!this.userDataSource.some(s=>s.username===i))),(0,r.n)(t=>this.dialog.open(F.$5,{data:{users:t}}).afterClosed()),(0,f.p)(Boolean),(0,r.n)(({user:t,permission:i})=>this.permissionDataService.createExperimentPermission({experiment_id:this.experimentId,permission:i,user_name:t})),(0,r.n)(()=>this.loadUsersForExperiment(this.experimentId))).subscribe(t=>this.userDataSource=t)}loadUsersForExperiment(t){return this.experimentDataService.getUsersForExperiment(t)}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(y.j),e.rXU(p.qN),e.rXU(p.jd),e.rXU(p.Je),e.rXU(d.nX),e.rXU(M),e.rXU(p.vH))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["ml-experiment-permission-details"]],standalone:!1,decls:10,vars:3,consts:[[1,"my-3"],[1,"header-section"],["mat-button","",3,"click"],[3,"action","columnConfig","data","actions"]],template:function(i,s){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"h3"),e.EFF(3,"Experiment Access"),e.k0s(),e.j41(4,"button",2),e.bIt("click",function(){return s.addUser()}),e.j41(5,"mat-icon"),e.EFF(6,"add"),e.k0s(),e.j41(7,"span"),e.EFF(8,"Add"),e.k0s()()(),e.j41(9,"ml-table",3),e.bIt("action",function(m){return s.handleActions(m)}),e.k0s()()),2&i&&(e.R7$(9),e.Y8G("columnConfig",s.userColumnConfig)("data",s.userDataSource)("actions",s.actions))},dependencies:[E.O,x.d,G.M],encapsulation:2})}}return n})();const Q=[g.EDIT,g.REVOKE],J=[{title:"User name",key:"username"},{title:"Permissions",key:"permission"}];function z(n,S){if(1&n){const t=e.RV6();e.j41(0,"ml-table",4),e.bIt("action",function(s){e.eBV(t);const o=e.XpG();return e.Njj(o.handleActions(s))}),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("columnConfig",t.userColumnConfig)("data",t.userDataSource)("actions",t.actions)}}let W=(()=>{class n{constructor(t,i,s,o,m,h){this.route=t,this.promptDataService=i,this.permissionDataService=s,this.userDataService=o,this.snackService=m,this.permissionModalService=h,this.userDataSource=[],this.userColumnConfig=J,this.actions=Q}ngOnInit(){this.promptId=this.route.snapshot.paramMap.get("id")??"",this.loadUsersForPrompt(this.promptId).subscribe(t=>this.userDataSource=t)}revokePermissionForUser(t){this.permissionDataService.deletePromptPermission({name:this.promptId,user_name:t.username}).pipe((0,u.M)(()=>this.snackService.openSnackBar("Permission revoked successfully")),(0,r.n)(()=>this.loadUsersForPrompt(this.promptId))).subscribe(i=>this.userDataSource=i)}editPermissionForUser({username:t,permission:i}){this.permissionModalService.openEditPermissionsModal(this.promptId,t,i).pipe((0,f.p)(Boolean),(0,r.n)(s=>this.permissionDataService.updatePromptPermission({name:this.promptId,permission:s,user_name:t})),(0,u.M)(()=>this.snackService.openSnackBar("Permission updated")),(0,r.n)(()=>this.loadUsersForPrompt(this.promptId))).subscribe(s=>{this.userDataSource=s})}handleActions({action:t,item:i}){const o={[c.REVOKE]:this.revokePermissionForUser.bind(this),[c.EDIT]:this.editPermissionForUser.bind(this)}[t.action];o&&o(i)}loadUsersForPrompt(t){return this.promptDataService.getUsersForPrompt(t)}addUser(){this.userDataService.getAllUsers().pipe((0,D.T)(({users:t})=>t.filter(i=>!this.userDataSource.some(s=>s.username===i))),(0,r.n)(t=>this.permissionModalService.openGrantPermissionModal(v.D2.MODEL,t.map((i,s)=>({id:s+i,name:i})),this.promptId)),(0,f.p)(Boolean),(0,r.n)(({entity:t,permission:i})=>this.permissionDataService.createPromptPermission({name:this.promptId,permission:i,user_name:t.name})),(0,r.n)(()=>this.loadUsersForPrompt(this.promptId))).subscribe(t=>{this.userDataSource=t})}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(d.nX),e.rXU(p.fo),e.rXU(p.jd),e.rXU(p.Je),e.rXU(p.vH),e.rXU(M))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["ml-prompt-permission-details"]],standalone:!1,decls:10,vars:1,consts:[[1,"my-3"],[1,"header-section"],["mat-button","",3,"click"],[3,"columnConfig","data","actions","action",4,"ngIf"],[3,"action","columnConfig","data","actions"]],template:function(i,s){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"h3"),e.EFF(3,"Prompt Access"),e.k0s(),e.j41(4,"button",2),e.bIt("click",function(){return s.addUser()}),e.j41(5,"mat-icon"),e.EFF(6,"add"),e.k0s(),e.j41(7,"span"),e.EFF(8,"Add"),e.k0s()()(),e.DNE(9,z,1,3,"ml-table",3),e.k0s()),2&i&&(e.R7$(9),e.Y8G("ngIf",s.userDataSource.length))},dependencies:[P.bT,E.O,x.d,G.M],encapsulation:2})}}return n})();const Z=[g.EDIT,g.REVOKE],w=[{title:"User name",key:"username"},{title:"Permissions",key:"permission"}];function q(n,S){if(1&n){const t=e.RV6();e.j41(0,"ml-table",4),e.bIt("action",function(s){e.eBV(t);const o=e.XpG();return e.Njj(o.handleActions(s))}),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("columnConfig",t.userColumnConfig)("data",t.userDataSource)("actions",t.actions)}}let ee=(()=>{class n{constructor(t,i,s,o,m,h){this.route=t,this.modelDataService=i,this.permissionDataService=s,this.userDataService=o,this.snackService=m,this.permissionModalService=h,this.userDataSource=[],this.userColumnConfig=w,this.actions=Z}ngOnInit(){this.modelId=this.route.snapshot.paramMap.get("id")??"",this.loadUsersForModel(this.modelId).subscribe(t=>this.userDataSource=t)}revokePermissionForUser(t){this.permissionDataService.deleteModelPermission({name:this.modelId,user_name:t.username}).pipe((0,u.M)(()=>this.snackService.openSnackBar("Permission revoked successfully")),(0,r.n)(()=>this.loadUsersForModel(this.modelId))).subscribe(i=>this.userDataSource=i)}editPermissionForUser({username:t,permission:i}){this.permissionModalService.openEditPermissionsModal(this.modelId,t,i).pipe((0,f.p)(Boolean),(0,r.n)(s=>this.permissionDataService.updateModelPermission({name:this.modelId,permission:s,user_name:t})),(0,u.M)(()=>this.snackService.openSnackBar("Permission updated")),(0,r.n)(()=>this.loadUsersForModel(this.modelId))).subscribe(s=>{this.userDataSource=s})}handleActions({action:t,item:i}){const o={[c.REVOKE]:this.revokePermissionForUser.bind(this),[c.EDIT]:this.editPermissionForUser.bind(this)}[t.action];o&&o(i)}loadUsersForModel(t){return this.modelDataService.getUsersForModel(t)}addUser(){this.userDataService.getAllUsers().pipe((0,D.T)(({users:t})=>t.filter(i=>!this.userDataSource.some(s=>s.username===i))),(0,r.n)(t=>this.permissionModalService.openGrantPermissionModal(v.D2.MODEL,t.map((i,s)=>({id:s+i,name:i})),this.modelId)),(0,f.p)(Boolean),(0,r.n)(({entity:t,permission:i})=>this.permissionDataService.createModelPermission({name:this.modelId,permission:i,user_name:t.name})),(0,r.n)(()=>this.loadUsersForModel(this.modelId))).subscribe(t=>{this.userDataSource=t})}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(d.nX),e.rXU(p.EE),e.rXU(p.jd),e.rXU(p.Je),e.rXU(p.vH),e.rXU(M))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["ml-model-permission-details"]],standalone:!1,decls:10,vars:1,consts:[[1,"my-3"],[1,"header-section"],["mat-button","",3,"click"],[3,"columnConfig","data","actions","action",4,"ngIf"],[3,"action","columnConfig","data","actions"]],template:function(i,s){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"h3"),e.EFF(3,"Model Access"),e.k0s(),e.j41(4,"button",2),e.bIt("click",function(){return s.addUser()}),e.j41(5,"mat-icon"),e.EFF(6,"add"),e.k0s(),e.j41(7,"span"),e.EFF(8,"Add"),e.k0s()()(),e.DNE(9,q,1,3,"ml-table",3),e.k0s()),2&i&&(e.R7$(9),e.Y8G("ngIf",s.userDataSource.length))},dependencies:[P.bT,E.O,x.d,G.M],encapsulation:2})}}return n})();var te=l(7468),O=l(5412);const ie=[{title:"Model name",key:"name"},{title:"Permissions",key:"permission"},{title:"Type",key:"type"}],se=[{title:"Experiment Name",key:"name"},{title:"Permission",key:"permission"},{title:"Type",key:"type"}],ne=[g.EDIT,g.REVOKE],oe=[g.EDIT,g.REVOKE];var b=l(6850);const re=["userTabs"];function ae(n,S){if(1&n){const t=e.RV6();e.j41(0,"ml-table",7),e.bIt("action",function(s){e.eBV(t);const o=e.XpG();return e.Njj(o.handleExperimentActions(s))}),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("columnConfig",t.experimentsColumnConfig)("data",t.experimentsDataSource)("actions",t.experimentsActions)}}function ce(n,S){if(1&n){const t=e.RV6();e.j41(0,"ml-table",7),e.bIt("action",function(s){e.eBV(t);const o=e.XpG();return e.Njj(o.handleModelActions(s))}),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("columnConfig",t.modelsColumnConfig)("data",t.modelsDataSource)("actions",t.modelsActions)}}let N=(()=>{class n{constructor(t,i,s,o,m,h,U){this.expDataService=t,this.modelDataService=i,this.permissionDataService=s,this.route=o,this.permissionModalService=m,this.snackBarService=h,this.router=U,this.userId="",this.experimentsColumnConfig=se,this.modelsColumnConfig=ie,this.experimentsDataSource=[],this.modelsDataSource=[],this.experimentsActions=ne,this.modelsActions=oe,this.tabIndexMapping=["experiments","models"]}ngOnInit(){this.userId=this.route.snapshot.paramMap.get("id")??"",(0,te.p)([this.expDataService.getExperimentsForUser(this.userId),this.modelDataService.getModelsForUser(this.userId)]).subscribe(([t,i])=>{this.experimentsDataSource=t,this.modelsDataSource=i})}ngAfterViewInit(){const t=String(this.route.snapshot.url[2]);this.permissionsTabs.selectedIndex=t?this.tabIndexMapping.indexOf(t):0}addModelPermissionToUser(){return this.modelDataService.getAllModels().pipe((0,D.T)(t=>t.map((i,s)=>({...i,id:`${s}-${i.name}`}))),(0,D.T)(t=>t.filter(i=>!this.modelsDataSource.some(s=>s.name===i.name))),(0,r.n)(t=>this.permissionModalService.openGrantPermissionModal(v.D2.MODEL,t,this.userId)),(0,f.p)(Boolean),(0,r.n)(({entity:t,permission:i})=>this.permissionDataService.createModelPermission({user_name:this.userId,name:t.name,permission:i})),(0,u.M)(()=>this.snackBarService.openSnackBar("Permission granted successfully")),(0,r.n)(()=>this.modelDataService.getModelsForUser(this.userId))).subscribe(t=>this.modelsDataSource=t)}addExperimentPermissionToUser(){this.expDataService.getAllExperiments().pipe((0,D.T)(t=>t.filter(i=>!this.experimentsDataSource.some(s=>s.id===i.id))),(0,r.n)(t=>this.permissionModalService.openGrantPermissionModal(v.D2.EXPERIMENT,t,this.userId)),(0,f.p)(Boolean),(0,r.n)(({entity:t,permission:i})=>this.permissionDataService.createExperimentPermission({user_name:this.userId,experiment_name:t.name,permission:i})),(0,u.M)(()=>this.snackBarService.openSnackBar("Permission granted successfully")),(0,r.n)(()=>this.expDataService.getExperimentsForUser(this.userId))).subscribe(t=>this.experimentsDataSource=t)}handleExperimentActions(t){const s={[c.EDIT]:this.handleEditUserPermissionForExperiment.bind(this),[c.REVOKE]:this.revokeExperimentPermissionForUser.bind(this)}[t.action.action];s&&s(t.item)}revokeExperimentPermissionForUser(t){t.type===O.tX.USER?this.permissionDataService.deleteExperimentPermission({experiment_id:t.id,user_name:this.userId}).pipe((0,u.M)(()=>this.snackBarService.openSnackBar("Permission revoked successfully")),(0,r.n)(()=>this.expDataService.getExperimentsForUser(this.userId))).subscribe(i=>this.experimentsDataSource=i):this.snackBarService.openSnackBar("Nothing to reset")}revokeModelPermissionForUser({name:t,type:i}){i===O.tX.USER?this.permissionDataService.deleteModelPermission({name:t,user_name:this.userId}).pipe((0,u.M)(()=>this.snackBarService.openSnackBar("Permission revoked successfully")),(0,r.n)(()=>this.modelDataService.getModelsForUser(this.userId))).subscribe(s=>this.modelsDataSource=s):this.snackBarService.openSnackBar("Nothing to reset")}handleModelActions({action:t,item:i}){const o={[c.EDIT]:this.handleEditUserPermissionForModel.bind(this),[c.REVOKE]:this.revokeModelPermissionForUser.bind(this)}[t.action];o&&o(i)}handleEditUserPermissionForModel({name:t,permission:i,type:s}){this.permissionModalService.openEditPermissionsModal(t,this.userId,i).pipe((0,f.p)(Boolean),(0,r.n)(o=>{const m={name:t,permission:o,user_name:this.userId};return s!==O.tX.FALLBACK?this.permissionDataService.createModelPermission(m):this.permissionDataService.updateModelPermission(m)}),(0,u.M)(()=>this.snackBarService.openSnackBar("Permissions updated successfully")),(0,r.n)(()=>this.modelDataService.getModelsForUser(this.userId))).subscribe(o=>this.modelsDataSource=o)}handleEditUserPermissionForExperiment({id:t,permission:i,type:s}){this.permissionModalService.openEditPermissionsModal(t,this.userId,i).pipe((0,f.p)(Boolean),(0,r.n)(o=>{const m={experiment_id:t,permission:o,user_name:this.userId};return s!==O.tX.USER?this.permissionDataService.createExperimentPermission(m):this.permissionDataService.updateExperimentPermission(m)}),(0,u.M)(()=>this.snackBarService.openSnackBar("Permissions updated successfully")),(0,r.n)(()=>this.expDataService.getExperimentsForUser(this.userId))).subscribe(o=>this.experimentsDataSource=o)}handleTabSelection(t){this.router.navigate([`../${this.tabIndexMapping[t]}`],{relativeTo:this.route})}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(p.qN),e.rXU(p.EE),e.rXU(p.jd),e.rXU(d.nX),e.rXU(M),e.rXU(p.vH),e.rXU(d.Ix))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["ml-user-permission-details"]],viewQuery:function(i,s){if(1&i&&e.GBs(re,5),2&i){let o;e.mGM(o=e.lsd())&&(s.permissionsTabs=o.first)}},standalone:!1,decls:10,vars:2,consts:[["userTabs",""],[3,"selectedIndexChange"],["label","Experiments"],[1,"my-3"],[1,"header-section"],[3,"columnConfig","data","actions","action",4,"ngIf"],["label","Models"],[3,"action","columnConfig","data","actions"]],template:function(i,s){if(1&i){const o=e.RV6();e.j41(0,"mat-tab-group",1,0),e.bIt("selectedIndexChange",function(h){return e.eBV(o),e.Njj(s.handleTabSelection(h))}),e.j41(2,"mat-tab",2)(3,"div",3),e.nrm(4,"div",4),e.DNE(5,ae,1,3,"ml-table",5),e.k0s()(),e.j41(6,"mat-tab",6)(7,"div",3),e.nrm(8,"div",4),e.DNE(9,ce,1,3,"ml-table",5),e.k0s()()()}2&i&&(e.R7$(5),e.Y8G("ngIf",s.experimentsDataSource.length),e.R7$(4),e.Y8G("ngIf",s.modelsDataSource.length))},dependencies:[P.bT,E.O,b.mq,b.T8],styles:[".header-section[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:36px}.header-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;padding:0}"]})}}return n})();const me=[{title:"Experiment name",key:"name"},{title:"Permission",key:"permission"}],le=[g.EDIT,g.REVOKE],pe=[{title:"Model name",key:"name"},{title:"Permission",key:"permission"}],de=[g.EDIT,g.REVOKE],ue=[{title:"Prompt name",key:"name"},{title:"Permission",key:"permission"}],he=[g.EDIT,g.REVOKE];var k=l(2299),ge=l(1626);let R=(()=>{class n{constructor(t){this.http=t}getAllGroups(){return this.http.get(k.H.ALL_GROUPS)}getAllExperimentsForGroup(t){return this.http.get(k.H.EXPERIMENTS_FOR_GROUP.replace("${groupName}",t))}getAllRegisteredModelsForGroup(t){return this.http.get(k.H.MODELS_FOR_GROUP.replace("${groupName}",t))}getAllPromptsForGroup(t){return this.http.get(k.H.PROMPTS_FOR_GROUP.replace("${groupName}",t))}static{this.\u0275fac=function(i){return new(i||n)(e.KVO(ge.Qq))}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const fe=["permissionsTabs"];let A=(()=>{class n{constructor(t,i,s,o,m,h,U,Qe,Je){this.groupDataService=t,this.route=i,this.permissionDataService=s,this.permissionModalService=o,this.experimentsDataService=m,this.snackBarService=h,this.modelDataService=U,this.promptDataService=Qe,this.router=Je,this.groupName="",this.experimentColumnConfig=me,this.experimentDataSource=[],this.experimentActions=le,this.modelColumnConfig=pe,this.modelDataSource=[],this.modelActions=de,this.promptColumnConfig=ue,this.promptDataSource=[],this.promptActions=he,this.tabIndexMapping=["experiments","models","prompts"]}ngOnInit(){this.groupName=this.route.snapshot.paramMap.get("id")??"",this.groupDataService.getAllExperimentsForGroup(this.groupName).subscribe(t=>this.experimentDataSource=t),this.groupDataService.getAllRegisteredModelsForGroup(this.groupName).subscribe(t=>this.modelDataSource=t),this.groupDataService.getAllPromptsForGroup(this.groupName).subscribe(t=>this.promptDataSource=t)}ngAfterViewInit(){const t=String(this.route.snapshot.url[2]);this.permissionsTabs.selectedIndex=t?this.tabIndexMapping.indexOf(t):0}openModalAddExperimentPermissionToGroup(){this.experimentsDataService.getAllExperiments().pipe((0,D.T)(t=>t.filter(i=>!this.experimentDataSource.some(s=>s.name===i.name))),(0,r.n)(t=>this.permissionModalService.openGrantPermissionModal(v.D2.EXPERIMENT,t,this.groupName)),(0,f.p)(Boolean),(0,r.n)(t=>this.permissionDataService.addExperimentPermissionToGroup(this.groupName,t.entity.id,t.permission)),(0,u.M)(()=>this.snackBarService.openSnackBar("Permission granted successfully")),(0,r.n)(()=>this.groupDataService.getAllExperimentsForGroup(this.groupName))).subscribe(t=>this.experimentDataSource=t)}openModalAddModelPermissionToGroup(){this.modelDataService.getAllModels().pipe((0,D.T)(t=>t.filter(i=>!this.modelDataSource.some(s=>s.name===i.name)).map((i,s)=>({...i,id:`${s}-${i.name}`}))),(0,r.n)(t=>this.permissionModalService.openGrantPermissionModal(v.D2.MODEL,t,this.groupName)),(0,f.p)(Boolean),(0,r.n)(t=>this.permissionDataService.addModelPermissionToGroup(t.entity.name,this.groupName,t.permission)),(0,u.M)(()=>this.snackBarService.openSnackBar("Permission granted successfully")),(0,r.n)(()=>this.groupDataService.getAllRegisteredModelsForGroup(this.groupName))).subscribe(t=>this.modelDataSource=t)}openModalAddPromptPermissionToGroup(){this.promptDataService.getAllPrompts().pipe((0,D.T)(t=>t.filter(i=>!this.promptDataSource.some(s=>s.name===i.name)).map((i,s)=>({...i,id:`${s}-${i.name}`}))),(0,r.n)(t=>this.permissionModalService.openGrantPermissionModal(v.D2.PROMPT,t,this.groupName)),(0,f.p)(Boolean),(0,r.n)(t=>this.permissionDataService.addPromptPermissionToGroup(t.entity.name,this.groupName,t.permission)),(0,u.M)(()=>this.snackBarService.openSnackBar("Permission granted successfully")),(0,r.n)(()=>this.groupDataService.getAllPromptsForGroup(this.groupName))).subscribe(t=>this.promptDataSource=t)}handleExperimentActions(t){const s={[c.EDIT]:this.handleEditExperimentPermissionForGroup.bind(this),[c.REVOKE]:this.revokeExperimentPermissionForGroup.bind(this)}[t.action.action];s&&s(t.item)}handleEditExperimentPermissionForGroup(t){this.permissionModalService.openEditPermissionsModal(t.name,this.groupName,t.permission).pipe((0,f.p)(Boolean),(0,r.n)(i=>this.permissionDataService.updateExperimentPermissionForGroup(this.groupName,t.id,i)),(0,u.M)(()=>this.snackBarService.openSnackBar("Permission updated successfully")),(0,r.n)(()=>this.groupDataService.getAllExperimentsForGroup(this.groupName))).subscribe(i=>this.experimentDataSource=i)}revokeExperimentPermissionForGroup(t){this.permissionDataService.removeExperimentPermissionFromGroup(this.groupName,t.id).pipe((0,u.M)(()=>this.snackBarService.openSnackBar("Permission revoked successfully")),(0,r.n)(()=>this.groupDataService.getAllExperimentsForGroup(this.groupName))).subscribe(i=>this.experimentDataSource=i)}handleModelActions(t){const s={[c.EDIT]:this.handleEditModelPermissionForGroup.bind(this),[c.REVOKE]:this.revokeModelPermissionForGroup.bind(this)}[t.action.action];s&&s(t.item)}handleEditModelPermissionForGroup(t){this.permissionModalService.openEditPermissionsModal(t.name,this.groupName,t.permission).pipe((0,f.p)(Boolean),(0,r.n)(i=>this.permissionDataService.updateModelPermissionForGroup(t.name,this.groupName,i)),(0,u.M)(()=>this.snackBarService.openSnackBar("Permission updated successfully")),(0,r.n)(()=>this.groupDataService.getAllRegisteredModelsForGroup(this.groupName))).subscribe(i=>this.modelDataSource=i)}revokeModelPermissionForGroup(t){this.permissionDataService.removeModelPermissionFromGroup(t.name,this.groupName).pipe((0,u.M)(()=>this.snackBarService.openSnackBar("Permission revoked successfully")),(0,r.n)(()=>this.groupDataService.getAllRegisteredModelsForGroup(this.groupName))).subscribe(i=>this.modelDataSource=i)}handlePromptActions(t){const s={[c.EDIT]:this.handleEditPromptPermissionForGroup.bind(this),[c.REVOKE]:this.revokePromptPermissionForGroup.bind(this)}[t.action.action];s&&s(t.item)}handleEditPromptPermissionForGroup(t){this.permissionModalService.openEditPermissionsModal(t.name,this.groupName,t.permission).pipe((0,f.p)(Boolean),(0,r.n)(i=>this.permissionDataService.updatePromptPermissionForGroup(t.name,this.groupName,i)),(0,u.M)(()=>this.snackBarService.openSnackBar("Permission updated successfully")),(0,r.n)(()=>this.groupDataService.getAllPromptsForGroup(this.groupName))).subscribe(i=>this.promptDataSource=i)}revokePromptPermissionForGroup(t){this.permissionDataService.removePromptPermissionFromGroup(t.name,this.groupName).pipe((0,u.M)(()=>this.snackBarService.openSnackBar("Permission revoked successfully")),(0,r.n)(()=>this.groupDataService.getAllPromptsForGroup(this.groupName))).subscribe(i=>this.promptDataSource=i)}handleTabSelection(t){this.router.navigate([`../${this.tabIndexMapping[t]}`],{relativeTo:this.route})}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(R),e.rXU(d.nX),e.rXU(p.jd),e.rXU(M),e.rXU(p.qN),e.rXU(p.vH),e.rXU(p.EE),e.rXU(p.fo),e.rXU(d.Ix))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["ml-group-permission-details"]],viewQuery:function(i,s){if(1&i&&e.GBs(fe,5),2&i){let o;e.mGM(o=e.lsd())&&(s.permissionsTabs=o.first)}},standalone:!1,decls:29,vars:9,consts:[["permissionsTabs",""],[3,"selectedIndexChange"],["label","Experiments"],[1,"my-3"],[1,"header-section"],["mat-button","",3,"click"],[3,"action","columnConfig","data","actions"],["label","Models"],["label","Prompts"]],template:function(i,s){if(1&i){const o=e.RV6();e.j41(0,"mat-tab-group",1,0),e.bIt("selectedIndexChange",function(h){return e.eBV(o),e.Njj(s.handleTabSelection(h))}),e.j41(2,"mat-tab",2)(3,"div",3)(4,"div",4)(5,"button",5),e.bIt("click",function(){return e.eBV(o),e.Njj(s.openModalAddExperimentPermissionToGroup())}),e.j41(6,"mat-icon"),e.EFF(7,"add"),e.k0s(),e.j41(8,"span"),e.EFF(9,"Add"),e.k0s()()()(),e.j41(10,"ml-table",6),e.bIt("action",function(h){return e.eBV(o),e.Njj(s.handleExperimentActions(h))}),e.k0s()(),e.j41(11,"mat-tab",7)(12,"div",3)(13,"div",4)(14,"button",5),e.bIt("click",function(){return e.eBV(o),e.Njj(s.openModalAddModelPermissionToGroup())}),e.j41(15,"mat-icon"),e.EFF(16,"add"),e.k0s(),e.j41(17,"span"),e.EFF(18,"Add"),e.k0s()()()(),e.j41(19,"ml-table",6),e.bIt("action",function(h){return e.eBV(o),e.Njj(s.handleModelActions(h))}),e.k0s()(),e.j41(20,"mat-tab",8)(21,"div",3)(22,"div",4)(23,"button",5),e.bIt("click",function(){return e.eBV(o),e.Njj(s.openModalAddPromptPermissionToGroup())}),e.j41(24,"mat-icon"),e.EFF(25,"add"),e.k0s(),e.j41(26,"span"),e.EFF(27,"Add"),e.k0s()()()(),e.j41(28,"ml-table",6),e.bIt("action",function(h){return e.eBV(o),e.Njj(s.handlePromptActions(h))}),e.k0s()()()}2&i&&(e.R7$(10),e.Y8G("columnConfig",s.experimentColumnConfig)("data",s.experimentDataSource)("actions",s.experimentActions),e.R7$(9),e.Y8G("columnConfig",s.modelColumnConfig)("data",s.modelDataSource)("actions",s.modelActions),e.R7$(9),e.Y8G("columnConfig",s.promptColumnConfig)("data",s.promptDataSource)("actions",s.promptActions))},dependencies:[E.O,x.d,G.M,b.mq,b.T8],encapsulation:2})}}return n})();var a=function(n){return n.PERMISSIONS="permissions",n.USER="user",n.EXPERIMENT="experiment",n.MODEL="model",n.GROUP="group",n.USERS="users",n.EXPERIMENTS="experiments",n.MODELS="models",n.GROUPS="groups",n.PROMPT="prompt",n.PROMPTS="prompts",n}(a||{}),I=l(980);const Se=[{title:"User name",key:"user"}],Ee=[g.EDIT];var C=l(9183);function Pe(n,S){if(1&n){const t=e.RV6();e.j41(0,"ml-table",2),e.bIt("action",function(s){e.eBV(t);const o=e.XpG();return e.Njj(o.handleItemAction(s))}),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("columnConfig",t.columnConfig)("data",t.dataSource)("actions",t.actions)}}function De(n,S){1&n&&(e.j41(0,"div",3),e.nrm(1,"mat-spinner",4),e.k0s()),2&n&&(e.R7$(),e.Y8G("diameter",40))}let _e=(()=>{class n{constructor(t,i,s){this.router=t,this.route=i,this.userDataService=s,this.columnConfig=Se,this.actions=Ee,this.dataSource=[],this.isLoading=!1}ngOnInit(){this.isLoading=!0,this.userDataService.getAllUsers().pipe((0,I.j)(()=>this.isLoading=!1)).subscribe(({users:t})=>this.dataSource=t.map(i=>({user:i})))}handleItemAction({action:t,item:i}){const o={[c.EDIT]:this.handleUserEdit.bind(this)}[t.action];o&&o(i)}handleUserEdit({user:t}){this.router.navigate([`../${a.USER}/`+t],{relativeTo:this.route})}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(d.Ix),e.rXU(d.nX),e.rXU(p.Je))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["ml-user-permissions"]],standalone:!1,decls:3,vars:2,consts:[["loader",""],[3,"columnConfig","data","actions","action",4,"ngIf","ngIfElse"],[3,"action","columnConfig","data","actions"],[1,"loader","d-flex","justify-content-center","align-items-center","my-5"],[3,"diameter"]],template:function(i,s){if(1&i&&e.DNE(0,Pe,1,3,"ml-table",1)(1,De,2,1,"ng-template",null,0,e.C5r),2&i){const o=e.sdS(2);e.Y8G("ngIf",!s.isLoading)("ngIfElse",o)}},dependencies:[P.bT,E.O,C.LG],encapsulation:2})}}return n})();const ve=[{action:c.EDIT,icon:"edit",name:"Edit"}],be=[{title:"Experiment Name",key:"name"}];function Me(n,S){if(1&n){const t=e.RV6();e.j41(0,"ml-table",2),e.bIt("action",function(s){e.eBV(t);const o=e.XpG();return e.Njj(o.handleActions(s))}),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("columnConfig",t.columnConfig)("data",t.dataSource)("actions",t.actions)}}function Ie(n,S){1&n&&(e.j41(0,"div",3),e.nrm(1,"mat-spinner",4),e.k0s()),2&n&&(e.R7$(),e.Y8G("diameter",40))}let Ce=(()=>{class n{constructor(t,i,s){this.router=t,this.route=i,this.experimentDataService=s,this.columnConfig=be,this.dataSource=[],this.actions=ve,this.isLoading=!1}ngOnInit(){this.isLoading=!0,this.experimentDataService.getAllExperiments().pipe((0,I.j)(()=>this.isLoading=!1)).subscribe(t=>this.dataSource=t)}handleActions(t){const s={[c.EDIT]:this.handleExperimentEdit.bind(this)}[t.action.action];s&&s(t.item)}handleExperimentEdit({id:t}){this.router.navigate([`../${a.EXPERIMENT}/`+t],{relativeTo:this.route})}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(d.Ix),e.rXU(d.nX),e.rXU(p.qN))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["ml-experiment-permissions"]],standalone:!1,decls:3,vars:2,consts:[["loader",""],[3,"columnConfig","data","actions","action",4,"ngIf","ngIfElse"],[3,"action","columnConfig","data","actions"],[1,"loader","d-flex","justify-content-center","align-items-center","my-5"],[3,"diameter"]],template:function(i,s){if(1&i&&e.DNE(0,Me,1,3,"ml-table",1)(1,Ie,2,1,"ng-template",null,0,e.C5r),2&i){const o=e.sdS(2);e.Y8G("ngIf",!s.isLoading)("ngIfElse",o)}},dependencies:[P.bT,E.O,C.LG],encapsulation:2})}}return n})();const Te=[{title:"Model Name",key:"name"}],Ue=[g.EDIT];function xe(n,S){if(1&n){const t=e.RV6();e.j41(0,"ml-table",2),e.bIt("action",function(s){e.eBV(t);const o=e.XpG();return e.Njj(o.handleAction(s))}),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("columnConfig",t.columnConfig)("data",t.dataSource)("actions",t.actions)}}function Ge(n,S){1&n&&(e.j41(0,"div",3),e.nrm(1,"mat-spinner",4),e.k0s()),2&n&&(e.R7$(),e.Y8G("diameter",40))}let Oe=(()=>{class n{constructor(t,i,s){this.route=t,this.router=i,this.modelDataService=s,this.columnConfig=Te,this.dataSource=[],this.actions=Ue,this.isLoading=!1}ngOnInit(){this.isLoading=!0,this.modelDataService.getAllModels().pipe((0,I.j)(()=>this.isLoading=!1)).subscribe(t=>{this.dataSource=t})}handleModelEdit({name:t}){this.router.navigate([`../${a.MODEL}/`+t],{relativeTo:this.route})}handleAction({action:t,item:i}){const o={[c.EDIT]:this.handleModelEdit.bind(this)}[t.action];o&&o(i)}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(d.nX),e.rXU(d.Ix),e.rXU(p.EE))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["ml-model-permissions"]],standalone:!1,decls:3,vars:2,consts:[["loader",""],[3,"columnConfig","data","actions","action",4,"ngIf","ngIfElse"],[3,"action","columnConfig","data","actions"],[1,"loader","d-flex","justify-content-center","align-items-center","my-5"],[3,"diameter"]],template:function(i,s){if(1&i&&e.DNE(0,xe,1,3,"ml-table",1)(1,Ge,2,1,"ng-template",null,0,e.C5r),2&i){const o=e.sdS(2);e.Y8G("ngIf",!s.isLoading)("ngIfElse",o)}},dependencies:[P.bT,E.O,C.LG],encapsulation:2})}}return n})();const ke=[{title:"Prompt Name",key:"name"}],Fe=[g.EDIT];function Ne(n,S){if(1&n){const t=e.RV6();e.j41(0,"ml-table",2),e.bIt("action",function(s){e.eBV(t);const o=e.XpG();return e.Njj(o.handleAction(s))}),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("columnConfig",t.columnConfig)("data",t.dataSource)("actions",t.actions)}}function Ae(n,S){1&n&&(e.j41(0,"div",3),e.nrm(1,"mat-spinner",4),e.k0s()),2&n&&(e.R7$(),e.Y8G("diameter",40))}let je=(()=>{class n{constructor(t,i,s){this.route=t,this.router=i,this.promptDataService=s,this.columnConfig=ke,this.dataSource=[],this.actions=Fe,this.isLoading=!1}ngOnInit(){this.isLoading=!0,this.promptDataService.getAllPrompts().pipe((0,I.j)(()=>this.isLoading=!1)).subscribe(t=>{this.dataSource=t})}handlePromptEdit({name:t}){this.router.navigate([`../${a.PROMPT}/`+t],{relativeTo:this.route})}handleAction({action:t,item:i}){const o={[c.EDIT]:this.handlePromptEdit.bind(this)}[t.action];o&&o(i)}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(d.nX),e.rXU(d.Ix),e.rXU(p.fo))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["ml-prompt-permissions"]],standalone:!1,decls:3,vars:2,consts:[["loader",""],[3,"columnConfig","data","actions","action",4,"ngIf","ngIfElse"],[3,"action","columnConfig","data","actions"],[1,"loader","d-flex","justify-content-center","align-items-center","my-5"],[3,"diameter"]],template:function(i,s){if(1&i&&e.DNE(0,Ne,1,3,"ml-table",1)(1,Ae,2,1,"ng-template",null,0,e.C5r),2&i){const o=e.sdS(2);e.Y8G("ngIf",!s.isLoading)("ngIfElse",o)}},dependencies:[P.bT,E.O,C.LG],encapsulation:2})}}return n})();const ye=[{title:"Group name",key:"group"}],Re=[g.EDIT];function Be(n,S){if(1&n){const t=e.RV6();e.j41(0,"ml-table",2),e.bIt("action",function(s){e.eBV(t);const o=e.XpG();return e.Njj(o.handleItemAction(s))}),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("columnConfig",t.columnConfig)("data",t.dataSource)("actions",t.actions)}}function Xe(n,S){1&n&&(e.j41(0,"div",3),e.nrm(1,"mat-spinner",4),e.k0s()),2&n&&(e.R7$(),e.Y8G("diameter",40))}let Le=(()=>{class n{constructor(t,i,s){this.router=t,this.route=i,this.groupDataService=s,this.columnConfig=ye,this.dataSource=[],this.actions=Re,this.isLoading=!1}ngOnInit(){this.isLoading=!0,this.groupDataService.getAllGroups().pipe((0,I.j)(()=>this.isLoading=!1)).subscribe(({groups:t})=>this.dataSource=t.map(i=>({group:i})))}handleItemAction({action:t,item:i}){const o={[c.EDIT]:this.handleUserEdit.bind(this)}[t.action];o&&o(i)}handleUserEdit({group:t}){this.router.navigate([`../${a.GROUP}/`+t],{relativeTo:this.route})}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(d.Ix),e.rXU(d.nX),e.rXU(R))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["ml-group-permissions"]],standalone:!1,decls:3,vars:2,consts:[["loader",""],[3,"columnConfig","data","actions","action",4,"ngIf","ngIfElse"],[3,"action","columnConfig","data","actions"],[1,"loader","d-flex","justify-content-center","align-items-center","my-5"],[3,"diameter"]],template:function(i,s){if(1&i&&e.DNE(0,Be,1,3,"ml-table",1)(1,Xe,2,1,"ng-template",null,0,e.C5r),2&i){const o=e.sdS(2);e.Y8G("ngIf",!s.isLoading)("ngIfElse",o)}},dependencies:[P.bT,E.O,C.LG],encapsulation:2})}}return n})();const Ve=["permissionsTabs"];let T=(()=>{class n{constructor(t,i){this.route=t,this.router=i,this.tabIndexMapping=[a.USERS,a.EXPERIMENTS,a.PROMPTS,a.MODELS,a.GROUPS]}ngAfterViewInit(){const t=this.route.snapshot.routeConfig?.path;this.permissionsTabs.selectedIndex=t?this.tabIndexMapping.indexOf(t):0}handleTabSelection(t){this.router.navigate([`../${this.tabIndexMapping[t]}`],{relativeTo:this.route})}static{this.\u0275fac=function(i){return new(i||n)(e.rXU(d.nX),e.rXU(d.Ix))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["ml-permissions"]],viewQuery:function(i,s){if(1&i&&e.GBs(Ve,5),2&i){let o;e.mGM(o=e.lsd())&&(s.permissionsTabs=o.first)}},standalone:!1,decls:17,vars:0,consts:[["permissionsTabs",""],[3,"selectedIndexChange"],["label","Users permissions"],[1,"my-3"],["label","Experiment permissions"],["label","Prompt permissions"],["label","Model permissions"],["label","Group permissions"]],template:function(i,s){if(1&i){const o=e.RV6();e.j41(0,"mat-tab-group",1,0),e.bIt("selectedIndexChange",function(h){return e.eBV(o),e.Njj(s.handleTabSelection(h))}),e.j41(2,"mat-tab",2)(3,"div",3),e.nrm(4,"ml-user-permissions"),e.k0s()(),e.j41(5,"mat-tab",4)(6,"div",3),e.nrm(7,"ml-experiment-permissions"),e.k0s()(),e.j41(8,"mat-tab",5)(9,"div",3),e.nrm(10,"ml-prompt-permissions"),e.k0s()(),e.j41(11,"mat-tab",6)(12,"div",3),e.nrm(13,"ml-model-permissions"),e.k0s()(),e.j41(14,"mat-tab",7)(15,"div",3),e.nrm(16,"ml-group-permissions"),e.k0s()()()}},dependencies:[b.mq,b.T8,_e,Ce,Oe,je,Le],encapsulation:2})}}return n})();const _=n=>{const[S,t]=n.split("/");return`${S} / ${t}`},$e=[{path:`${a.USERS}`,component:T},{path:`${a.USER}/:id/experiments`,component:N,data:{breadcrumb:_}},{path:`${a.USER}/:id/models`,component:N,data:{breadcrumb:_}},{path:`${a.USER}/:id/prompts`,component:N,data:{breadcrumb:_}},{path:`${a.USER}/:id`,redirectTo:`${a.USER}/:id/experiments`},{path:`${a.EXPERIMENTS}`,component:T},{path:`${a.EXPERIMENT}/:id`,component:H,data:{breadcrumb:_}},{path:`${a.MODELS}`,component:T},{path:`${a.MODEL}/:id`,component:ee,data:{breadcrumb:_}},{path:`${a.PROMPTS}`,component:T},{path:`${a.PROMPT}/:id`,component:W,data:{breadcrumb:_}},{path:`${a.GROUPS}`,component:T},{path:`${a.GROUP}/:id/experiments`,component:A,data:{breadcrumb:_}},{path:`${a.GROUP}/:id/models`,component:A,data:{breadcrumb:_}},{path:`${a.GROUP}/:id`,pathMatch:"full",redirectTo:`${a.GROUP}/:id/experiments`},{path:`${a.GROUP}/:id/prompts`,component:A,data:{breadcrumb:_}},{path:"**",redirectTo:`${a.USERS}`}];let Ye=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[d.iI.forChild($e),d.iI]})}}return n})();var Ke=l(300);let He=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[P.MD,Ke.G,Ye,B.YN,d.iI]})}}return n})()}}]);