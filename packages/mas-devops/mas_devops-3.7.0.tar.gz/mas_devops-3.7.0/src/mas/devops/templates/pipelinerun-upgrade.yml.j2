---
apiVersion: tekton.dev/v1beta1
kind: PipelineRun
metadata:
  name: "{{ mas_instance_id }}-upgrade-{{ timestamp }}"
  labels:
    tekton.dev/pipeline: mas-upgrade
spec:
  pipelineRef:
    name: mas-upgrade

  serviceAccountName: "{{ service_account_name | default('pipeline', True) }}"
  timeouts:
    pipeline: "0"

  params:
    # Target MAS Instance
    # -------------------------------------------------------------------------
    - name: mas_instance_id
      value: "{{ mas_instance_id }}"
    - name: mas_channel
      value: "{{ mas_channel }}"

{%- if skip_pre_check is defined and skip_pre_check != "" %}
    # Skip pre-check
    # -------------------------------------------------------------------------
    - name: skip_pre_check
      value: "{{ skip_pre_check }}"
{%- endif %}
