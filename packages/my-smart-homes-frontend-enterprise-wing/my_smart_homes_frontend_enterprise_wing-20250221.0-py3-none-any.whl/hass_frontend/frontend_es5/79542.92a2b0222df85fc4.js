"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["79542"],{50875:function(t,e,i){i.d(e,{Eu:()=>a,hZ:()=>s});var n=i(11259);const o=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#9498a0","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#74787f","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#b6bac2","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function a(t){return o[t%o.length]}function s(t,e){const i=e.getPropertyValue(`--graph-color-${t+1}`)||a(t);return(0,n.Rq)(i)}},25179:function(t,e,i){i.a(t,(async function(t,n){try{i.d(e,{Q:()=>g});var o=i(73577),a=i(72621),s=(i(71695),i(92745),i(19423),i(40251),i(39527),i(41360),i(47021),i(57243)),d=i(50778),r=i(69634),c=i(18672),h=i(60738),l=i(36522),u=i(94134),v=(i(23334),i(62201)),f=i(30635),p=t([c]);c=(p.then?(await p)():p)[0];let k,m,_,b=t=>t;const y="M12,4C14.1,4 16.1,4.8 17.6,6.3C20.7,9.4 20.7,14.5 17.6,17.6C15.8,19.5 13.3,20.2 10.9,19.9L11.4,17.9C13.1,18.1 14.9,17.5 16.2,16.2C18.5,13.9 18.5,10.1 16.2,7.7C15.1,6.6 13.5,6 12,6V10.6L7,5.6L12,0.6V4M6.3,17.6C3.7,15 3.3,11 5.1,7.9L6.6,9.4C5.5,11.6 5.9,14.4 7.8,16.2C8.3,16.7 8.9,17.1 9.6,17.4L9,19.4C8,19 7.1,18.4 6.3,17.6Z",g=3e5;(0,o.Z)([(0,d.Mo)("ha-chart-base")],(function(t,e){class n extends e{constructor(...e){super(...e),t(this)}}return{F:n,d:[{kind:"field",key:"chart",value:void 0},{kind:"field",decorators:[(0,d.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,d.Cb)({attribute:!1})],key:"data",value(){return[]}},{kind:"field",decorators:[(0,d.Cb)({attribute:!1})],key:"options",value:void 0},{kind:"field",decorators:[(0,d.Cb)({type:String})],key:"height",value:void 0},{kind:"field",decorators:[(0,d.Cb)({attribute:"external-hidden",type:Boolean})],key:"externalHidden",value(){return!1}},{kind:"field",decorators:[(0,d.SB)(),(0,h.F_)({context:f.LW,subscribe:!0})],key:"_themes",value:void 0},{kind:"field",decorators:[(0,d.SB)()],key:"_isZoomed",value(){return!1}},{kind:"field",key:"_modifierPressed",value(){return!1}},{kind:"field",key:"_isTouchDevice",value(){return"ontouchstart"in window}},{kind:"field",key:"_resizeController",value(){return new c.Z(this,{callback:()=>{var t;return null===(t=this.chart)||void 0===t?void 0:t.resize()}})}},{kind:"field",key:"_loading",value(){return!1}},{kind:"field",key:"_reducedMotion",value(){return!1}},{kind:"field",key:"_listeners",value(){return[]}},{kind:"method",key:"disconnectedCallback",value:function(){var t;for((0,a.Z)(n,"disconnectedCallback",this,3)([]);this._listeners.length;)this._listeners.pop()();null===(t=this.chart)||void 0===t||t.dispose()}},{kind:"method",key:"connectedCallback",value:function(){(0,a.Z)(n,"connectedCallback",this,3)([]),this.hasUpdated&&this._setupChart(),this._listeners.push((0,v.K)("(prefers-reduced-motion)",(t=>{var e;this._reducedMotion=t,null===(e=this.chart)||void 0===e||e.setOption({animation:!this._reducedMotion})})));const t=t=>{var e,i;(u.V&&t.metaKey||!u.V&&t.ctrlKey)&&(this._modifierPressed=!0,null!==(e=this.options)&&void 0!==e&&e.dataZoom||null===(i=this.chart)||void 0===i||i.setOption({dataZoom:this._getDataZoomConfig()}))},e=t=>{var e,i;(u.V&&"Meta"===t.key||!u.V&&"Control"===t.key)&&(this._modifierPressed=!1,null!==(e=this.options)&&void 0!==e&&e.dataZoom||null===(i=this.chart)||void 0===i||i.setOption({dataZoom:this._getDataZoomConfig()}))};window.addEventListener("keydown",t),window.addEventListener("keyup",e),this._listeners.push((()=>window.removeEventListener("keydown",t)),(()=>window.removeEventListener("keyup",e)))}},{kind:"method",key:"firstUpdated",value:function(){this._setupChart()}},{kind:"method",key:"willUpdate",value:function(t){(0,a.Z)(n,"willUpdate",this,3)([t]),this.hasUpdated&&this.chart&&(t.has("_themes")?this._setupChart():(t.has("data")&&this.chart.setOption({series:this.data},{lazyUpdate:!0,replaceMerge:["series"]}),(t.has("options")||t.has("_isZoomed"))&&this.chart.setOption(this._createOptions(),{lazyUpdate:!0,replaceMerge:["xAxis","yAxis","dataZoom","dataset","tooltip","legend","grid","visualMap"]})))}},{kind:"method",key:"render",value:function(){var t;return(0,s.dy)(k||(k=b` <div class="chart-container" style="${0}" @wheel="${0}"> <div class="chart"></div> ${0} </div> `),(0,r.V)({height:null!==(t=this.height)&&void 0!==t?t:`${this._getDefaultHeight()}px`}),this._handleWheel,this._isZoomed?(0,s.dy)(m||(m=b`<ha-icon-button class="zoom-reset" .path="${0}" @click="${0}" title="${0}"></ha-icon-button>`),y,this._handleZoomReset,this.hass.localize("ui.components.history_charts.zoom_reset")):s.Ld)}},{kind:"method",key:"_setupChart",value:async function(){if(this._loading)return;const t=this.renderRoot.querySelector(".chart");this._loading=!0;try{this.chart&&this.chart.dispose();const e=(await Promise.all([i.e("79525"),i.e("58884"),i.e("42974")]).then(i.bind(i,85803))).default;this.chart=e.init(t,this._themes.darkMode?"dark":"light"),this.chart.on("legendselectchanged",(t=>{if(this.externalHidden){t.selected[t.name]?(0,l.B)(this,"dataset-unhidden",{name:t.name}):(0,l.B)(this,"dataset-hidden",{name:t.name})}})),this.chart.on("datazoom",(t=>{var e,i;const{start:n,end:o}=null!==(e=null===(i=t.batch)||void 0===i?void 0:i[0])&&void 0!==e?e:t;this._isZoomed=0!==n||100!==o})),this.chart.setOption(Object.assign(Object.assign({},this._createOptions()),{},{series:this.data}))}finally{this._loading=!1}}},{kind:"method",key:"_getDataZoomConfig",value:function(){var t,e,i,n,o,a;const s=null!==(t=null===(e=this.options)||void 0===e||null===(e=e.xAxis)||void 0===e?void 0:e[0])&&void 0!==t?t:null===(i=this.options)||void 0===i?void 0:i.xAxis,d=null!==(n=null===(o=this.options)||void 0===o||null===(o=o.yAxis)||void 0===o?void 0:o[0])&&void 0!==n?n:null===(a=this.options)||void 0===a?void 0:a.yAxis;if("value"!==s.type||"category"!==d.type)return{id:"dataZoom",type:"inside",orient:"horizontal",filterMode:"none",moveOnMouseMove:this._isZoomed,preventDefaultMouseMove:this._isZoomed,zoomLock:!this._isTouchDevice&&!this._modifierPressed}}},{kind:"method",key:"_createOptions",value:function(){var t,e;const i=null!==(t=this._themes.darkMode)&&void 0!==t&&t,n=Object.assign(Object.assign({backgroundColor:"transparent",animation:!this._reducedMotion,darkMode:i,aria:{show:!0},dataZoom:this._getDataZoomConfig()},this.options),{},{legend:null!==(e=this.options)&&void 0!==e&&e.legend?Object.assign({inactiveColor:i?"#444":"#ccc"},this.options.legend):void 0});if(window.matchMedia("all and (max-width: 450px), all and (max-height: 500px)").matches&&n.tooltip){const t=Array.isArray(n.tooltip)?n.tooltip:[n.tooltip];t.forEach((t=>{t.confine=!0,t.appendTo=void 0})),n.tooltip=t}return n}},{kind:"method",key:"_getDefaultHeight",value:function(){return Math.max(this.clientWidth/2,400)}},{kind:"method",key:"_handleZoomReset",value:function(){var t;null===(t=this.chart)||void 0===t||t.dispatchAction({type:"dataZoom",start:0,end:100})}},{kind:"method",key:"_handleWheel",value:function(t){var e;if(null===(e=this.options)||void 0===e||!e.dataZoom){const e=u.V&&t.metaKey||!u.V&&t.ctrlKey;var i;if(e&&t.preventDefault(),e!==this._modifierPressed)this._modifierPressed=e,null===(i=this.chart)||void 0===i||i.setOption({dataZoom:this._getDataZoomConfig()})}}},{kind:"field",static:!0,key:"styles",value(){return(0,s.iv)(_||(_=b`:host{display:block;position:relative}.chart-container{position:relative;max-height:var(--chart-max-height,400px)}.chart{width:100%;height:100%}.zoom-reset{position:absolute;top:16px;right:4px;background:var(--card-background-color);border-radius:4px;--mdc-icon-button-size:32px;color:var(--primary-color);border:1px solid var(--divider-color)}`))}}]}}),s.oi);n()}catch(k){n(k)}}))},6736:function(t,e,i){i.d(e,{f:()=>s});var n=i(73577),o=i(72621),a=(i(19083),i(71695),i(40251),i(61006),i(39527),i(36993),i(47021),i(50778));const s=t=>(0,n.Z)(null,(function(t,e){class i extends e{constructor(...e){super(...e),t(this)}}return{F:i,d:[{kind:"field",decorators:[(0,a.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:void 0},{kind:"field",key:"__unsubs",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,o.Z)(i,"connectedCallback",this,3)([]),this._checkSubscribed()}},{kind:"method",key:"disconnectedCallback",value:function(){if((0,o.Z)(i,"disconnectedCallback",this,3)([]),this.__unsubs){for(;this.__unsubs.length;){const t=this.__unsubs.pop();t instanceof Promise?t.then((t=>t())):t()}this.__unsubs=void 0}}},{kind:"method",key:"updated",value:function(t){if((0,o.Z)(i,"updated",this,3)([t]),t.has("hass"))this._checkSubscribed();else if(this.hassSubscribeRequiredHostProps)for(const e of t.keys())if(this.hassSubscribeRequiredHostProps.includes(e))return void this._checkSubscribed()}},{kind:"method",key:"hassSubscribe",value:function(){return[]}},{kind:"method",key:"_checkSubscribed",value:function(){var t;void 0!==this.__unsubs||!this.isConnected||void 0===this.hass||null!==(t=this.hassSubscribeRequiredHostProps)&&void 0!==t&&t.some((t=>void 0===this[t]))||(this.__unsubs=this.hassSubscribe())}}]}}),t)},18709:function(t,e,i){i.a(t,(async function(t,n){try{i.r(e),i.d(e,{HuiEnergyDevicesGraphCard:()=>g});var o=i(73577),a=(i(71695),i(92745),i(61893),i(40251),i(39527),i(67670),i(41360),i(47021),i(57243)),s=i(50778),d=i(35359),r=i(27486),c=i(50875),h=i(50602),l=i(25179),u=i(1118),v=i(17705),f=i(6736),p=i(93331),k=(i(54977),t([l,u,h]));[l,u,h]=k.then?(await k)():k;let m,_,b,y=t=>t,g=(0,o.Z)([(0,s.Mo)("hui-energy-devices-graph-card")],(function(t,e){return{F:class extends e{constructor(...e){super(...e),t(this)}},d:[{kind:"field",decorators:[(0,s.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,s.SB)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,s.SB)()],key:"_chartData",value(){return[]}},{kind:"field",decorators:[(0,s.SB)()],key:"_data",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value(){return["_config"]}},{kind:"method",key:"hassSubscribe",value:function(){var t;return[(0,u.UB)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe((t=>{this._data=t,this._getStatistics(t)}))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,p.SN)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"render",value:function(){var t,e;return this.hass&&this._config?(0,a.dy)(m||(m=y` <ha-card> ${0} <div class="content ${0}"> <ha-chart-base .hass="${0}" .data="${0}" .options="${0}" .height="${0}"></ha-chart-base> </div> </ha-card> `),this._config.title?(0,a.dy)(_||(_=y`<h1 class="card-header">${0}</h1>`),this._config.title):"",(0,d.$)({"has-header":!!this._config.title}),this.hass,this._chartData,this._createOptions(null===(t=this.hass.themes)||void 0===t?void 0:t.darkMode),28*((null===(e=this._chartData[0])||void 0===e||null===(e=e.data)||void 0===e?void 0:e.length)||0)+50+"px"):a.Ld}},{kind:"method",key:"_renderTooltip",value:function(t){const e=`<h4 style="text-align: center; margin: 0;">${this._getDeviceName(t.value[1])}</h4>`,i=`${(0,h.uf)(t.value[0],this.hass.locale,(0,h.l4)(void 0,this.hass.entities[t.value[1]]))} kWh`;return`${e}${t.marker} ${t.seriesName}: ${i}`}},{kind:"field",key:"_createOptions",value(){return(0,r.Z)((t=>({xAxis:{type:"value",name:"kWh",splitLine:{lineStyle:t?{opacity:.15}:{}}},yAxis:{type:"category",inverse:!0,axisLabel:{formatter:this._getDeviceName.bind(this),overflow:"truncate"}},grid:{top:5,left:5,right:40,bottom:0,containLabel:!0},tooltip:{show:!0,formatter:this._renderTooltip.bind(this)}})))}},{kind:"method",key:"_getDeviceName",value:function(t){var e,i;return(null===(e=this._data)||void 0===e||null===(e=e.prefs.device_consumption.find((e=>e.stat_consumption===t)))||void 0===e?void 0:e.name)||(0,v.Kd)(this.hass,t,null===(i=this._data)||void 0===i?void 0:i.statsMetadata[t])}},{kind:"method",key:"_getStatistics",value:async function(t){var e;const i=t.stats,n=t.statsCompare,o=[],a=[],s=[{type:"bar",name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.energy_usage"),itemStyle:{borderRadius:[0,4,4,0]},data:o,barWidth:n?10:20}];n&&s.push({type:"bar",name:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_graph.previous_energy_usage"),itemStyle:{borderRadius:[0,4,4,0]},data:a,barWidth:10});const d=getComputedStyle(this);t.prefs.device_consumption.forEach(((t,e)=>{const s=t.stat_consumption in i&&(0,v.Kj)(i[t.stat_consumption])||0,r=(0,c.hZ)(e,d);if(o.push({id:e,value:[s,t.stat_consumption],itemStyle:{color:r+"7F",borderColor:r}}),n){const i=t.stat_consumption in n&&(0,v.Kj)(n[t.stat_consumption])||0;a.push({id:e,value:[i,t.stat_consumption],itemStyle:{color:r+"32",borderColor:r+"7F"}})}})),o.sort(((t,e)=>e.value[0]-t.value[0])),o.length=(null===(e=this._config)||void 0===e?void 0:e.max_devices)||o.length,this._chartData=s,await this.updateComplete}},{kind:"field",static:!0,key:"styles",value(){return(0,a.iv)(b||(b=y`.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}ha-chart-base{--chart-max-height:none}`))}}]}}),(0,f.f)(a.oi));n()}catch(m){n(m)}}))},94134:function(t,e,i){i.d(e,{V:()=>n});i(19134),i(5740);const n=/Mac/i.test(navigator.userAgent)},32424:function(t,e,i){i.d(e,{E:()=>a});var n=i(53907),o=i(18112);function a(t,e,i){const a=(0,o.Q)(t,null==i?void 0:i.in);return isNaN(e)?(0,n.L)((null==i?void 0:i.in)||t,NaN):e?(a.setDate(a.getDate()+e),a):a}},38836:function(t,e,i){i.d(e,{T:()=>a});var n=i(23711),o=i(76808);function a(t,e,i){return(0,n.n)(t,e*o.vh,i)}},23711:function(t,e,i){i.d(e,{n:()=>a});var n=i(53907),o=i(18112);function a(t,e,i){return(0,n.L)((null==i?void 0:i.in)||t,+(0,o.Q)(t)+e)}},23459:function(t,e,i){i.d(e,{z:()=>a});var n=i(53907),o=i(18112);function a(t,e,i){const a=(0,o.Q)(t,null==i?void 0:i.in);if(isNaN(e))return(0,n.L)((null==i?void 0:i.in)||t,NaN);if(!e)return a;const s=a.getDate(),d=(0,n.L)((null==i?void 0:i.in)||t,a.getTime());d.setMonth(a.getMonth()+e+1,0);return s>=d.getDate()?d:(a.setFullYear(d.getFullYear(),d.getMonth(),s),a)}},14276:function(t,e,i){i.d(e,{_:()=>o});var n=i(18112);function o(t,e){return+(0,n.Q)(t)-+(0,n.Q)(e)}},71185:function(t,e,i){i.d(e,{d:()=>r});i(71695),i(47021);var n=i(18492),o=i(18112);function a(t,e){const i=+(0,o.Q)(t)-+(0,o.Q)(e);return i<0?-1:i>0?1:i}function s(t,e,i){const[o,a]=(0,n.d)(null==i?void 0:i.in,t,e);return 12*(o.getFullYear()-a.getFullYear())+(o.getMonth()-a.getMonth())}var d=i(3938);function r(t,e,i){const[o,r,c]=(0,n.d)(null==i?void 0:i.in,t,t,e),h=a(r,c),l=Math.abs(s(r,c));if(l<1)return 0;1===r.getMonth()&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-h*l);let u=a(r,c)===-h;(0,d.h)(o)&&1===l&&1===a(o,c)&&(u=!1);const v=h*(l-+u);return 0===v?0:v}},96500:function(t,e,i){i.d(e,{i:()=>o});var n=i(18112);function o(t,e){const i=(0,n.Q)(t,null==e?void 0:e.in);return i.setHours(23,59,59,999),i}},2621:function(t,e,i){i.d(e,{V:()=>o});var n=i(18112);function o(t,e){const i=(0,n.Q)(t,null==e?void 0:e.in),o=i.getMonth();return i.setFullYear(i.getFullYear(),o+1,0),i.setHours(23,59,59,999),i}},86319:function(t,e,i){i.d(e,{b:()=>o});var n=i(18112);function o(t,e){return 1===(0,n.Q)(t,null==e?void 0:e.in).getDate()}},3938:function(t,e,i){i.d(e,{h:()=>s});var n=i(96500),o=i(2621),a=i(18112);function s(t,e){const i=(0,a.Q)(t,null==e?void 0:e.in);return+(0,n.i)(i,e)==+(0,o.V)(i,e)}}}]);
//# sourceMappingURL=79542.92a2b0222df85fc4.js.map