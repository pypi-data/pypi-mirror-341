"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["48240"],{50875:function(t,e,i){i.d(e,{Eu:()=>s,hZ:()=>r});var o=i(11259);const n=["#4269d0","#f4bd4a","#ff725c","#6cc5b0","#a463f2","#ff8ab7","#9c6b4e","#97bbf5","#01ab63","#9498a0","#094bad","#c99000","#d84f3e","#49a28f","#048732","#d96895","#8043ce","#7599d1","#7a4c31","#74787f","#6989f4","#ffd444","#ff957c","#8fe9d3","#62cc71","#ffadda","#c884ff","#badeff","#bf8b6d","#b6bac2","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function s(t){return n[t%n.length]}function r(t,e){const i=e.getPropertyValue(`--graph-color-${t+1}`)||s(t);return(0,o.Rq)(i)}},74564:function(t,e,i){i.d(e,{Z:()=>n});i(52247),i(95078),i(19134),i(97499),i(97003);const o=t=>{const e=parseFloat(t);if(isNaN(e))throw new Error(`${t} is not a number`);return e};function n(t){if(!t)return null;try{if(t.endsWith("%"))return{w:100,h:o(t.substr(0,t.length-1))};const e=t.replace(":","x").split("x");return 0===e.length?null:1===e.length?{w:o(e[0]),h:1}:{w:o(e[0]),h:o(e[1])}}catch(e){}return null}},11823:function(t,e,i){i.a(t,(async function(t,o){try{i.r(e),i.d(e,{DEFAULT_HOURS_TO_SHOW:()=>M,DEFAULT_ZOOM:()=>$});var n=i(73577),s=i(72621),r=(i(52247),i(71695),i(92745),i(49278),i(19423),i(40251),i(39527),i(67670),i(13334),i(47021),i(57243)),a=i(50778),d=i(27486),c=i(50875),u=i(72344),l=i(73850),h=i(47194),f=i(48045),_=i(74564),v=(i(99426),i(54977),i(23334),i(65986)),g=i(6280),b=i(69223),m=i(93331),y=i(29401),k=t([v,g]);[v,g]=k.then?(await k)():k;let p,w,E,H=t=>t;const x="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M19,19H15V21H19A2,2 0 0,0 21,19V15H19M19,3H15V5H19V9H21V5A2,2 0 0,0 19,3M5,5H9V3H5A2,2 0 0,0 3,5V9H5M5,15H3V19A2,2 0 0,0 5,21H9V19H5V15Z",M=0,$=14;(0,n.Z)([(0,a.Mo)("hui-map-card")],(function(t,e){class o extends e{constructor(...e){super(...e),t(this)}}return{F:o,d:[{kind:"field",decorators:[(0,a.Cb)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,a.Cb)({attribute:!1})],key:"layout",value:void 0},{kind:"field",decorators:[(0,a.SB)()],key:"_stateHistory",value:void 0},{kind:"field",decorators:[(0,a.SB)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,a.IO)("ha-map")],key:"_map",value:void 0},{kind:"field",key:"_configEntities",value:void 0},{kind:"field",decorators:[(0,a.SB)()],key:"_mapEntities",value(){return[]}},{kind:"field",key:"_colorDict",value(){return{}}},{kind:"field",key:"_colorIndex",value(){return 0}},{kind:"field",decorators:[(0,a.SB)()],key:"_error",value:void 0},{kind:"field",key:"_subscribed",value:void 0},{kind:"method",key:"setConfig",value:function(t){var e;if(!t)throw new Error("Error in card configuration.");if(!(null!==(e=t.entities)&&void 0!==e&&e.length||t.geo_location_sources))throw new Error("Either entities or geo_location_sources must be specified");if(t.entities&&!Array.isArray(t.entities))throw new Error("Entities need to be an array");if(t.geo_location_sources&&!Array.isArray(t.geo_location_sources))throw new Error("Parameter geo_location_sources needs to be an array");this._config=t,this._configEntities=t.entities?(0,y.A)(t.entities):[],this._mapEntities=this._getMapEntities()}},{kind:"method",key:"getCardSize",value:function(){var t;if(null===(t=this._config)||void 0===t||!t.aspect_ratio)return 7;const e=(0,_.Z)(this._config.aspect_ratio),i=e&&e.w>0&&e.h>0?`${(100*e.h/e.w).toFixed(2)}`:"100";return 1+Math.floor(Number(i)/25)||3}},{kind:"method",static:!0,key:"getConfigElement",value:async function(){return await Promise.all([i.e("46379"),i.e("24199"),i.e("78943"),i.e("41258"),i.e("7010"),i.e("62524"),i.e("67390"),i.e("3049"),i.e("47818"),i.e("98815")]).then(i.bind(i,96216)),document.createElement("hui-map-card-editor")}},{kind:"method",static:!0,key:"getStubConfig",value:function(t,e,i){return{type:"map",entities:(0,b.j)(t,2,e,i,["device_tracker"]),theme_mode:"auto"}}},{kind:"method",key:"render",value:function(){var t;if(!this._config)return r.Ld;if(this._error)return(0,r.dy)(p||(p=H`<ha-alert alert-type="error"> ${0}: ${0} (${0}) </ha-alert>`),this.hass.localize("ui.components.map.error"),this._error.message,this._error.code);const e=!(!this._config.dark_mode&&"dark"!==this._config.theme_mode)||"light"!==this._config.theme_mode&&this.hass.themes.darkMode,i=this._config.theme_mode||(this._config.dark_mode?"dark":"auto");return(0,r.dy)(w||(w=H` <ha-card id="card" .header="${0}"> <div id="root"> <ha-map .hass="${0}" .entities="${0}" .zoom="${0}" .paths="${0}" .autoFit="${0}" .fitZones="${0}" .themeMode="${0}" interactive-zones render-passive></ha-map> <ha-icon-button .label="${0}" .path="${0}" style="${0}" @click="${0}" tabindex="0"></ha-icon-button> </div> </ha-card> `),this._config.title,this.hass,this._mapEntities,null!==(t=this._config.default_zoom)&&void 0!==t?t:$,this._getHistoryPaths(this._config,this._stateHistory),this._config.auto_fit||!1,this._config.fit_zones,i,this.hass.localize("ui.panel.lovelace.cards.map.reset_focus"),x,e?"color:#ffffff":"color:#000000",this._fitMap)}},{kind:"method",key:"shouldUpdate",value:function(t){var e,i;if(!t.has("hass")||t.size>1)return!0;const o=t.get("hass");return!o||!this._configEntities||(o.themes.darkMode!==this.hass.themes.darkMode||(!!t.has("_stateHistory")||(!(null===(e=this._config)||void 0===e||!e.geo_location_sources||o.states===this.hass.states)||(null!==(i=this._config)&&void 0!==i&&i.entities?(0,m.Wh)(this,t):(0,m.SN)(this,t)))))}},{kind:"method",key:"willUpdate",value:function(t){var e,i;(0,s.Z)(o,"willUpdate",this,3)([t]),t.has("hass")&&null!==(e=this._config)&&void 0!==e&&e.geo_location_sources&&!(0,f.v)(this._getSourceEntities(null===(i=t.get("hass"))||void 0===i?void 0:i.states),this._getSourceEntities(this.hass.states))&&(this._mapEntities=this._getMapEntities())}},{kind:"method",key:"connectedCallback",value:function(){var t;(0,s.Z)(o,"connectedCallback",this,3)([]),this.hasUpdated&&null!==(t=this._configEntities)&&void 0!==t&&t.length&&this._subscribeHistory()}},{kind:"method",key:"disconnectedCallback",value:function(){(0,s.Z)(o,"disconnectedCallback",this,3)([]),this._unsubscribeHistory()}},{kind:"method",key:"_subscribeHistory",value:function(){var t,e,i;(0,u.p)(this.hass,"history")&&!this._subscribed&&(null!==(t=null===(e=this._config)||void 0===e?void 0:e.hours_to_show)&&void 0!==t?t:M)&&(this._subscribed=(0,g.xS)(this.hass,(t=>{this._subscribed&&(this._stateHistory=t)}),null!==(i=this._config.hours_to_show)&&void 0!==i?i:M,(this._configEntities||[]).map((t=>t.entity)),!1,!1,!1).catch((t=>{this._subscribed=void 0,this._error=t})))}},{kind:"method",key:"_unsubscribeHistory",value:function(){this._subscribed&&(this._subscribed.then((t=>null==t?void 0:t())),this._subscribed=void 0)}},{kind:"method",key:"updated",value:function(t){var e;null!==(e=this._configEntities)&&void 0!==e&&e.length?this._subscribed&&!t.has("_config")||(this._unsubscribeHistory(),this._subscribeHistory()):this._unsubscribeHistory(),t.has("_config")&&this._computePadding()}},{kind:"method",key:"_computePadding",value:function(){const t=this.shadowRoot.getElementById("root"),e="panel"===this.layout||"grid"===this.layout;if(!this._config||e||!t)return;if(!this._config.aspect_ratio)return void(t.style.paddingBottom="100%");t.style.height="auto";const i=(0,_.Z)(this._config.aspect_ratio);t.style.paddingBottom=i&&i.w>0&&i.h>0?`${(100*i.h/i.w).toFixed(2)}%`:t.style.paddingBottom="100%"}},{kind:"method",key:"_fitMap",value:function(){var t;null===(t=this._map)||void 0===t||t.fitMap()}},{kind:"method",key:"_getColor",value:function(t){let e=this._colorDict[t];return e||(e=(0,c.Eu)(this._colorIndex),this._colorIndex++,this._colorDict[t]=e,e)}},{kind:"method",key:"_getSourceEntities",value:function(t){var e;if(!t||null===(e=this._config)||void 0===e||!e.geo_location_sources)return[];const i=this._config.geo_location_sources.map((t=>"string"==typeof t?{source:t}:t)),o=[],n=i.find((t=>"all"===t.source));for(const d of Object.values(t)){const t=i.find((t=>t.source===d.attributes.source));var s,r,a;if("geo_location"===(0,l.M)(d.entity_id)&&(n||t))o.push({entity_id:d.entity_id,label_mode:null!==(s=null==t?void 0:t.label_mode)&&void 0!==s?s:null==n?void 0:n.label_mode,focus:t?null===(r=t.focus)||void 0===r||r:null===(a=null==n?void 0:n.focus)||void 0===a||a})}return o}},{kind:"method",key:"_getMapEntities",value:function(){var t;return[...(this._configEntities||[]).map((t=>({entity_id:t.entity,color:this._getColor(t.entity),label_mode:t.label_mode,focus:t.focus,name:t.name}))),...this._getSourceEntities(null===(t=this.hass)||void 0===t?void 0:t.states).map((t=>Object.assign(Object.assign({},t),{},{color:this._getColor(t.entity_id)})))]}},{kind:"field",key:"_getHistoryPaths",value(){return(0,d.Z)(((t,e)=>{var i;if(!e||!(null!==(i=t.hours_to_show)&&void 0!==i?i:M))return;const o=[];for(const a of Object.keys(e)){var n,s,r;if("zone"===(0,l.M)(a))continue;const i=e[a];if(null==i||!i.length)continue;const d=[];for(const t of i){const e=t.a.latitude,i=t.a.longitude;if(!e||!i)continue;const o={};o.point=[e,i],o.timestamp=new Date(1e3*t.lu),d.push(o)}const c=null===(n=this._configEntities)||void 0===n?void 0:n.find((t=>t.entity===a)),u=null!==(s=null==c?void 0:c.name)&&void 0!==s?s:a in this.hass.states?(0,h.C)(this.hass.states[a]):a;o.push({points:d,name:u,fullDatetime:(null!==(r=t.hours_to_show)&&void 0!==r?r:M)>144,color:this._getColor(a),gradualOpacity:.8})}return o}))}},{kind:"method",key:"getGridOptions",value:function(){return{columns:"full",rows:4,min_columns:6,min_rows:2}}},{kind:"field",static:!0,key:"styles",value(){return(0,r.iv)(E||(E=H`ha-card{overflow:hidden;width:100%;height:100%;display:flex;flex-direction:column}ha-map{z-index:0;border:none;position:absolute;top:0;left:0;width:100%;height:100%;background:inherit;border-radius:var(--ha-card-border-radius,12px);overflow:hidden}ha-icon-button{position:absolute;top:75px;left:3px;outline:0}#root{position:relative;height:100%}`))}}]}}),r.oi);o()}catch(p){o(p)}}))},86256:function(t,e,i){var o=i(88045),n=i(72616),s=i(95011),r=RangeError;t.exports=function(t){var e=n(s(this)),i="",a=o(t);if(a<0||a===1/0)throw new r("Wrong number of repetitions");for(;a>0;(a>>>=1)&&(e+=e))1&a&&(i+=e);return i}},35638:function(t,e,i){var o=i(72878);t.exports=o(1..valueOf)},49278:function(t,e,i){var o=i(40810),n=i(72878),s=i(88045),r=i(35638),a=i(86256),d=i(29660),c=RangeError,u=String,l=Math.floor,h=n(a),f=n("".slice),_=n(1..toFixed),v=function(t,e,i){return 0===e?i:e%2==1?v(t,e-1,i*t):v(t*t,e/2,i)},g=function(t,e,i){for(var o=-1,n=i;++o<6;)n+=e*t[o],t[o]=n%1e7,n=l(n/1e7)},b=function(t,e){for(var i=6,o=0;--i>=0;)o+=t[i],t[i]=l(o/e),o=o%e*1e7},m=function(t){for(var e=6,i="";--e>=0;)if(""!==i||0===e||0!==t[e]){var o=u(t[e]);i=""===i?o:i+h("0",7-o.length)+o}return i};o({target:"Number",proto:!0,forced:d((function(){return"0.000"!==_(8e-5,3)||"1"!==_(.9,0)||"1.25"!==_(1.255,2)||"1000000000000000128"!==_(0xde0b6b3a7640080,0)}))||!d((function(){_({})}))},{toFixed:function(t){var e,i,o,n,a=r(this),d=s(t),l=[0,0,0,0,0,0],_="",y="0";if(d<0||d>20)throw new c("Incorrect fraction digits");if(a!=a)return"NaN";if(a<=-1e21||a>=1e21)return u(a);if(a<0&&(_="-",a=-a),a>1e-21)if(i=(e=function(t){for(var e=0,i=t;i>=4096;)e+=12,i/=4096;for(;i>=2;)e+=1,i/=2;return e}(a*v(2,69,1))-69)<0?a*v(2,-e,1):a/v(2,e,1),i*=4503599627370496,(e=52-e)>0){for(g(l,0,i),o=d;o>=7;)g(l,1e7,0),o-=7;for(g(l,v(10,o,1),0),o=e-1;o>=23;)b(l,1<<23),o-=23;b(l,1<<o),g(l,1,1),b(l,2),y=m(l)}else g(l,0,i),g(l,1<<-e,0),y=m(l)+h("0",d);return y=d>0?_+((n=y.length)<=d?"0."+h("0",d-n)+y:f(y,0,n-d)+"."+f(y,n-d)):_+y}})},41924:function(t,e,i){i.d(e,{y:()=>n});var o=i(53907);function n(t){return(0,o.L)(t,Date.now())}},97836:function(t,e,i){i.d(e,{K:()=>s});i(71695),i(47021);var o=i(18492),n=i(7591);function s(t,e,i){const[s,r]=(0,o.d)(null==i?void 0:i.in,t,e);return+(0,n.b)(s)==+(0,n.b)(r)}},16444:function(t,e,i){i.d(e,{z:()=>r});var o=i(53907),n=i(41924),s=i(97836);function r(t,e){return(0,s.K)((0,o.L)((null==e?void 0:e.in)||t,t),(0,n.y)((null==e?void 0:e.in)||t))}}}]);
//# sourceMappingURL=48240.5f023417bb600c77.js.map