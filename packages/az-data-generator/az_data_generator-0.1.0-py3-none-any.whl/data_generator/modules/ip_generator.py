"""
IP address generator module
"""
import random
import ipaddress
from typing import Dict, Any, List


class IpGenerator:
    """
    IP address data generator
    """

    def __init__(self):
        """
        Initialize IP generator
        """
        self.az_ip_ranges = [
            ("103.119.111.0", "103.119.111.255"),
            ("104.250.177.0", "104.250.177.255"),
            ("109.122.221.0", "109.122.221.255"),
            ("109.127.0.0", "109.127.63.255"),
            ("109.196.108.0", "109.196.108.255"),
            ("109.205.160.0", "109.205.167.255"),
            ("109.205.208.0", "109.205.209.255"),
            ("109.235.192.0", "109.235.199.255"),
            ("109.237.112.0", "109.237.127.255"),
            ("109.239.16.0", "109.239.31.255"),
            ("109.61.34.0", "109.61.34.255"),
            ("130.0.8.0", "130.0.15.255"),
            ("130.193.74.0", "130.193.74.255"),
            ("131.117.128.0", "131.117.143.255"),
            ("134.19.208.0", "134.19.223.255"),
            ("149.126.112.0", "149.126.127.255"),
            ("149.255.144.0", "149.255.159.255"),
            ("154.204.112.0", "154.204.112.255"),
            ("154.91.2.0", "154.91.2.255"),
            ("156.246.197.0", "156.246.200.255"),
            ("157.167.76.0", "157.167.76.255"),
            ("158.181.32.0", "158.181.47.255"),
            ("160.202.24.0", "160.202.27.255"),
            ("164.63.244.0", "164.63.245.255"),
            ("166.1.63.0", "166.1.63.255"),
            ("172.68.30.0", "172.68.30.255"),
            ("172.68.75.0", "172.68.75.255"),
            ("172.71.12.0", "172.71.12.255"),
            ("172.71.17.0", "172.71.17.255"),
            ("176.28.80.0", "176.28.87.255"),
            ("178.171.46.0", "178.171.47.255"),
            ("178.237.64.0", "178.237.79.255"),
            ("178.76.0.0", "178.76.63.255"),
            ("180.149.44.0", "180.149.45.255"),
            ("185.105.196.0", "185.105.199.255"),
            ("185.112.192.0", "185.112.195.255"),
            ("185.118.48.0", "185.118.51.255"),
            ("185.12.16.0", "185.12.19.255"),
            ("185.129.0.0", "185.129.3.255"),
            ("185.129.92.0", "185.129.92.255"),
            ("185.136.207.0", "185.136.207.255"),
            ("185.138.12.0", "185.138.15.255"),
            ("185.143.196.0", "185.143.199.255"),
            ("185.146.112.0", "185.146.115.255"),
            ("185.147.24.0", "185.147.24.255"),
            ("185.156.74.0", "185.156.74.255"),
            ("185.161.224.0", "185.161.227.255"),
            ("185.18.244.0", "185.18.247.255"),
            ("185.188.144.0", "185.188.144.255"),
            ("185.193.132.0", "185.193.135.255"),
            ("185.220.180.0", "185.220.183.255"),
            ("185.222.92.0", "185.222.95.255"),
            ("185.230.199.0", "185.230.199.255"),
            ("185.233.180.0", "185.233.183.255"),
            ("185.233.35.0", "185.233.35.255"),
            ("185.26.184.0", "185.26.187.255"),
            ("185.30.88.0", "185.30.91.255"),
            ("185.32.44.0", "185.32.47.255"),
            ("185.34.72.0", "185.34.75.255"),
            ("185.36.200.0", "185.36.203.255"),
            ("185.40.156.0", "185.40.159.255"),
            ("185.40.176.0", "185.40.179.255"),
            ("185.40.32.0", "185.40.35.255"),
            ("185.41.200.0", "185.41.203.255"),
            ("185.43.188.0", "185.43.191.255"),
            ("185.47.4.0", "185.47.7.255"),
            ("185.52.128.0", "185.52.131.255"),
            ("185.55.36.0", "185.55.39.255"),
            ("185.77.248.0", "185.77.248.255"),
            ("185.77.3.0", "185.77.3.255"),
            ("185.80.172.0", "185.80.175.255"),
            ("185.81.217.0", "185.81.217.255"),
            ("185.81.80.0", "185.81.87.255"),
            ("185.83.124.0", "185.83.127.255"),
            ("185.91.208.0", "185.91.211.255"),
            ("185.92.224.0", "185.92.227.255"),
            ("185.93.90.0", "185.93.91.255"),
            ("185.96.124.0", "185.96.127.255"),
            ("188.227.208.0", "188.227.223.255"),
            ("188.253.128.0", "188.253.255.255"),
            ("188.64.8.0", "188.64.11.255"),
            ("188.65.162.0", "188.65.162.255"),
            ("188.72.128.0", "188.72.191.255"),
            ("193.105.123.0", "193.105.123.255"),
            ("193.143.231.0", "193.143.231.255"),
            ("193.178.203.0", "193.178.203.255"),
            ("193.41.128.0", "193.41.128.255"),
            ("193.42.156.0", "193.42.156.255"),
            ("193.5.1.0", "193.5.1.255"),
            ("193.8.62.0", "193.8.63.255"),
            ("193.8.72.0", "193.8.73.255"),
            ("194.135.152.0", "194.135.191.255"),
            ("194.164.222.0", "194.164.222.255"),
            ("194.164.224.0", "194.164.224.255"),
            ("194.39.184.0", "194.39.184.255"),
            ("194.39.243.0", "194.39.243.255"),
            ("194.61.76.0", "194.61.76.255"),
            ("195.216.230.0", "195.216.230.255"),
            ("195.26.8.0", "195.26.9.255"),
            ("195.28.6.0", "195.28.7.255"),
            ("198.145.224.0", "198.145.224.255"),
            ("205.164.112.0", "205.164.119.255"),
            ("208.210.122.0", "208.210.122.255"),
            ("208.220.224.0", "208.220.231.255"),
            ("209.182.103.0", "209.182.103.255"),
            ("212.102.123.0", "212.102.123.255"),
            ("212.47.128.0", "212.47.159.255"),
            ("213.142.158.0", "213.142.158.255"),
            ("213.154.0.0", "213.154.31.255"),
            ("213.172.64.0", "213.172.95.255"),
            ("213.238.170.0", "213.238.170.255"),
            ("216.128.12.0", "216.128.12.255"),
            ("217.14.96.0", "217.14.111.255"),
            ("217.168.176.0", "217.168.191.255"),
            ("217.18.88.0", "217.18.88.255"),
            ("217.25.16.0", "217.25.31.255"),
            ("217.64.16.0", "217.64.31.255"),
            ("23.27.110.0", "23.27.110.255"),
            ("31.170.224.0", "31.171.127.255"),
            ("31.222.225.0", "31.222.225.255"),
            ("31.43.191.0", "31.43.191.255"),
            ("37.114.128.0", "37.114.191.255"),
            ("37.18.58.0", "37.18.58.255"),
            ("37.26.0.0", "37.26.63.255"),
            ("37.32.64.0", "37.32.72.255"),
            ("37.32.74.0", "37.32.79.255"),
            ("37.61.0.0", "37.61.127.255"),
            ("38.158.246.0", "38.158.246.255"),
            ("38.252.96.0", "38.252.103.255"),
            ("38.44.24.0", "38.44.31.255"),
            ("38.87.65.0", "38.87.65.255"),
            ("45.128.51.0", "45.128.51.255"),
            ("45.128.54.0", "45.128.56.255"),
            ("45.136.164.0", "45.136.167.255"),
            ("45.137.79.0", "45.137.79.255"),
            ("45.145.163.0", "45.145.163.255"),
            ("45.145.21.0", "45.145.23.255"),
            ("45.15.43.0", "45.15.43.255"),
            ("45.156.112.0", "45.156.112.255"),
            ("45.159.12.0", "45.159.12.255"),
            ("45.198.202.0", "45.198.202.255"),
            ("45.39.203.0", "45.39.203.255"),
            ("45.83.124.0", "45.83.124.255"),
            ("45.89.200.0", "45.89.200.255"),
            ("46.18.64.0", "46.18.71.255"),
            ("46.22.224.0", "46.22.239.255"),
            ("46.228.176.0", "46.228.191.255"),
            ("46.23.100.0", "46.23.103.255"),
            ("46.23.97.0", "46.23.97.255"),
            ("46.28.237.0", "46.28.237.255"),
            ("46.32.160.0", "46.32.179.255"),
            ("46.32.188.0", "46.32.191.255"),
            ("46.8.66.0", "46.8.66.255"),
            ("5.133.224.0", "5.133.239.255"),
            ("5.134.48.0", "5.134.63.255"),
            ("5.178.8.0", "5.178.15.255"),
            ("5.182.184.0", "5.182.184.255"),
            ("5.191.0.0", "5.191.255.255"),
            ("5.197.0.0", "5.197.255.255"),
            ("5.250.192.0", "5.250.223.255"),
            ("5.252.27.0", "5.252.27.255"),
            ("5.252.48.0", "5.252.51.255"),
            ("5.44.32.0", "5.44.39.255"),
            ("57.90.148.0", "57.90.149.255"),
            ("62.164.144.0", "62.164.144.255"),
            ("62.212.224.0", "62.212.255.255"),
            ("62.217.128.0", "62.217.159.255"),
            ("77.244.112.0", "77.244.127.255"),
            ("77.81.248.0", "77.81.255.255"),
            ("77.81.56.0", "77.81.63.255"),
            ("78.109.48.0", "78.109.55.255"),
            ("78.111.48.0", "78.111.63.255"),
            ("80.69.48.0", "80.69.63.255"),
            ("81.17.80.0", "81.17.95.255"),
            ("81.21.80.0", "81.21.95.255"),
            ("81.30.97.0", "81.30.97.255"),
            ("82.194.0.0", "82.194.31.255"),
            ("85.132.0.0", "85.132.127.255"),
            ("85.158.144.0", "85.158.144.255"),
            ("87.248.155.0", "87.248.155.255"),
            ("88.151.193.0", "88.151.193.255"),
            ("88.151.199.0", "88.151.199.255"),
            ("89.147.192.0", "89.147.255.255"),
            ("89.219.132.0", "89.219.133.255"),
            ("89.219.155.0", "89.219.160.255"),
            ("89.219.163.0", "89.219.167.255"),
            ("89.219.169.0", "89.219.191.255"),
            ("89.219.36.0", "89.219.63.255"),
            ("89.23.124.0", "89.23.124.255"),
            ("89.37.16.0", "89.37.23.255"),
            ("89.37.32.0", "89.37.39.255"),
            ("89.40.30.0", "89.40.30.255"),
            ("89.41.0.0", "89.41.7.255"),
            ("91.103.137.0", "91.103.137.255"),
            ("91.108.20.0", "91.108.23.255"),
            ("91.132.192.0", "91.132.195.255"),
            ("91.135.240.0", "91.135.255.255"),
            ("91.191.192.0", "91.191.207.255"),
            ("91.201.200.0", "91.201.200.255"),
            ("91.209.225.0", "91.209.225.255"),
            ("91.216.134.0", "91.216.134.255"),
            ("91.218.56.0", "91.218.56.255"),
            ("91.220.216.0", "91.220.216.255"),
            ("91.220.90.0", "91.220.90.255"),
            ("91.234.235.0", "91.234.235.255"),
            ("91.242.0.0", "91.242.31.255"),
            ("92.119.58.0", "92.119.58.255"),
            ("92.223.62.0", "92.223.62.255"),
            ("92.39.80.0", "92.39.95.255"),
            ("93.114.130.0", "93.114.130.255"),
            ("93.184.224.0", "93.184.239.255"),
            ("93.88.80.0", "93.88.95.255"),
            ("94.158.191.0", "94.158.191.255"),
            ("94.20.0.0", "94.20.255.255"),
            ("95.210.179.0", "95.210.179.255"),
            ("95.210.236.0", "95.210.236.255"),
            ("95.86.128.0", "95.86.191.255")
        ]

    def generate_azerbaijan_ip(self) -> str:
        """
        Generate a random IP address from Azerbaijan IP ranges

        Returns:
            str: A valid Azerbaijani IP address
        """
        start_ip, end_ip = random.choice(self.az_ip_ranges)

        start_int = int(ipaddress.IPv4Address(start_ip))
        end_int = int(ipaddress.IPv4Address(end_ip))

        random_ip_int = random.randint(start_int, end_int)
        random_ip = str(ipaddress.IPv4Address(random_ip_int))

        return random_ip

    def generate_multiple_ips(self, count: int = 1) -> List[str]:
        """
        Generate multiple random Azerbaijani IP addresses

        Args:
            count: Number of IP addresses to generate

        Returns:
            list: List of generated IP addresses
        """
        return [self.generate_azerbaijan_ip() for _ in range(count)]

    def generate(self, **kwargs) -> Dict[str, Any]:
        """
        Generate IP address data

        Returns:
            dict: Generated IP data
        """
        ip = self.generate_azerbaijan_ip()

        ip_obj = ipaddress.IPv4Address(ip)
        network = ipaddress.IPv4Network(f"{ip}/24", strict=False)

        result = {
            "ip": ip,
            "network": str(network),
            "is_private": ip_obj.is_private,
            "is_global": ip_obj.is_global,
            "subnet_mask": str(network.netmask)
        }

        return result