#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Wed Oct  2 23:51:26 2019

@author: clemens
"""

import unittest

import meteolib as m

import pandas as pd

# example data
json = {
    "2019-09-22T00:00:00.000Z": {"AirTC": 11.37, "rh": 58.0475004916,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 7.4},
    "2019-09-22T00:10:00.000Z": {"AirTC": 11.26, "rh": 58.8433368215,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 8.58},
    "2019-09-22T00:20:00.000Z": {"AirTC": 11.21, "rh": 59.0592545335,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 8.36},
    "2019-09-22T00:30:00.000Z": {"AirTC": 11.12, "rh": 59.5841399757,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 8.28},
    "2019-09-22T00:40:00.000Z": {"AirTC": 11.08, "rh": 59.902273819,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 8.86},
    "2019-09-22T00:50:00.000Z": {"AirTC": 10.96, "rh": 60.2917974378,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 8.8},
    "2019-09-22T01:00:00.000Z": {"AirTC": 10.87, "rh": 61.0768717636,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 8.52},
    "2019-09-22T01:10:00.000Z": {"AirTC": 10.75, "rh": 61.6696951063,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 8.59},
    "2019-09-22T01:20:00.000Z": {"AirTC": 10.69, "rh": 62.0076382625,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 8.66},
    "2019-09-22T01:30:00.000Z": {"AirTC": 10.68, "rh": 62.341666675,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 8.57},
    "2019-09-22T01:40:00.000Z": {"AirTC": 10.58, "rh": 62.6961180514,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 8.78},
    "2019-09-22T01:50:00.000Z": {"AirTC": 10.42, "rh": 63.7695167199,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 8.8},
    "2019-09-22T02:00:00.000Z": {"AirTC": 10.43, "rh": 64.0498496634,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 9.73},
    "2019-09-22T02:10:00.000Z": {"AirTC": 10.37, "rh": 64.3877522258,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 8.26},
    "2019-09-22T02:20:00.000Z": {"AirTC": 10.21, "rh": 65.183734451,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 8.85},
    "2019-09-22T02:30:00.000Z": {"AirTC": 10.23, "rh": 65.3987176439,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 10.02},
    "2019-09-22T02:40:00.000Z": {"AirTC": 10.25, "rh": 65.2199838379,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 8.96},
    "2019-09-22T02:50:00.000Z": {"AirTC": 10.11, "rh": 66.0034341207,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 8.55},
    "2019-09-22T03:00:00.000Z": {"AirTC": 10.05, "rh": 66.5897411897,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 8.76},
    "2019-09-22T03:10:00.000Z": {"AirTC": 9.91, "rh": 67.2396294104,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 8.82},
    "2019-09-22T03:20:00.000Z": {"AirTC": 9.81, "rh": 68.0190656648,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 9.67},
    "2019-09-22T03:30:00.000Z": {"AirTC": 9.79, "rh": 68.2247465654,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 9.12},
    "2019-09-22T03:40:00.000Z": {"AirTC": 9.7, "rh": 68.6709959459,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 8.66},
    "2019-09-22T03:50:00.000Z": {"AirTC": 9.48, "rh": 69.8970287981,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 8.44},
    "2019-09-22T04:00:00.000Z": {"AirTC": 9.31, "rh": 70.7097869176,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 9.07},
    "2019-09-22T04:10:00.000Z": {"AirTC": 9.24, "rh": 71.3172557665,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 8.99},
    "2019-09-22T04:20:00.000Z": {"AirTC": 9.15, "rh": 71.7504606031,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 8.85},
    "2019-09-22T04:30:00.000Z": {"AirTC": 9.17, "rh": 72.1313762524,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 9.39},
    "2019-09-22T04:40:00.000Z": {"AirTC": 9.27, "rh": 71.7629746126,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 9.54},
    "2019-09-22T04:50:00.000Z": {"AirTC": 9.1, "rh": 72.3809871076,
                                 "WS": 0.0, "BP": 980.0, "SWdn": 8.88},
    "2019-09-22T05:00:00.000Z": {"AirTC": 9.07, "rh": 72.5983688997,
                                 "WS": 0.0, "BP": 980.0, "SWdn": 9.69},
    "2019-09-22T05:10:00.000Z": {"AirTC": 9.04, "rh": 72.9131570601,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 9.93},
    "2019-09-22T05:20:00.000Z": {"AirTC": 8.99, "rh": 73.5794018278,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 11.59},
    "2019-09-22T05:30:00.000Z": {"AirTC": 9.03, "rh": 73.5146459353,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 15.27},
    "2019-09-22T05:40:00.000Z": {"AirTC": 8.93, "rh": 74.0686788399,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 19.97},
    "2019-09-22T05:50:00.000Z": {"AirTC": 8.86, "rh": 74.8305487747,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 26.61},
    "2019-09-22T06:00:00.000Z": {"AirTC": 8.89, "rh": 75.7380393662,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 34.25},
    "2019-09-22T06:10:00.000Z": {"AirTC": 9.09, "rh": 75.3874115948,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 43.31},
    "2019-09-22T06:20:00.000Z": {"AirTC": 9.42, "rh": 74.1697748385,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 53.38},
    "2019-09-22T06:30:00.000Z": {"AirTC": 9.92, "rh": 71.8497088434,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 77.2},
    "2019-09-22T06:40:00.000Z": {"AirTC": 10.19, "rh": 70.2857628641,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 79.7},
    "2019-09-22T06:50:00.000Z": {"AirTC": 10.31, "rh": 69.5363350736,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 99.6},
    "2019-09-22T07:00:00.000Z": {"AirTC": 10.73, "rh": 68.2087665696,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 128.7},
    "2019-09-22T07:10:00.000Z": {"AirTC": 11.26, "rh": 67.3590269537,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 144.3},
    "2019-09-22T07:20:00.000Z": {"AirTC": 11.98, "rh": 65.784514168,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 198.6},
    "2019-09-22T07:30:00.000Z": {"AirTC": 12.8, "rh": 62.5456001735,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 195.1},
    "2019-09-22T07:40:00.000Z": {"AirTC": 13.48, "rh": 62.2721926287,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 183.1},
    "2019-09-22T07:50:00.000Z": {"AirTC": 13.95, "rh": 61.257008304,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 190.1},
    "2019-09-22T08:00:00.000Z": {"AirTC": 14.11, "rh": 60.1525052726,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 190.1},
    "2019-09-22T08:10:00.000Z": {"AirTC": 14.32, "rh": 59.622830086,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 208.9},
    "2019-09-22T08:20:00.000Z": {"AirTC": 14.55, "rh": 59.8215511416,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 230.1},
    "2019-09-22T08:30:00.000Z": {"AirTC": 14.89, "rh": 59.4379117885,
                                 "WS": 0.067, "BP": 981.0, "SWdn": 241.1},
    "2019-09-22T08:40:00.000Z": {"AirTC": 15.03, "rh": 58.9051222018,
                                 "WS": 0.09, "BP": 981.0, "SWdn": 264.2},
    "2019-09-22T08:50:00.000Z": {"AirTC": 14.54, "rh": 60.3377125018,
                                 "WS": 0.462, "BP": 981.0, "SWdn": 272.2},
    "2019-09-22T09:00:00.000Z": {"AirTC": 14.42, "rh": 60.5700399375,
                                 "WS": 0.185, "BP": 981.0, "SWdn": 299.9},
    "2019-09-22T09:10:00.000Z": {"AirTC": 14.85, "rh": 60.0820927798,
                                 "WS": 0.035, "BP": 981.0, "SWdn": 301.6},
    "2019-09-22T09:20:00.000Z": {"AirTC": 15.32, "rh": 58.895106719,
                                 "WS": 0.0, "BP": 981.0, "SWdn": 303.1},
    "2019-09-22T09:30:00.000Z": {"AirTC": 15.84, "rh": 57.8677145624,
                                 "WS": 0.0, "BP": 980.0, "SWdn": 387.7},
    "2019-09-22T09:40:00.000Z": {"AirTC": 16.69, "rh": 55.3442904835,
                                 "WS": 0.019, "BP": 980.0, "SWdn": 449.8},
    "2019-09-22T09:50:00.000Z": {"AirTC": 17.94, "rh": 53.3056205516,
                                 "WS": 0.067, "BP": 980.0, "SWdn": 587.0},
    "2019-09-22T10:00:00.000Z": {"AirTC": 18.6, "rh": 50.9373630624,
                                 "WS": 0.004, "BP": 980.0, "SWdn": 522.4},
    "2019-09-22T10:10:00.000Z": {"AirTC": 19.3, "rh": 49.9974222202,
                                 "WS": 0.181, "BP": 980.0, "SWdn": 482.3},
    "2019-09-22T10:20:00.000Z": {"AirTC": 19.59, "rh": 49.7384898927,
                                 "WS": 0.156, "BP": 980.0, "SWdn": 553.2},
    "2019-09-22T10:30:00.000Z": {"AirTC": 20.0, "rh": 48.6872547093,
                                 "WS": 0.39, "BP": 980.0, "SWdn": 566.3},
    "2019-09-22T10:40:00.000Z": {"AirTC": 19.91, "rh": 48.9262303735,
                                 "WS": 0.265, "BP": 980.0, "SWdn": 458.9},
    "2019-09-22T10:50:00.000Z": {"AirTC": 20.09, "rh": 48.7115869578,
                                 "WS": 0.327, "BP": 980.0, "SWdn": 444.1},
    "2019-09-22T11:00:00.000Z": {"AirTC": 20.46, "rh": 47.6113297654,
                                 "WS": 0.175, "BP": 980.0, "SWdn": 528.3},
    "2019-09-22T11:10:00.000Z": {"AirTC": 20.53, "rh": 48.0813388322,
                                 "WS": 0.14, "BP": 980.0, "SWdn": 450.9},
    "2019-09-22T11:20:00.000Z": {"AirTC": 21.36, "rh": 47.2192928335,
                                 "WS": 0.208, "BP": 980.0, "SWdn": 612.1},
    "2019-09-22T11:30:00.000Z": {"AirTC": 21.79, "rh": 46.7702598336,
                                 "WS": 0.094, "BP": 979.0, "SWdn": 450.6},
    "2019-09-22T11:40:00.000Z": {"AirTC": 22.71, "rh": 44.8795957968,
                                 "WS": 0.279, "BP": 979.0, "SWdn": 755.0},
    "2019-09-22T11:50:00.000Z": {"AirTC": 22.97, "rh": 44.7718232579,
                                 "WS": 0.152, "BP": 979.0, "SWdn": 426.3},
    "2019-09-22T12:00:00.000Z": {"AirTC": 22.85, "rh": 44.5897253181,
                                 "WS": 0.223, "BP": 979.0, "SWdn": 597.9},
    "2019-09-22T12:10:00.000Z": {"AirTC": 23.68, "rh": 43.788661011,
                                 "WS": 0.729, "BP": 979.0, "SWdn": 841.0},
    "2019-09-22T12:20:00.000Z": {"AirTC": 24.26, "rh": 43.37032734,
                                 "WS": 0.202, "BP": 979.0, "SWdn": 610.7},
    "2019-09-22T12:30:00.000Z": {"AirTC": 24.23, "rh": 43.1898150106,
                                 "WS": 0.8, "BP": 979.0, "SWdn": 490.8},
    "2019-09-22T12:40:00.000Z": {"AirTC": 24.29, "rh": 43.8407876531,
                                 "WS": 0.377, "BP": 979.0, "SWdn": 552.4},
    "2019-09-22T12:50:00.000Z": {"AirTC": 24.4, "rh": 44.1037735012,
                                 "WS": 1.125, "BP": 979.0, "SWdn": 527.6},
    "2019-09-22T13:00:00.000Z": {"AirTC": 24.79, "rh": 43.6605109697,
                                 "WS": 1.806, "BP": 979.0, "SWdn": 617.8},
    "2019-09-22T13:10:00.000Z": {"AirTC": 25.34, "rh": 42.142034044,
                                 "WS": 2.002, "BP": 979.0, "SWdn": 875.0},
    "2019-09-22T13:20:00.000Z": {"AirTC": 25.88, "rh": 40.5984795249,
                                 "WS": 1.821, "BP": 978.0, "SWdn": 809.0},
    "2019-09-22T13:30:00.000Z": {"AirTC": 26.22, "rh": 39.1122680898,
                                 "WS": 2.744, "BP": 978.0, "SWdn": 1082.0},
    "2019-09-22T13:40:00.000Z": {"AirTC": 26.37, "rh": 38.4861893541,
                                 "WS": 3.185, "BP": 978.0, "SWdn": 835.0},
    "2019-09-22T13:50:00.000Z": {"AirTC": 26.38, "rh": 38.540005859,
                                 "WS": 1.862, "BP": 978.0, "SWdn": 601.5},
    "2019-09-22T14:00:00.000Z": {"AirTC": 25.97, "rh": 39.5633194972,
                                 "WS": 2.15, "BP": 978.0, "SWdn": 484.0},
    "2019-09-22T14:10:00.000Z": {"AirTC": 25.85, "rh": 39.8717067872,
                                 "WS": 1.875, "BP": 978.0, "SWdn": 472.1},
    "2019-09-22T14:20:00.000Z": {"AirTC": 25.59, "rh": 40.5982648199,
                                 "WS": 0.938, "BP": 978.0, "SWdn": 369.8},
    "2019-09-22T14:30:00.000Z": {"AirTC": 25.89, "rh": 39.8828659864,
                                 "WS": 0.648, "BP": 978.0, "SWdn": 418.9},
    "2019-09-22T14:40:00.000Z": {"AirTC": 26.0, "rh": 39.5716932005,
                                 "WS": 0.765, "BP": 978.0, "SWdn": 402.1},
    "2019-09-22T14:50:00.000Z": {"AirTC": 25.21, "rh": 40.8973135727,
                                 "WS": 0.752, "BP": 978.0, "SWdn": 262.6},
    "2019-09-22T15:00:00.000Z": {"AirTC": 24.95, "rh": 42.0060431847,
                                 "WS": 0.571, "BP": 978.0, "SWdn": 225.9},
    "2019-09-22T15:10:00.000Z": {"AirTC": 24.68, "rh": 43.5150613173,
                                 "WS": 0.271, "BP": 978.0, "SWdn": 165.9},
    "2019-09-22T15:20:00.000Z": {"AirTC": 24.52, "rh": 43.7593257577,
                                 "WS": 0.3, "BP": 978.0, "SWdn": 175.0},
    "2019-09-22T15:30:00.000Z": {"AirTC": 24.73, "rh": 43.2993981783,
                                 "WS": 0.531, "BP": 978.0, "SWdn": 295.1},
    "2019-09-22T15:40:00.000Z": {"AirTC": 24.74, "rh": 43.5028688623,
                                 "WS": 0.198, "BP": 978.0, "SWdn": 225.5},
    "2019-09-22T15:50:00.000Z": {"AirTC": 24.88, "rh": 43.369414347,
                                 "WS": 0.35, "BP": 977.0, "SWdn": 242.1},
    "2019-09-22T16:00:00.000Z": {"AirTC": 24.56, "rh": 43.857196467,
                                 "WS": 0.14, "BP": 977.0, "SWdn": 119.6},
    "2019-09-22T16:10:00.000Z": {"AirTC": 23.99, "rh": 45.1713639928,
                                 "WS": 0.235, "BP": 977.0, "SWdn": 78.6},
    "2019-09-22T16:20:00.000Z": {"AirTC": 23.65, "rh": 46.1956687013,
                                 "WS": 0.156, "BP": 977.0, "SWdn": 73.0},
    "2019-09-22T16:30:00.000Z": {"AirTC": 23.44, "rh": 46.5986059926,
                                 "WS": 0.144, "BP": 977.0, "SWdn": 69.35},
    "2019-09-22T16:40:00.000Z": {"AirTC": 23.27, "rh": 47.1724268636,
                                 "WS": 0.052, "BP": 977.0, "SWdn": 63.0},
    "2019-09-22T16:50:00.000Z": {"AirTC": 22.99, "rh": 48.0091076807,
                                 "WS": 0.115, "BP": 977.0, "SWdn": 45.76},
    "2019-09-22T17:00:00.000Z": {"AirTC": 22.78, "rh": 49.0103797489,
                                 "WS": 0.073, "BP": 977.0, "SWdn": 29.77},
    "2019-09-22T17:10:00.000Z": {"AirTC": 22.66, "rh": 48.9136323383,
                                 "WS": 0.05, "BP": 977.0, "SWdn": 16.37},
    "2019-09-22T17:20:00.000Z": {"AirTC": 22.57, "rh": 50.36420577,
                                 "WS": 1.781, "BP": 978.0, "SWdn": 12.58},
    "2019-09-22T17:30:00.000Z": {"AirTC": 21.68, "rh": 58.7756403937,
                                 "WS": 3.304, "BP": 978.0, "SWdn": 2.169},
    "2019-09-22T17:40:00.000Z": {"AirTC": 20.25, "rh": 68.6507811039,
                                 "WS": 2.198, "BP": 978.0, "SWdn": 5.253},
    "2019-09-22T17:50:00.000Z": {"AirTC": 19.97, "rh": 70.6660333308,
                                 "WS": 1.34, "BP": 978.0, "SWdn": 3.584},
    "2019-09-22T18:00:00.000Z": {"AirTC": 19.66, "rh": 72.7366884934,
                                 "WS": 1.585, "BP": 979.0, "SWdn": 3.925},
    "2019-09-22T18:10:00.000Z": {"AirTC": 19.47, "rh": 73.8372161655,
                                 "WS": 0.742, "BP": 979.0, "SWdn": 5.954},
    "2019-09-22T18:20:00.000Z": {"AirTC": 18.85, "rh": 77.7381422117,
                                 "WS": 1.858, "BP": 979.0, "SWdn": 9.9},
    "2019-09-22T18:30:00.000Z": {"AirTC": 18.25, "rh": 81.336826754,
                                 "WS": 0.665, "BP": 979.0, "SWdn": 11.98},
    "2019-09-22T18:40:00.000Z": {"AirTC": 17.93, "rh": 83.4686541113,
                                 "WS": 0.125, "BP": 979.0, "SWdn": 13.0},
    "2019-09-22T18:50:00.000Z": {"AirTC": 17.72, "rh": 84.9596515658,
                                 "WS": 0.0, "BP": 979.0, "SWdn": 13.36},
    "2019-09-22T19:00:00.000Z": {"AirTC": 17.57, "rh": 86.207666481,
                                 "WS": 0.137, "BP": 979.0, "SWdn": 13.81},
    "2019-09-22T19:10:00.000Z": {"AirTC": 17.42, "rh": 87.4186307505,
                                 "WS": 0.0, "BP": 979.0, "SWdn": 14.17},
    "2019-09-22T19:20:00.000Z": {"AirTC": 17.34, "rh": 88.0867763399,
                                 "WS": 0.002, "BP": 979.0, "SWdn": 14.67},
    "2019-09-22T19:30:00.000Z": {"AirTC": 17.41, "rh": 88.4883365241,
                                 "WS": 0.008, "BP": 979.0, "SWdn": 14.36},
    "2019-09-22T19:40:00.000Z": {"AirTC": 17.41, "rh": 88.8288008378,
                                 "WS": 0.071, "BP": 979.0, "SWdn": 14.1},
    "2019-09-22T19:50:00.000Z": {"AirTC": 17.44, "rh": 89.1156764509,
                                 "WS": 0.048, "BP": 980.0, "SWdn": 15.09},
    "2019-09-22T20:00:00.000Z": {"AirTC": 17.42, "rh": 89.0571790912,
                                 "WS": 0.525, "BP": 980.0, "SWdn": 16.28},
    "2019-09-22T20:10:00.000Z": {"AirTC": 17.18, "rh": 88.0169997858,
                                 "WS": 1.923, "BP": 980.0, "SWdn": 15.91},
    "2019-09-22T20:20:00.000Z": {"AirTC": 16.6, "rh": 86.8968419954,
                                 "WS": 2.24, "BP": 980.0, "SWdn": 15.17},
    "2019-09-22T20:30:00.000Z": {"AirTC": 16.23, "rh": 88.6790858192,
                                 "WS": 0.265, "BP": 980.0, "SWdn": 14.61},
    "2019-09-22T20:40:00.000Z": {"AirTC": 16.07, "rh": 89.414486785,
                                 "WS": 0.073, "BP": 980.0, "SWdn": 14.23},
    "2019-09-22T20:50:00.000Z": {"AirTC": 15.95, "rh": 89.9271675185,
                                 "WS": 0.056, "BP": 980.0, "SWdn": 14.08},
    "2019-09-22T21:00:00.000Z": {"AirTC": 15.81, "rh": 90.4420471437,
                                 "WS": 0.204, "BP": 980.0, "SWdn": 14.04},
    "2019-09-22T21:10:00.000Z": {"AirTC": 15.59, "rh": 90.720431004,
                                 "WS": 0.177, "BP": 981.0, "SWdn": 13.78},
    "2019-09-22T21:20:00.000Z": {"AirTC": 15.48, "rh": 91.1254065619,
                                 "WS": 0.317, "BP": 981.0, "SWdn": 13.88},
    "2019-09-22T21:30:00.000Z": {"AirTC": 15.4, "rh": 91.4159854217,
                                 "WS": 0.094, "BP": 981.0, "SWdn": 14.02},
    "2019-09-22T21:40:00.000Z": {"AirTC": 15.31, "rh": 91.5290952585,
                                 "WS": 0.123, "BP": 981.0, "SWdn": 14.04},
    "2019-09-22T21:50:00.000Z": {"AirTC": 15.23, "rh": 91.7619523572,
                                 "WS": 0.54, "BP": 981.0, "SWdn": 14.37},
    "2019-09-22T22:00:00.000Z": {"AirTC": 15.22, "rh": 91.8803957353,
                                 "WS": 0.029, "BP": 981.0, "SWdn": 14.26},
    "2019-09-22T22:10:00.000Z": {"AirTC": 15.22, "rh": 91.9995536707,
                                 "WS": 0.356, "BP": 981.0, "SWdn": 14.48},
    "2019-09-22T22:20:00.000Z": {"AirTC": 15.13, "rh": 92.0541642151,
                                 "WS": 0.644, "BP": 981.0, "SWdn": 14.63},
    "2019-09-22T22:30:00.000Z": {"AirTC": 14.97, "rh": 92.045228514,
                                 "WS": 0.746, "BP": 981.0, "SWdn": 14.52},
    "2019-09-22T22:40:00.000Z": {"AirTC": 14.84, "rh": 91.978163881,
                                 "WS": 1.035, "BP": 981.0, "SWdn": 14.39},
    "2019-09-22T22:50:00.000Z": {"AirTC": 14.75, "rh": 91.9730847209,
                                 "WS": 1.235, "BP": 982.0, "SWdn": 14.34},
    "2019-09-22T23:00:00.000Z": {"AirTC": 14.65, "rh": 91.788017826,
                                 "WS": 0.821, "BP": 982.0, "SWdn": 14.49},
    "2019-09-22T23:10:00.000Z": {"AirTC": 14.63, "rh": 91.9064559656,
                                 "WS": 0.938, "BP": 982.0, "SWdn": 14.29},
    "2019-09-22T23:20:00.000Z": {"AirTC": 14.44, "rh": 91.8956207222,
                                 "WS": 1.617, "BP": 982.0, "SWdn": 14.37},
    "2019-09-22T23:30:00.000Z": {"AirTC": 13.84, "rh": 91.5608270037,
                                 "WS": 0.252, "BP": 982.0, "SWdn": 13.83},
    "2019-09-22T23:40:00.000Z": {"AirTC": 13.22, "rh": 91.4032689574,
                                 "WS": 0.006, "BP": 982.0, "SWdn": 13.26},
    "2019-09-22T23:50:00.000Z": {"AirTC": 13.1, "rh": 91.637229782,
                                 "WS": 0.0, "BP": 982.0, "SWdn": 13.5}
}
dat = pd.DataFrame.from_dict(json, orient='index')
dat.index = pd.to_datetime(dat.index)


class Test_penmanmonteith_mono(unittest.TestCase):
    '''
    penmanmonteith1(T, rh, vh, p, Kdn, time=None, df=None,
                     lat=45, ele=0.,
                     Kelvin=None, hPa=False, percent=False):
    '''

    def test_pm_parameters(self):
        self.assertRaises(TypeError, m.evapo.penmanmonteith_mono, Kelvin=None)
        self.assertRaises(
            ValueError, m.evapo.penmanmonteith_mono, 1, 2, 3, 4, 5)
        self.assertRaises(ValueError, m.evapo.penmanmonteith_mono,
                          "AirTC", "rh",
                          "WS", "BP", "SWdn")

    def test_pm_values(self):
        out = m.evapo.penmanmonteith_mono("AirTC", "rh",
                                          "WS", "BP", "SWdn", df=dat,
                                          lat=50., ele=252.,
                                          Kelvin=False, hPa=True, percent=True)
        self.assertAlmostEqual(out.values[0], [3.40], delta=0.03)


class Test_penmanmonteith(unittest.TestCase):
    '''
    penmanmonteith1(T, rh, vh, p, Kdn, time=None, df=None,
                     lat=45, ele=0.,
                     Kelvin=None, hPa=False, percent=False):
    '''

    def test_pm_parameters(self):
        self.assertRaises(TypeError, m.evapo.penmanmonteith, Kelvin=None)
        self.assertRaises(ValueError, m.evapo.penmanmonteith, 1, 2, 3, 4, 5)
        self.assertRaises(ValueError, m.evapo.penmanmonteith,
                          "AirTC", "rh",
                          "WS", "BP", "SWdn")

    def test_pm_values(self):
        out = m.evapo.penmanmonteith("AirTC", "rh",
                                     "WS", "BP", "SWdn", df=dat,
                                     lat=50., ele=252.,
                                     Kelvin=False, hPa=True, percent=True)
        self.assertAlmostEqual(out.values[0], [3.40], delta=0.03)
