[build-system]
requires = ["setuptools>=66.1"]
build-backend = 'setuptools.build_meta'

[project]
name = "quantify"
description="""\
A framework for controlling quantum computing and solid-state physics experiments.\
"""
maintainers = [
    {name = "Robert Sokolewicz", email = "rsokolewicz@qblox.com"},
    {name = "Olga Lebiga", email = "olga@orangeqs.com"},
    {name = "Gabor Oszkar Denes", email = "viacheslav@orangeqs.com"},
    {name = "Amirtha Varshiny Arumugam", email = "amirthavarshiny@orangeqs.com"},
    {name = "Gabriel Chatelain", email = "gabriel@orangeqs.com"},
]
classifiers = [
    "Development Status :: 3 - Alpha",
    "Intended Audience :: Developers",
    "Intended Audience :: Science/Research",
    "License :: OSI Approved :: BSD License",
    "Natural Language :: English",
    "Programming Language :: Python :: 3.12",
    "Topic :: Scientific/Engineering",
]
keywords = [
    "quantum",
    "quantify",
]
license = { text = "BSD-3-Clause" }
version = "0.0.0.a0"
dynamic = ["readme"]

dependencies = [
    "adaptive",
    "appnope",
    "columnar",
    "dataclasses-json",
    "dill",  # Tests fail without dill installed, likely for a good reason
    "fastjsonschema",
    "filelock",
    "h5netcdf",
    "jinja2>=3.1.2", # pandas requires version 3.1.2 or newer
    "jsonschema",
    "lmfit >=1.0.3", # Bugfix for lmfit (https://github.com/lmfit/lmfit-py/pull/758)
    "matplotlib !=3.5.0",
    "methodtools",  # used in base_analysis for self-bound lru_cache
    "networkx",
    "numpy!=1.19.4",
    "pandas[output_formatting]",
    "pathvalidate",
    "plotly",
    "pre-commit",
    "pre-commit-hooks",
    "pydantic>=2.0",
    "pyqt5 >5.15.2",  # 5.15.2 has known bug, #170, https://bugreports.qt.io/browse/PYSIDE-1473
    "pyqtgraph",
    "pyright",
    "qcodes >=0.37.0", # 0.37.0 replaces deprecated pyqtgraph functionality
    "qcodes-loop",
    "rich[jupyter]",
    "scikit-learn",
    "scipy >=1.5.0, !=1.6.0",
    "typing-extensions",  # Independency from python version for "new" typing features
    "uncertainties",
    "xarray >=0.19.0",
    "xxhash",
    "lmfit>=1.3.3"
]


[project.urls]
"Website" = "https://quantify-os.org"
"Source" = "https://gitlab.com/quantify-os/quantify"
"Issue tracker" = "https://gitlab.com/quantify-os/quantify/-/issues"
"Slack" = "https://join.slack.com/t/quantify-hq/shared_invite/zt-1nd78r4e9-rbWdna53cW4DO_YbtMhVuA"

[tool.setuptools.packages.find]
include = ["quantify", "quantify.*"]

[tool.setuptools.dynamic]
readme = { file = ["README.md"], content-type = "text/markdown" }

[tool.ruff]
line-length = 88
lint.select = [
    "F",  # pyflakes
    "E",  # pycodestyle
    "W",  # pycodestyle
    "D",  # pydocstyle
    "I",  # isort
    "N",  # flake8-naming
    "UP", # pyupgrade
    "TID",  # flake8-tidy-imports
    "SIM",  # flake8-simplify
    "TCH",  # flake8-type-checking
    "Q", #flake8-quotes
    "ARG", #flake8-unused-arguments
    "ANN",  # flake8-annotations
    #Pylint (PLC, PLE, PLR, PLW)
    "PLC",
    "PLE",
    "PLR",
    "PLW",
]
extend-exclude = [
    "setup.py",
    "quantify/_version.py",
    "quantify/_static_version.py",
]

# ignore these rules for all files:
lint.ignore = [
            # 1 blank line required before class docstring
            "D203",
            # Multi-line docstring summary should start at the first line
            "D212",
            # Ambiguous variable name
            "E741",
            # Variable `...` in function should be lowercase
            "N806",
            # Too many arguments to function call (.../5)
            "PLR0913",
            # Class attribute `compile` is shadowing a python builtin
            "A003",
            # Missing type annotation for `self` in method
            "ANN101",
            # Magic value used in comparison, consider replacing `...` with a constant variable
            "PLR2004",
            # First line of docstring should be in imperative mood
            "D401",
            # 1 blank line required between summary line and description
            "D205",
            # Multi-line docstring summary should start at the second line (conflicts with black)
            "D213",
            # Missing type annotation for `**kwargs`
            "ANN003",
            # Missing type annotation for `*args`
            "ANN002",
            # No blank lines allowed before class docstring (conflicts with black)
            "D211",
            # Functions or methods that have more than 12 branches
            "PLR0912"
]

[tool.ruff.lint.isort]
known-first-party = ["quantify", "quantify_core", "quantify_scheduler"]

[tool.ruff.lint.per-file-ignores]
"tests/*" = ["D", "ANN"]

# - E402: Module level import not at top of file
"docs/conf.py" = ["E402"]

[tool.pyright]
pythonVersion = "3.12"
exclude = [
    "tests",
    "docs",
    "build",
    "conftest.py",
    "quantify/_static_version.py",
    "quantify/_version.py",
    "quantify/__init__.py",
    "quantify/visualization/mpl_plotting.py",
    "quantify/visualization/SI_utilities.py",
    "quantify/operations/pulse_library.py",
    "quantify/measurement/control.py",

]
