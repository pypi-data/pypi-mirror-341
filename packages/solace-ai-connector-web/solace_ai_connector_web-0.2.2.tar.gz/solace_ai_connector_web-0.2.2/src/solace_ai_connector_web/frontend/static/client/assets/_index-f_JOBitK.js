var In=Object.defineProperty;var On=(e,t,n)=>t in e?In(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var _=(e,t,n)=>On(e,typeof t!="symbol"?t+"":t,n);import{r as k,a as J,c as I,g as Pn,j as d}from"./jsx-runtime-CNvHvvCs.js";import{u as Ae,a as Ke,g as Qe}from"./ConfigProvider-Du21v841.js";function Dn({serverUrl:e,useAuthorization:t,defaultIsAuthenticated:n}){const[r,s]=k.useState(n),[i,a]=k.useState(!0),{configAuthLoginUrl:o,configRedirectUrl:l}=Ae(),u=h=>h.status===401||h.status===403?(localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),s(!1),!0):!1;return k.useEffect(()=>{t?(async()=>{try{const f=localStorage.getItem("access_token"),m=localStorage.getItem("refresh_token");let g=Ke("csrf_token");if(g||(g=await Qe()),f){const p=await fetch(`${e}/validate_token`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Refresh-Token":m??"","X-CSRF-TOKEN":g??""},body:JSON.stringify({token:f})});if(u(p))return;const x=await p.json();x.valid?(x.new_access_token&&localStorage.setItem("access_token",x.new_access_token),s(!0)):(localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),s(!1))}else s(!1)}catch(f){console.error("Token validation error:",f),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),s(!1)}finally{a(!1)}})():a(!1)},[e,t]),{isValidatingToken:i,isAuthenticated:r,handleLogin:()=>{const h=o,f=l;window.location.href=`${h}?redirect_uri=${encodeURIComponent(f)}`}}}function $n({serverUrl:e,welcomeMessage:t}){const[n,r]=k.useState(""),[s,i]=k.useState([t]),[a,o]=k.useState(""),[l,u]=k.useState(!1),[c,h]=k.useState(null),[f,m]=k.useState(()=>{if(typeof window<"u"){const b=localStorage.getItem("darkMode");return b!==null?JSON.parse(b):window.matchMedia("(prefers-color-scheme: dark)").matches}return!1}),[g,p]=k.useState(null),{configBotName:x}=Ae();k.useEffect(()=>{localStorage.setItem("darkMode",JSON.stringify(f)),f?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[f]);const R=k.useCallback(()=>{if(g&&(g.abort(),p(null)),r(""),i([t]),h(null),u(!1),typeof window<"u"){const b=new CustomEvent("new-chat-session");window.dispatchEvent(b)}},[g,t]),S=k.useCallback(()=>{h(null)},[]);function E(){const b={id:Date.now().toString(),message:"📝 Responding..."};h(b),i(w=>{const v=w[w.length-1];return v.isStatusMessage&&v.isThinkingMessage?[...w.slice(0,-1),{...v,text:`${x} is responding`,statusMessage:b,isThinkingMessage:!1}]:w})}const M=async(b,w)=>{var se;if(b.preventDefault(),!a.trim()&&(!w||w.length===0)||l)return;D(g);const v=new AbortController;p(v),u(!0);const{accessToken:j,refreshToken:A}=O(),N=jn(a,n,w);Nn(a,w),An();const V={botMessageBuffer:"",partialLineBuffer:"",hasShownFirstStatus:!1,firstChunkRead:!1};o("");try{const xe=await me()??"",ie=await Ue(N,v,j,A,xe);if(!ie.ok){if(_n(ie))return;throw new Error("Network response was not ok")}const be=(se=ie.body)==null?void 0:se.getReader();if(!be)return;const Ln=new TextDecoder;if(await W(be,Ln,V))return}catch(xe){if(xe instanceof Error&&xe.name==="AbortError")return;i(ie=>[...ie.filter(be=>!be.isStatusMessage),{text:"There was an error processing your request. Please try again.",isUser:!1}])}finally{Rn()}};function P(b,w,v){if(!b.status_message)return v;const j={id:Date.now().toString(),message:b.status_message};return h(j),w===""&&!v?(i(A=>{const N=[...A],V=N[N.length-1];return V!=null&&V.isStatusMessage?N[N.length-1]={...V,text:`${x} is thinking`,statusMessage:j,isThinkingMessage:!1}:N.push({text:`${x} is thinking`,isUser:!1,isStatusMessage:!0,isThinkingMessage:!1,statusMessage:j}),N}),!0):(i(A=>{const N=[...A],V=N[N.length-1];return V&&!V.isUser&&(N[N.length-1]={...V,statusMessage:j}),N}),v)}function D(b){b&&b.abort()}async function W(b,w,v){for(;;){const{done:j,value:A}=await b.read();if(j)break;v.firstChunkRead||(v.firstChunkRead=!0,v.hasShownFirstStatus||E());const N=w.decode(A,{stream:!0}),se=(v.partialLineBuffer+N).split(`
`);if(v.partialLineBuffer=se.pop()||"",await H(se,v))return!0}return!1}async function H(b,w){for(const v of b)if(v.trim()){if(v==="data: [DONE]")return L(w.partialLineBuffer),!0;if(v.startsWith("data: ")){const j=v.slice(6);try{const A=JSON.parse(j),N=X(A,w.botMessageBuffer,w.hasShownFirstStatus);w.botMessageBuffer=N.botMessageBuffer,w.hasShownFirstStatus=N.hasShownFirstStatus}catch{w.partialLineBuffer=v}}}return!1}function L(b){if(b)try{const w=b.replace(/^data:\s*/,""),v=JSON.parse(w);v.files&&yt(v.files)}catch(w){console.error("Error parsing final partial data:",w)}u(!1)}function X(b,w,v){return w=ge(b,w),v=P(b,w,v),w=He(b,w),Fe(b),{botMessageBuffer:w,hasShownFirstStatus:v}}function ge(b,w){return b.new_access_token&&localStorage.setItem("access_token",b.new_access_token),b.session_id&&!n&&r(b.session_id),w}function He(b,w){return b.content&&(w+=b.content,Mn(w,b.id,b)),w}function Fe(b){b.files&&yt(b.files)}function O(){return{accessToken:localStorage.getItem("access_token"),refreshToken:localStorage.getItem("refresh_token")}}async function me(){let b=Ke("csrf_token");return b||(b=await Qe()),b}async function Ue(b,w,v,j,A){return await fetch(`${e}/api/v1/chat`,{method:"POST",headers:{Authorization:`Bearer ${v}`,"X-Refresh-Token":j??"","X-CSRF-TOKEN":A??""},signal:w.signal,body:b})}function _n(b){return b.status===401||b.status===403?(localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),window.location.href="/",!0):!1}function Rn(){const b={id:Date.now().toString(),message:"✅ Response complete"};h(b),i(w=>{const v=w[w.length-1];return v.isUser?w:[...w.slice(0,-1),{...v,statusMessage:b}]}),p(null),u(!1)}function jn(b,w,v){const j=new FormData;return j.append("prompt",b),w&&j.append("session_id",w),v&&v.forEach(A=>j.append("files",A)),j}function Nn(b,w){i(v=>[...v,{text:b,isUser:!0,uploadedFiles:w&&w.length>0?Array.from(w):void 0}])}function An(){i(b=>[...b,{text:`${x} is thinking`,isUser:!1,isStatusMessage:!0,isThinkingMessage:!0,statusMessage:{id:Date.now().toString(),message:"🤔 Thinking..."}}])}function yt(b){i(w=>{const v=w[w.length-1];if(v&&!v.isUser){const j=v.files||[],A=Array.isArray(b)?b:[b];return[...w.slice(0,-1),{...v,files:[...j,...A]}]}return w})}function Mn(b,w,v){i(j=>{const A=j[j.length-1],N={text:b,isUser:!1,metadata:{sessionId:v.session_id||n,messageId:w},statusMessage:c};return A&&!A.isUser?[...j.slice(0,-1),{...A,...N,statusMessage:A.statusMessage||c,isStatusMessage:!1,isThinkingMessage:!1}]:[...j,{...N,statusMessage:c}]})}return{sessionId:n,messages:s,setMessages:i,userInput:a,setUserInput:o,isResponding:l,handleNewSession:R,handleSubmit:M,clearStatusMessages:S,darkMode:f,setDarkMode:m}}var Gt={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},St=J.createContext&&J.createContext(Gt),zn=["attr","size","title"];function Bn(e,t){if(e==null)return{};var n=Hn(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Hn(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Te(){return Te=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Te.apply(this,arguments)}function Et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Et(Object(n),!0).forEach(function(r){Fn(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Fn(e,t,n){return t=Un(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Un(e){var t=Gn(e,"string");return typeof t=="symbol"?t:t+""}function Gn(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wt(e){return e&&e.map((t,n)=>J.createElement(t.tag,Ce({key:n},t.attr),Wt(t.child)))}function re(e){return t=>J.createElement(Wn,Te({attr:Ce({},e.attr)},t),Wt(e.child))}function Wn(e){var t=n=>{var{attr:r,size:s,title:i}=e,a=Bn(e,zn),o=s||n.size||"1em",l;return n.className&&(l=n.className),e.className&&(l=(l?l+" ":"")+e.className),J.createElement("svg",Te({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,a,{className:l,style:Ce(Ce({color:e.color||n.color},n.style),e.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),i&&J.createElement("title",null,i),e.children)};return St!==void 0?J.createElement(St.Consumer,null,n=>t(n)):t(Gt)}function Vn(e){return re({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"},child:[]},{tag:"polyline",attr:{points:"19 12 12 19 5 12"},child:[]}]})(e)}function qn(e){return re({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"},child:[]}]})(e)}function Xn(e){return re({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"22",y1:"2",x2:"11",y2:"13"},child:[]},{tag:"polygon",attr:{points:"22 2 15 22 11 13 2 9 22 2"},child:[]}]})(e)}function Je(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let te=Je();function Vt(e){te=e}const ce={exec:()=>null};function T(e,t=""){let n=typeof e=="string"?e:e.source;const r={replace:(s,i)=>{let a=typeof i=="string"?i:i.source;return a=a.replace(z.caret,"$1"),n=n.replace(s,a),r},getRegex:()=>new RegExp(n,t)};return r}const z={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},Zn=/^(?:[ \t]*(?:\n|$))+/,Yn=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Kn=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,fe=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Qn=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,et=/(?:[*+-]|\d{1,9}[.)])/,qt=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Xt=T(qt).replace(/bull/g,et).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Jn=T(qt).replace(/bull/g,et).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),tt=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,er=/^[^\n]+/,nt=/(?!\s*\])(?:\\.|[^\[\]\\])+/,tr=T(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",nt).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),nr=T(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,et).getRegex(),Me="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",rt=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,rr=T("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",rt).replace("tag",Me).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Zt=T(tt).replace("hr",fe).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Me).getRegex(),sr=T(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Zt).getRegex(),st={blockquote:sr,code:Yn,def:tr,fences:Kn,heading:Qn,hr:fe,html:rr,lheading:Xt,list:nr,newline:Zn,paragraph:Zt,table:ce,text:er},Tt=T("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",fe).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Me).getRegex(),ir={...st,lheading:Jn,table:Tt,paragraph:T(tt).replace("hr",fe).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Tt).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Me).getRegex()},ar={...st,html:T(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",rt).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ce,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:T(tt).replace("hr",fe).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Xt).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},or=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,lr=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Yt=/^( {2,}|\\)\n(?!\s*$)/,cr=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Le=/[\p{P}\p{S}]/u,it=/[\s\p{P}\p{S}]/u,Kt=/[^\s\p{P}\p{S}]/u,ur=T(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,it).getRegex(),Qt=/(?!~)[\p{P}\p{S}]/u,dr=/(?!~)[\s\p{P}\p{S}]/u,hr=/(?:[^\s\p{P}\p{S}]|~)/u,pr=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,Jt=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,fr=T(Jt,"u").replace(/punct/g,Le).getRegex(),gr=T(Jt,"u").replace(/punct/g,Qt).getRegex(),en="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",mr=T(en,"gu").replace(/notPunctSpace/g,Kt).replace(/punctSpace/g,it).replace(/punct/g,Le).getRegex(),xr=T(en,"gu").replace(/notPunctSpace/g,hr).replace(/punctSpace/g,dr).replace(/punct/g,Qt).getRegex(),br=T("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Kt).replace(/punctSpace/g,it).replace(/punct/g,Le).getRegex(),kr=T(/\\(punct)/,"gu").replace(/punct/g,Le).getRegex(),wr=T(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),vr=T(rt).replace("(?:-->|$)","-->").getRegex(),yr=T("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",vr).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),_e=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Sr=T(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",_e).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),tn=T(/^!?\[(label)\]\[(ref)\]/).replace("label",_e).replace("ref",nt).getRegex(),nn=T(/^!?\[(ref)\](?:\[\])?/).replace("ref",nt).getRegex(),Er=T("reflink|nolink(?!\\()","g").replace("reflink",tn).replace("nolink",nn).getRegex(),at={_backpedal:ce,anyPunctuation:kr,autolink:wr,blockSkip:pr,br:Yt,code:lr,del:ce,emStrongLDelim:fr,emStrongRDelimAst:mr,emStrongRDelimUnd:br,escape:or,link:Sr,nolink:nn,punctuation:ur,reflink:tn,reflinkSearch:Er,tag:yr,text:cr,url:ce},Tr={...at,link:T(/^!?\[(label)\]\((.*?)\)/).replace("label",_e).getRegex(),reflink:T(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",_e).getRegex()},Ve={...at,emStrongRDelimAst:xr,emStrongLDelim:gr,url:T(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Cr={...Ve,br:T(Yt).replace("{2,}","*").getRegex(),text:T(Ve.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ke={normal:st,gfm:ir,pedantic:ar},ae={normal:at,gfm:Ve,breaks:Cr,pedantic:Tr},_r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ct=e=>_r[e];function Z(e,t){if(t){if(z.escapeTest.test(e))return e.replace(z.escapeReplace,Ct)}else if(z.escapeTestNoEncode.test(e))return e.replace(z.escapeReplaceNoEncode,Ct);return e}function _t(e){try{e=encodeURI(e).replace(z.percentDecode,"%")}catch{return null}return e}function Rt(e,t){var i;const n=e.replace(z.findPipe,(a,o,l)=>{let u=!1,c=o;for(;--c>=0&&l[c]==="\\";)u=!u;return u?"|":" |"}),r=n.split(z.splitPipe);let s=0;if(r[0].trim()||r.shift(),r.length>0&&!((i=r.at(-1))!=null&&i.trim())&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(z.slashPipe,"|");return r}function oe(e,t,n){const r=e.length;if(r===0)return"";let s=0;for(;s<r&&e.charAt(r-s-1)===t;)s++;return e.slice(0,r-s)}function Rr(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return-1}function jt(e,t,n,r,s){const i=t.href,a=t.title||null,o=e[1].replace(s.other.outputLinkReplace,"$1");if(e[0].charAt(0)!=="!"){r.state.inLink=!0;const l={type:"link",raw:n,href:i,title:a,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,l}return{type:"image",raw:n,href:i,title:a,text:o}}function jr(e,t,n){const r=e.match(n.other.indentCodeCompensation);if(r===null)return t;const s=r[1];return t.split(`
`).map(i=>{const a=i.match(n.other.beginningSpace);if(a===null)return i;const[o]=a;return o.length>=s.length?i.slice(s.length):i}).join(`
`)}class Re{constructor(t){_(this,"options");_(this,"rules");_(this,"lexer");this.options=t||te}space(t){const n=this.rules.block.newline.exec(t);if(n&&n[0].length>0)return{type:"space",raw:n[0]}}code(t){const n=this.rules.block.code.exec(t);if(n){const r=n[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:n[0],codeBlockStyle:"indented",text:this.options.pedantic?r:oe(r,`
`)}}}fences(t){const n=this.rules.block.fences.exec(t);if(n){const r=n[0],s=jr(r,n[3]||"",this.rules);return{type:"code",raw:r,lang:n[2]?n[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):n[2],text:s}}}heading(t){const n=this.rules.block.heading.exec(t);if(n){let r=n[2].trim();if(this.rules.other.endingHash.test(r)){const s=oe(r,"#");(this.options.pedantic||!s||this.rules.other.endingSpaceChar.test(s))&&(r=s.trim())}return{type:"heading",raw:n[0],depth:n[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){const n=this.rules.block.hr.exec(t);if(n)return{type:"hr",raw:oe(n[0],`
`)}}blockquote(t){const n=this.rules.block.blockquote.exec(t);if(n){let r=oe(n[0],`
`).split(`
`),s="",i="";const a=[];for(;r.length>0;){let o=!1;const l=[];let u;for(u=0;u<r.length;u++)if(this.rules.other.blockquoteStart.test(r[u]))l.push(r[u]),o=!0;else if(!o)l.push(r[u]);else break;r=r.slice(u);const c=l.join(`
`),h=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");s=s?`${s}
${c}`:c,i=i?`${i}
${h}`:h;const f=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(h,a,!0),this.lexer.state.top=f,r.length===0)break;const m=a.at(-1);if((m==null?void 0:m.type)==="code")break;if((m==null?void 0:m.type)==="blockquote"){const g=m,p=g.raw+`
`+r.join(`
`),x=this.blockquote(p);a[a.length-1]=x,s=s.substring(0,s.length-g.raw.length)+x.raw,i=i.substring(0,i.length-g.text.length)+x.text;break}else if((m==null?void 0:m.type)==="list"){const g=m,p=g.raw+`
`+r.join(`
`),x=this.list(p);a[a.length-1]=x,s=s.substring(0,s.length-m.raw.length)+x.raw,i=i.substring(0,i.length-g.raw.length)+x.raw,r=p.substring(a.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:s,tokens:a,text:i}}}list(t){let n=this.rules.block.list.exec(t);if(n){let r=n[1].trim();const s=r.length>1,i={type:"list",raw:"",ordered:s,start:s?+r.slice(0,-1):"",loose:!1,items:[]};r=s?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=s?r:"[*+-]");const a=this.rules.other.listItemRegex(r);let o=!1;for(;t;){let u=!1,c="",h="";if(!(n=a.exec(t))||this.rules.block.hr.test(t))break;c=n[0],t=t.substring(c.length);let f=n[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,S=>" ".repeat(3*S.length)),m=t.split(`
`,1)[0],g=!f.trim(),p=0;if(this.options.pedantic?(p=2,h=f.trimStart()):g?p=n[1].length+1:(p=n[2].search(this.rules.other.nonSpaceChar),p=p>4?1:p,h=f.slice(p),p+=n[1].length),g&&this.rules.other.blankLine.test(m)&&(c+=m+`
`,t=t.substring(m.length+1),u=!0),!u){const S=this.rules.other.nextBulletRegex(p),E=this.rules.other.hrRegex(p),M=this.rules.other.fencesBeginRegex(p),P=this.rules.other.headingBeginRegex(p),D=this.rules.other.htmlBeginRegex(p);for(;t;){const W=t.split(`
`,1)[0];let H;if(m=W,this.options.pedantic?(m=m.replace(this.rules.other.listReplaceNesting,"  "),H=m):H=m.replace(this.rules.other.tabCharGlobal,"    "),M.test(m)||P.test(m)||D.test(m)||S.test(m)||E.test(m))break;if(H.search(this.rules.other.nonSpaceChar)>=p||!m.trim())h+=`
`+H.slice(p);else{if(g||f.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||M.test(f)||P.test(f)||E.test(f))break;h+=`
`+m}!g&&!m.trim()&&(g=!0),c+=W+`
`,t=t.substring(W.length+1),f=H.slice(p)}}i.loose||(o?i.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(o=!0));let x=null,R;this.options.gfm&&(x=this.rules.other.listIsTask.exec(h),x&&(R=x[0]!=="[ ] ",h=h.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:c,task:!!x,checked:R,loose:!1,text:h,tokens:[]}),i.raw+=c}const l=i.items.at(-1);if(l)l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let u=0;u<i.items.length;u++)if(this.lexer.state.top=!1,i.items[u].tokens=this.lexer.blockTokens(i.items[u].text,[]),!i.loose){const c=i.items[u].tokens.filter(f=>f.type==="space"),h=c.length>0&&c.some(f=>this.rules.other.anyLine.test(f.raw));i.loose=h}if(i.loose)for(let u=0;u<i.items.length;u++)i.items[u].loose=!0;return i}}html(t){const n=this.rules.block.html.exec(t);if(n)return{type:"html",block:!0,raw:n[0],pre:n[1]==="pre"||n[1]==="script"||n[1]==="style",text:n[0]}}def(t){const n=this.rules.block.def.exec(t);if(n){const r=n[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),s=n[2]?n[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=n[3]?n[3].substring(1,n[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):n[3];return{type:"def",tag:r,raw:n[0],href:s,title:i}}}table(t){var o;const n=this.rules.block.table.exec(t);if(!n||!this.rules.other.tableDelimiter.test(n[2]))return;const r=Rt(n[1]),s=n[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(o=n[3])!=null&&o.trim()?n[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],a={type:"table",raw:n[0],header:[],align:[],rows:[]};if(r.length===s.length){for(const l of s)this.rules.other.tableAlignRight.test(l)?a.align.push("right"):this.rules.other.tableAlignCenter.test(l)?a.align.push("center"):this.rules.other.tableAlignLeft.test(l)?a.align.push("left"):a.align.push(null);for(let l=0;l<r.length;l++)a.header.push({text:r[l],tokens:this.lexer.inline(r[l]),header:!0,align:a.align[l]});for(const l of i)a.rows.push(Rt(l,a.header.length).map((u,c)=>({text:u,tokens:this.lexer.inline(u),header:!1,align:a.align[c]})));return a}}lheading(t){const n=this.rules.block.lheading.exec(t);if(n)return{type:"heading",raw:n[0],depth:n[2].charAt(0)==="="?1:2,text:n[1],tokens:this.lexer.inline(n[1])}}paragraph(t){const n=this.rules.block.paragraph.exec(t);if(n){const r=n[1].charAt(n[1].length-1)===`
`?n[1].slice(0,-1):n[1];return{type:"paragraph",raw:n[0],text:r,tokens:this.lexer.inline(r)}}}text(t){const n=this.rules.block.text.exec(t);if(n)return{type:"text",raw:n[0],text:n[0],tokens:this.lexer.inline(n[0])}}escape(t){const n=this.rules.inline.escape.exec(t);if(n)return{type:"escape",raw:n[0],text:n[1]}}tag(t){const n=this.rules.inline.tag.exec(t);if(n)return!this.lexer.state.inLink&&this.rules.other.startATag.test(n[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(n[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(n[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(n[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:n[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:n[0]}}link(t){const n=this.rules.inline.link.exec(t);if(n){const r=n[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;const a=oe(r.slice(0,-1),"\\");if((r.length-a.length)%2===0)return}else{const a=Rr(n[2],"()");if(a>-1){const l=(n[0].indexOf("!")===0?5:4)+n[1].length+a;n[2]=n[2].substring(0,a),n[0]=n[0].substring(0,l).trim(),n[3]=""}}let s=n[2],i="";if(this.options.pedantic){const a=this.rules.other.pedanticHrefTitle.exec(s);a&&(s=a[1],i=a[3])}else i=n[3]?n[3].slice(1,-1):"";return s=s.trim(),this.rules.other.startAngleBracket.test(s)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?s=s.slice(1):s=s.slice(1,-1)),jt(n,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},n[0],this.lexer,this.rules)}}reflink(t,n){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){const s=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=n[s.toLowerCase()];if(!i){const a=r[0].charAt(0);return{type:"text",raw:a,text:a}}return jt(r,i,r[0],this.lexer,this.rules)}}emStrong(t,n,r=""){let s=this.rules.inline.emStrongLDelim.exec(t);if(!s||s[3]&&r.match(this.rules.other.unicodeAlphaNumeric))return;if(!(s[1]||s[2]||"")||!r||this.rules.inline.punctuation.exec(r)){const a=[...s[0]].length-1;let o,l,u=a,c=0;const h=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,n=n.slice(-1*t.length+a);(s=h.exec(n))!=null;){if(o=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!o)continue;if(l=[...o].length,s[3]||s[4]){u+=l;continue}else if((s[5]||s[6])&&a%3&&!((a+l)%3)){c+=l;continue}if(u-=l,u>0)continue;l=Math.min(l,l+u+c);const f=[...s[0]][0].length,m=t.slice(0,a+s.index+f+l);if(Math.min(a,l)%2){const p=m.slice(1,-1);return{type:"em",raw:m,text:p,tokens:this.lexer.inlineTokens(p)}}const g=m.slice(2,-2);return{type:"strong",raw:m,text:g,tokens:this.lexer.inlineTokens(g)}}}}codespan(t){const n=this.rules.inline.code.exec(t);if(n){let r=n[2].replace(this.rules.other.newLineCharGlobal," ");const s=this.rules.other.nonSpaceChar.test(r),i=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return s&&i&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:n[0],text:r}}}br(t){const n=this.rules.inline.br.exec(t);if(n)return{type:"br",raw:n[0]}}del(t){const n=this.rules.inline.del.exec(t);if(n)return{type:"del",raw:n[0],text:n[2],tokens:this.lexer.inlineTokens(n[2])}}autolink(t){const n=this.rules.inline.autolink.exec(t);if(n){let r,s;return n[2]==="@"?(r=n[1],s="mailto:"+r):(r=n[1],s=r),{type:"link",raw:n[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let n;if(n=this.rules.inline.url.exec(t)){let s,i;if(n[2]==="@")s=n[0],i="mailto:"+s;else{let a;do a=n[0],n[0]=((r=this.rules.inline._backpedal.exec(n[0]))==null?void 0:r[0])??"";while(a!==n[0]);s=n[0],n[1]==="www."?i="http://"+n[0]:i=n[0]}return{type:"link",raw:n[0],text:s,href:i,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(t){const n=this.rules.inline.text.exec(t);if(n){const r=this.lexer.state.inRawBlock;return{type:"text",raw:n[0],text:n[0],escaped:r}}}}class U{constructor(t){_(this,"tokens");_(this,"options");_(this,"state");_(this,"tokenizer");_(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||te,this.options.tokenizer=this.options.tokenizer||new Re,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:z,block:ke.normal,inline:ae.normal};this.options.pedantic?(n.block=ke.pedantic,n.inline=ae.pedantic):this.options.gfm&&(n.block=ke.gfm,this.options.breaks?n.inline=ae.breaks:n.inline=ae.gfm),this.tokenizer.rules=n}static get rules(){return{block:ke,inline:ae}}static lex(t,n){return new U(n).lex(t)}static lexInline(t,n){return new U(n).inlineTokens(t)}lex(t){t=t.replace(z.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){var s,i,a;for(this.options.pedantic&&(t=t.replace(z.tabCharGlobal,"    ").replace(z.spaceLine,""));t;){let o;if((i=(s=this.options.extensions)==null?void 0:s.block)!=null&&i.some(u=>(o=u.call({lexer:this},t,n))?(t=t.substring(o.raw.length),n.push(o),!0):!1))continue;if(o=this.tokenizer.space(t)){t=t.substring(o.raw.length);const u=n.at(-1);o.raw.length===1&&u!==void 0?u.raw+=`
`:n.push(o);continue}if(o=this.tokenizer.code(t)){t=t.substring(o.raw.length);const u=n.at(-1);(u==null?void 0:u.type)==="paragraph"||(u==null?void 0:u.type)==="text"?(u.raw+=`
`+o.raw,u.text+=`
`+o.text,this.inlineQueue.at(-1).src=u.text):n.push(o);continue}if(o=this.tokenizer.fences(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.heading(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.hr(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.blockquote(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.list(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.html(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.def(t)){t=t.substring(o.raw.length);const u=n.at(-1);(u==null?void 0:u.type)==="paragraph"||(u==null?void 0:u.type)==="text"?(u.raw+=`
`+o.raw,u.text+=`
`+o.raw,this.inlineQueue.at(-1).src=u.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.lheading(t)){t=t.substring(o.raw.length),n.push(o);continue}let l=t;if((a=this.options.extensions)!=null&&a.startBlock){let u=1/0;const c=t.slice(1);let h;this.options.extensions.startBlock.forEach(f=>{h=f.call({lexer:this},c),typeof h=="number"&&h>=0&&(u=Math.min(u,h))}),u<1/0&&u>=0&&(l=t.substring(0,u+1))}if(this.state.top&&(o=this.tokenizer.paragraph(l))){const u=n.at(-1);r&&(u==null?void 0:u.type)==="paragraph"?(u.raw+=`
`+o.raw,u.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=u.text):n.push(o),r=l.length!==t.length,t=t.substring(o.raw.length);continue}if(o=this.tokenizer.text(t)){t=t.substring(o.raw.length);const u=n.at(-1);(u==null?void 0:u.type)==="text"?(u.raw+=`
`+o.raw,u.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=u.text):n.push(o);continue}if(t){const u="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){var o,l,u;let r=t,s=null;if(this.tokens.links){const c=Object.keys(this.tokens.links);if(c.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)c.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,s.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let i=!1,a="";for(;t;){i||(a=""),i=!1;let c;if((l=(o=this.options.extensions)==null?void 0:o.inline)!=null&&l.some(f=>(c=f.call({lexer:this},t,n))?(t=t.substring(c.raw.length),n.push(c),!0):!1))continue;if(c=this.tokenizer.escape(t)){t=t.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.tag(t)){t=t.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.link(t)){t=t.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(c.raw.length);const f=n.at(-1);c.type==="text"&&(f==null?void 0:f.type)==="text"?(f.raw+=c.raw,f.text+=c.text):n.push(c);continue}if(c=this.tokenizer.emStrong(t,r,a)){t=t.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.codespan(t)){t=t.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.br(t)){t=t.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.del(t)){t=t.substring(c.raw.length),n.push(c);continue}if(c=this.tokenizer.autolink(t)){t=t.substring(c.raw.length),n.push(c);continue}if(!this.state.inLink&&(c=this.tokenizer.url(t))){t=t.substring(c.raw.length),n.push(c);continue}let h=t;if((u=this.options.extensions)!=null&&u.startInline){let f=1/0;const m=t.slice(1);let g;this.options.extensions.startInline.forEach(p=>{g=p.call({lexer:this},m),typeof g=="number"&&g>=0&&(f=Math.min(f,g))}),f<1/0&&f>=0&&(h=t.substring(0,f+1))}if(c=this.tokenizer.inlineText(h)){t=t.substring(c.raw.length),c.raw.slice(-1)!=="_"&&(a=c.raw.slice(-1)),i=!0;const f=n.at(-1);(f==null?void 0:f.type)==="text"?(f.raw+=c.raw,f.text+=c.text):n.push(c);continue}if(t){const f="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return n}}class je{constructor(t){_(this,"options");_(this,"parser");this.options=t||te}space(t){return""}code({text:t,lang:n,escaped:r}){var a;const s=(a=(n||"").match(z.notSpaceStart))==null?void 0:a[0],i=t.replace(z.endingNewline,"")+`
`;return s?'<pre><code class="language-'+Z(s)+'">'+(r?i:Z(i,!0))+`</code></pre>
`:"<pre><code>"+(r?i:Z(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}heading({tokens:t,depth:n}){return`<h${n}>${this.parser.parseInline(t)}</h${n}>
`}hr(t){return`<hr>
`}list(t){const n=t.ordered,r=t.start;let s="";for(let o=0;o<t.items.length;o++){const l=t.items[o];s+=this.listitem(l)}const i=n?"ol":"ul",a=n&&r!==1?' start="'+r+'"':"";return"<"+i+a+`>
`+s+"</"+i+`>
`}listitem(t){var r;let n="";if(t.task){const s=this.checkbox({checked:!!t.checked});t.loose?((r=t.tokens[0])==null?void 0:r.type)==="paragraph"?(t.tokens[0].text=s+" "+t.tokens[0].text,t.tokens[0].tokens&&t.tokens[0].tokens.length>0&&t.tokens[0].tokens[0].type==="text"&&(t.tokens[0].tokens[0].text=s+" "+Z(t.tokens[0].tokens[0].text),t.tokens[0].tokens[0].escaped=!0)):t.tokens.unshift({type:"text",raw:s+" ",text:s+" ",escaped:!0}):n+=s+" "}return n+=this.parser.parse(t.tokens,!!t.loose),`<li>${n}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let n="",r="";for(let i=0;i<t.header.length;i++)r+=this.tablecell(t.header[i]);n+=this.tablerow({text:r});let s="";for(let i=0;i<t.rows.length;i++){const a=t.rows[i];r="";for(let o=0;o<a.length;o++)r+=this.tablecell(a[o]);s+=this.tablerow({text:r})}return s&&(s=`<tbody>${s}</tbody>`),`<table>
<thead>
`+n+`</thead>
`+s+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){const n=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+n+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${Z(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:n,tokens:r}){const s=this.parser.parseInline(r),i=_t(t);if(i===null)return s;t=i;let a='<a href="'+t+'"';return n&&(a+=' title="'+Z(n)+'"'),a+=">"+s+"</a>",a}image({href:t,title:n,text:r}){const s=_t(t);if(s===null)return Z(r);t=s;let i=`<img src="${t}" alt="${r}"`;return n&&(i+=` title="${Z(n)}"`),i+=">",i}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:Z(t.text)}}class ot{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}}class G{constructor(t){_(this,"options");_(this,"renderer");_(this,"textRenderer");this.options=t||te,this.options.renderer=this.options.renderer||new je,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new ot}static parse(t,n){return new G(n).parse(t)}static parseInline(t,n){return new G(n).parseInline(t)}parse(t,n=!0){var s,i;let r="";for(let a=0;a<t.length;a++){const o=t[a];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[o.type]){const u=o,c=this.options.extensions.renderers[u.type].call({parser:this},u);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(u.type)){r+=c||"";continue}}const l=o;switch(l.type){case"space":{r+=this.renderer.space(l);continue}case"hr":{r+=this.renderer.hr(l);continue}case"heading":{r+=this.renderer.heading(l);continue}case"code":{r+=this.renderer.code(l);continue}case"table":{r+=this.renderer.table(l);continue}case"blockquote":{r+=this.renderer.blockquote(l);continue}case"list":{r+=this.renderer.list(l);continue}case"html":{r+=this.renderer.html(l);continue}case"paragraph":{r+=this.renderer.paragraph(l);continue}case"text":{let u=l,c=this.renderer.text(u);for(;a+1<t.length&&t[a+1].type==="text";)u=t[++a],c+=`
`+this.renderer.text(u);n?r+=this.renderer.paragraph({type:"paragraph",raw:c,text:c,tokens:[{type:"text",raw:c,text:c,escaped:!0}]}):r+=c;continue}default:{const u='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(u),"";throw new Error(u)}}}return r}parseInline(t,n=this.renderer){var s,i;let r="";for(let a=0;a<t.length;a++){const o=t[a];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[o.type]){const u=this.options.extensions.renderers[o.type].call({parser:this},o);if(u!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){r+=u||"";continue}}const l=o;switch(l.type){case"escape":{r+=n.text(l);break}case"html":{r+=n.html(l);break}case"link":{r+=n.link(l);break}case"image":{r+=n.image(l);break}case"strong":{r+=n.strong(l);break}case"em":{r+=n.em(l);break}case"codespan":{r+=n.codespan(l);break}case"br":{r+=n.br(l);break}case"del":{r+=n.del(l);break}case"text":{r+=n.text(l);break}default:{const u='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(u),"";throw new Error(u)}}}return r}}class ue{constructor(t){_(this,"options");_(this,"block");this.options=t||te}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}provideLexer(){return this.block?U.lex:U.lexInline}provideParser(){return this.block?G.parse:G.parseInline}}_(ue,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class Nr{constructor(...t){_(this,"defaults",Je());_(this,"options",this.setOptions);_(this,"parse",this.parseMarkdown(!0));_(this,"parseInline",this.parseMarkdown(!1));_(this,"Parser",G);_(this,"Renderer",je);_(this,"TextRenderer",ot);_(this,"Lexer",U);_(this,"Tokenizer",Re);_(this,"Hooks",ue);this.use(...t)}walkTokens(t,n){var s,i;let r=[];for(const a of t)switch(r=r.concat(n.call(this,a)),a.type){case"table":{const o=a;for(const l of o.header)r=r.concat(this.walkTokens(l.tokens,n));for(const l of o.rows)for(const u of l)r=r.concat(this.walkTokens(u.tokens,n));break}case"list":{const o=a;r=r.concat(this.walkTokens(o.items,n));break}default:{const o=a;(i=(s=this.defaults.extensions)==null?void 0:s.childTokens)!=null&&i[o.type]?this.defaults.extensions.childTokens[o.type].forEach(l=>{const u=o[l].flat(1/0);r=r.concat(this.walkTokens(u,n))}):o.tokens&&(r=r.concat(this.walkTokens(o.tokens,n)))}}return r}use(...t){const n=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{const s={...r};if(s.async=this.defaults.async||s.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){const a=n.renderers[i.name];a?n.renderers[i.name]=function(...o){let l=i.renderer.apply(this,o);return l===!1&&(l=a.apply(this,o)),l}:n.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const a=n[i.level];a?a.unshift(i.tokenizer):n[i.level]=[i.tokenizer],i.start&&(i.level==="block"?n.startBlock?n.startBlock.push(i.start):n.startBlock=[i.start]:i.level==="inline"&&(n.startInline?n.startInline.push(i.start):n.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(n.childTokens[i.name]=i.childTokens)}),s.extensions=n),r.renderer){const i=this.defaults.renderer||new je(this.defaults);for(const a in r.renderer){if(!(a in i))throw new Error(`renderer '${a}' does not exist`);if(["options","parser"].includes(a))continue;const o=a,l=r.renderer[o],u=i[o];i[o]=(...c)=>{let h=l.apply(i,c);return h===!1&&(h=u.apply(i,c)),h||""}}s.renderer=i}if(r.tokenizer){const i=this.defaults.tokenizer||new Re(this.defaults);for(const a in r.tokenizer){if(!(a in i))throw new Error(`tokenizer '${a}' does not exist`);if(["options","rules","lexer"].includes(a))continue;const o=a,l=r.tokenizer[o],u=i[o];i[o]=(...c)=>{let h=l.apply(i,c);return h===!1&&(h=u.apply(i,c)),h}}s.tokenizer=i}if(r.hooks){const i=this.defaults.hooks||new ue;for(const a in r.hooks){if(!(a in i))throw new Error(`hook '${a}' does not exist`);if(["options","block"].includes(a))continue;const o=a,l=r.hooks[o],u=i[o];ue.passThroughHooks.has(a)?i[o]=c=>{if(this.defaults.async)return Promise.resolve(l.call(i,c)).then(f=>u.call(i,f));const h=l.call(i,c);return u.call(i,h)}:i[o]=(...c)=>{let h=l.apply(i,c);return h===!1&&(h=u.apply(i,c)),h}}s.hooks=i}if(r.walkTokens){const i=this.defaults.walkTokens,a=r.walkTokens;s.walkTokens=function(o){let l=[];return l.push(a.call(this,o)),i&&(l=l.concat(i.call(this,o))),l}}this.defaults={...this.defaults,...s}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,n){return U.lex(t,n??this.defaults)}parser(t,n){return G.parse(t,n??this.defaults)}parseMarkdown(t){return(r,s)=>{const i={...s},a={...this.defaults,...i},o=this.onError(!!a.silent,!!a.async);if(this.defaults.async===!0&&i.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof r>"u"||r===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));a.hooks&&(a.hooks.options=a,a.hooks.block=t);const l=a.hooks?a.hooks.provideLexer():t?U.lex:U.lexInline,u=a.hooks?a.hooks.provideParser():t?G.parse:G.parseInline;if(a.async)return Promise.resolve(a.hooks?a.hooks.preprocess(r):r).then(c=>l(c,a)).then(c=>a.hooks?a.hooks.processAllTokens(c):c).then(c=>a.walkTokens?Promise.all(this.walkTokens(c,a.walkTokens)).then(()=>c):c).then(c=>u(c,a)).then(c=>a.hooks?a.hooks.postprocess(c):c).catch(o);try{a.hooks&&(r=a.hooks.preprocess(r));let c=l(r,a);a.hooks&&(c=a.hooks.processAllTokens(c)),a.walkTokens&&this.walkTokens(c,a.walkTokens);let h=u(c,a);return a.hooks&&(h=a.hooks.postprocess(h)),h}catch(c){return o(c)}}}onError(t,n){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){const s="<p>An error occurred:</p><pre>"+Z(r.message+"",!0)+"</pre>";return n?Promise.resolve(s):s}if(n)return Promise.reject(r);throw r}}}const ee=new Nr;function C(e,t){return ee.parse(e,t)}C.options=C.setOptions=function(e){return ee.setOptions(e),C.defaults=ee.defaults,Vt(C.defaults),C};C.getDefaults=Je;C.defaults=te;C.use=function(...e){return ee.use(...e),C.defaults=ee.defaults,Vt(C.defaults),C};C.walkTokens=function(e,t){return ee.walkTokens(e,t)};C.parseInline=ee.parseInline;C.Parser=G;C.parser=G.parse;C.Renderer=je;C.TextRenderer=ot;C.Lexer=U;C.lexer=U.lex;C.Tokenizer=Re;C.Hooks=ue;C.parse=C;C.options;C.setOptions;C.use;C.walkTokens;C.parseInline;G.parse;U.lex;var rn={},lt={},ct={},ne={},ut={},dt={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Doctype=e.CDATA=e.Tag=e.Style=e.Script=e.Comment=e.Directive=e.Text=e.Root=e.isTag=e.ElementType=void 0;var t;(function(r){r.Root="root",r.Text="text",r.Directive="directive",r.Comment="comment",r.Script="script",r.Style="style",r.Tag="tag",r.CDATA="cdata",r.Doctype="doctype"})(t=e.ElementType||(e.ElementType={}));function n(r){return r.type===t.Tag||r.type===t.Script||r.type===t.Style}e.isTag=n,e.Root=t.Root,e.Text=t.Text,e.Directive=t.Directive,e.Comment=t.Comment,e.Script=t.Script,e.Style=t.Style,e.Tag=t.Tag,e.CDATA=t.CDATA,e.Doctype=t.Doctype})(dt);var y={},Y=I&&I.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),de=I&&I.__assign||function(){return de=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},de.apply(this,arguments)};Object.defineProperty(y,"__esModule",{value:!0});y.cloneNode=y.hasChildren=y.isDocument=y.isDirective=y.isComment=y.isText=y.isCDATA=y.isTag=y.Element=y.Document=y.CDATA=y.NodeWithChildren=y.ProcessingInstruction=y.Comment=y.Text=y.DataNode=y.Node=void 0;var F=dt,ht=function(){function e(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}return Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.parent},set:function(t){this.parent=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){return this.prev},set:function(t){this.prev=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){return this.next},set:function(t){this.next=t},enumerable:!1,configurable:!0}),e.prototype.cloneNode=function(t){return t===void 0&&(t=!1),pt(this,t)},e}();y.Node=ht;var Ie=function(e){Y(t,e);function t(n){var r=e.call(this)||this;return r.data=n,r}return Object.defineProperty(t.prototype,"nodeValue",{get:function(){return this.data},set:function(n){this.data=n},enumerable:!1,configurable:!0}),t}(ht);y.DataNode=Ie;var sn=function(e){Y(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type=F.ElementType.Text,n}return Object.defineProperty(t.prototype,"nodeType",{get:function(){return 3},enumerable:!1,configurable:!0}),t}(Ie);y.Text=sn;var an=function(e){Y(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type=F.ElementType.Comment,n}return Object.defineProperty(t.prototype,"nodeType",{get:function(){return 8},enumerable:!1,configurable:!0}),t}(Ie);y.Comment=an;var on=function(e){Y(t,e);function t(n,r){var s=e.call(this,r)||this;return s.name=n,s.type=F.ElementType.Directive,s}return Object.defineProperty(t.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),t}(Ie);y.ProcessingInstruction=on;var Oe=function(e){Y(t,e);function t(n){var r=e.call(this)||this;return r.children=n,r}return Object.defineProperty(t.prototype,"firstChild",{get:function(){var n;return(n=this.children[0])!==null&&n!==void 0?n:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.children.length>0?this.children[this.children.length-1]:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"childNodes",{get:function(){return this.children},set:function(n){this.children=n},enumerable:!1,configurable:!0}),t}(ht);y.NodeWithChildren=Oe;var ln=function(e){Y(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type=F.ElementType.CDATA,n}return Object.defineProperty(t.prototype,"nodeType",{get:function(){return 4},enumerable:!1,configurable:!0}),t}(Oe);y.CDATA=ln;var cn=function(e){Y(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.type=F.ElementType.Root,n}return Object.defineProperty(t.prototype,"nodeType",{get:function(){return 9},enumerable:!1,configurable:!0}),t}(Oe);y.Document=cn;var un=function(e){Y(t,e);function t(n,r,s,i){s===void 0&&(s=[]),i===void 0&&(i=n==="script"?F.ElementType.Script:n==="style"?F.ElementType.Style:F.ElementType.Tag);var a=e.call(this,s)||this;return a.name=n,a.attribs=r,a.type=i,a}return Object.defineProperty(t.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tagName",{get:function(){return this.name},set:function(n){this.name=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"attributes",{get:function(){var n=this;return Object.keys(this.attribs).map(function(r){var s,i;return{name:r,value:n.attribs[r],namespace:(s=n["x-attribsNamespace"])===null||s===void 0?void 0:s[r],prefix:(i=n["x-attribsPrefix"])===null||i===void 0?void 0:i[r]}})},enumerable:!1,configurable:!0}),t}(Oe);y.Element=un;function dn(e){return(0,F.isTag)(e)}y.isTag=dn;function hn(e){return e.type===F.ElementType.CDATA}y.isCDATA=hn;function pn(e){return e.type===F.ElementType.Text}y.isText=pn;function fn(e){return e.type===F.ElementType.Comment}y.isComment=fn;function gn(e){return e.type===F.ElementType.Directive}y.isDirective=gn;function mn(e){return e.type===F.ElementType.Root}y.isDocument=mn;function Ar(e){return Object.prototype.hasOwnProperty.call(e,"children")}y.hasChildren=Ar;function pt(e,t){t===void 0&&(t=!1);var n;if(pn(e))n=new sn(e.data);else if(fn(e))n=new an(e.data);else if(dn(e)){var r=t?Ge(e.children):[],s=new un(e.name,de({},e.attribs),r);r.forEach(function(l){return l.parent=s}),e.namespace!=null&&(s.namespace=e.namespace),e["x-attribsNamespace"]&&(s["x-attribsNamespace"]=de({},e["x-attribsNamespace"])),e["x-attribsPrefix"]&&(s["x-attribsPrefix"]=de({},e["x-attribsPrefix"])),n=s}else if(hn(e)){var r=t?Ge(e.children):[],i=new ln(r);r.forEach(function(u){return u.parent=i}),n=i}else if(mn(e)){var r=t?Ge(e.children):[],a=new cn(r);r.forEach(function(u){return u.parent=a}),e["x-mode"]&&(a["x-mode"]=e["x-mode"]),n=a}else if(gn(e)){var o=new on(e.name,e.data);e["x-name"]!=null&&(o["x-name"]=e["x-name"],o["x-publicId"]=e["x-publicId"],o["x-systemId"]=e["x-systemId"]),n=o}else throw new Error("Not implemented yet: ".concat(e.type));return n.startIndex=e.startIndex,n.endIndex=e.endIndex,e.sourceCodeLocation!=null&&(n.sourceCodeLocation=e.sourceCodeLocation),n}y.cloneNode=pt;function Ge(e){for(var t=e.map(function(r){return pt(r,!0)}),n=1;n<t.length;n++)t[n].prev=t[n-1],t[n-1].next=t[n];return t}(function(e){var t=I&&I.__createBinding||(Object.create?function(o,l,u,c){c===void 0&&(c=u);var h=Object.getOwnPropertyDescriptor(l,u);(!h||("get"in h?!l.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return l[u]}}),Object.defineProperty(o,c,h)}:function(o,l,u,c){c===void 0&&(c=u),o[c]=l[u]}),n=I&&I.__exportStar||function(o,l){for(var u in o)u!=="default"&&!Object.prototype.hasOwnProperty.call(l,u)&&t(l,o,u)};Object.defineProperty(e,"__esModule",{value:!0}),e.DomHandler=void 0;var r=dt,s=y;n(y,e);var i={withStartIndices:!1,withEndIndices:!1,xmlMode:!1},a=function(){function o(l,u,c){this.dom=[],this.root=new s.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,typeof u=="function"&&(c=u,u=i),typeof l=="object"&&(u=l,l=void 0),this.callback=l??null,this.options=u??i,this.elementCB=c??null}return o.prototype.onparserinit=function(l){this.parser=l},o.prototype.onreset=function(){this.dom=[],this.root=new s.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null},o.prototype.onend=function(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))},o.prototype.onerror=function(l){this.handleCallback(l)},o.prototype.onclosetag=function(){this.lastNode=null;var l=this.tagStack.pop();this.options.withEndIndices&&(l.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(l)},o.prototype.onopentag=function(l,u){var c=this.options.xmlMode?r.ElementType.Tag:void 0,h=new s.Element(l,u,void 0,c);this.addNode(h),this.tagStack.push(h)},o.prototype.ontext=function(l){var u=this.lastNode;if(u&&u.type===r.ElementType.Text)u.data+=l,this.options.withEndIndices&&(u.endIndex=this.parser.endIndex);else{var c=new s.Text(l);this.addNode(c),this.lastNode=c}},o.prototype.oncomment=function(l){if(this.lastNode&&this.lastNode.type===r.ElementType.Comment){this.lastNode.data+=l;return}var u=new s.Comment(l);this.addNode(u),this.lastNode=u},o.prototype.oncommentend=function(){this.lastNode=null},o.prototype.oncdatastart=function(){var l=new s.Text(""),u=new s.CDATA([l]);this.addNode(u),l.parent=u,this.lastNode=l},o.prototype.oncdataend=function(){this.lastNode=null},o.prototype.onprocessinginstruction=function(l,u){var c=new s.ProcessingInstruction(l,u);this.addNode(c)},o.prototype.handleCallback=function(l){if(typeof this.callback=="function")this.callback(l,this.dom);else if(l)throw l},o.prototype.addNode=function(l){var u=this.tagStack[this.tagStack.length-1],c=u.children[u.children.length-1];this.options.withStartIndices&&(l.startIndex=this.parser.startIndex),this.options.withEndIndices&&(l.endIndex=this.parser.endIndex),u.children.push(l),c&&(l.prev=c,c.next=l),l.parent=u,this.lastNode=null},o}();e.DomHandler=a,e.default=a})(ut);var xn={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CARRIAGE_RETURN_PLACEHOLDER_REGEX=e.CARRIAGE_RETURN_PLACEHOLDER=e.CARRIAGE_RETURN_REGEX=e.CARRIAGE_RETURN=e.CASE_SENSITIVE_TAG_NAMES_MAP=e.CASE_SENSITIVE_TAG_NAMES=void 0,e.CASE_SENSITIVE_TAG_NAMES=["animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","linearGradient","radialGradient","textPath"],e.CASE_SENSITIVE_TAG_NAMES_MAP=e.CASE_SENSITIVE_TAG_NAMES.reduce(function(t,n){return t[n.toLowerCase()]=n,t},{}),e.CARRIAGE_RETURN="\r",e.CARRIAGE_RETURN_REGEX=new RegExp(e.CARRIAGE_RETURN,"g"),e.CARRIAGE_RETURN_PLACEHOLDER="__HTML_DOM_PARSER_CARRIAGE_RETURN_PLACEHOLDER_".concat(Date.now(),"__"),e.CARRIAGE_RETURN_PLACEHOLDER_REGEX=new RegExp(e.CARRIAGE_RETURN_PLACEHOLDER,"g")})(xn);Object.defineProperty(ne,"__esModule",{value:!0});ne.formatAttributes=bn;ne.escapeSpecialCharacters=Ir;ne.revertEscapedCharacters=kn;ne.formatDOM=wn;var we=ut,pe=xn;function Mr(e){return pe.CASE_SENSITIVE_TAG_NAMES_MAP[e]}function bn(e){for(var t={},n=0,r=e.length;n<r;n++){var s=e[n];t[s.name]=s.value}return t}function Lr(e){e=e.toLowerCase();var t=Mr(e);return t||e}function Ir(e){return e.replace(pe.CARRIAGE_RETURN_REGEX,pe.CARRIAGE_RETURN_PLACEHOLDER)}function kn(e){return e.replace(pe.CARRIAGE_RETURN_PLACEHOLDER_REGEX,pe.CARRIAGE_RETURN)}function wn(e,t,n){t===void 0&&(t=null);for(var r=[],s,i=0,a=e.length;i<a;i++){var o=e[i];switch(o.nodeType){case 1:{var l=Lr(o.nodeName);s=new we.Element(l,bn(o.attributes)),s.children=wn(l==="template"?o.content.childNodes:o.childNodes,s);break}case 3:s=new we.Text(kn(o.nodeValue));break;case 8:s=new we.Comment(o.nodeValue);break;default:continue}var u=r[i-1]||null;u&&(u.next=s),s.parent=t,s.prev=u,s.next=null,r.push(s)}return n&&(s=new we.ProcessingInstruction(n.substring(0,n.indexOf(" ")).toLowerCase(),n),s.next=r[0]||null,s.parent=t,r.unshift(s),r[1]&&(r[1].prev=r[0])),r}Object.defineProperty(ct,"__esModule",{value:!0});ct.default=zr;var Or=ne,Nt="html",At="head",ve="body",Pr=/<([a-zA-Z]+[0-9]?)/,Mt=/<head[^]*>/i,Lt=/<body[^]*>/i,Ne=function(e,t){throw new Error("This browser does not support `document.implementation.createHTMLDocument`")},qe=function(e,t){throw new Error("This browser does not support `DOMParser.prototype.parseFromString`")},It=typeof window=="object"&&window.DOMParser;if(typeof It=="function"){var Dr=new It,$r="text/html";qe=function(e,t){return t&&(e="<".concat(t,">").concat(e,"</").concat(t,">")),Dr.parseFromString(e,$r)},Ne=qe}if(typeof document=="object"&&document.implementation){var ye=document.implementation.createHTMLDocument();Ne=function(e,t){if(t){var n=ye.documentElement.querySelector(t);return n&&(n.innerHTML=e),ye}return ye.documentElement.innerHTML=e,ye}}var Se=typeof document=="object"&&document.createElement("template"),Xe;Se&&Se.content&&(Xe=function(e){return Se.innerHTML=e,Se.content.childNodes});function zr(e){var t,n;e=(0,Or.escapeSpecialCharacters)(e);var r=e.match(Pr),s=r&&r[1]?r[1].toLowerCase():"";switch(s){case Nt:{var i=qe(e);if(!Mt.test(e)){var a=i.querySelector(At);(t=a==null?void 0:a.parentNode)===null||t===void 0||t.removeChild(a)}if(!Lt.test(e)){var a=i.querySelector(ve);(n=a==null?void 0:a.parentNode)===null||n===void 0||n.removeChild(a)}return i.querySelectorAll(Nt)}case At:case ve:{var o=Ne(e).querySelectorAll(s);return Lt.test(e)&&Mt.test(e)?o[0].parentNode.childNodes:o}default:{if(Xe)return Xe(e);var a=Ne(e,ve).querySelector(ve);return a.childNodes}}}var Br=I&&I.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(lt,"__esModule",{value:!0});lt.default=Gr;var Hr=Br(ct),Fr=ne,Ur=/<(![a-zA-Z\s]+)>/;function Gr(e){if(typeof e!="string")throw new TypeError("First argument must be a string");if(!e)return[];var t=e.match(Ur),n=t?t[1]:void 0;return(0,Fr.formatDOM)((0,Hr.default)(e),null,n)}var Pe={},q={},De={},Wr=0;De.SAME=Wr;var Vr=1;De.CAMELCASE=Vr;De.possibleStandardNames={accept:0,acceptCharset:1,"accept-charset":"acceptCharset",accessKey:1,action:0,allowFullScreen:1,alt:0,as:0,async:0,autoCapitalize:1,autoComplete:1,autoCorrect:1,autoFocus:1,autoPlay:1,autoSave:1,capture:0,cellPadding:1,cellSpacing:1,challenge:0,charSet:1,checked:0,children:0,cite:0,class:"className",classID:1,className:1,cols:0,colSpan:1,content:0,contentEditable:1,contextMenu:1,controls:0,controlsList:1,coords:0,crossOrigin:1,dangerouslySetInnerHTML:1,data:0,dateTime:1,default:0,defaultChecked:1,defaultValue:1,defer:0,dir:0,disabled:0,disablePictureInPicture:1,disableRemotePlayback:1,download:0,draggable:0,encType:1,enterKeyHint:1,for:"htmlFor",form:0,formMethod:1,formAction:1,formEncType:1,formNoValidate:1,formTarget:1,frameBorder:1,headers:0,height:0,hidden:0,high:0,href:0,hrefLang:1,htmlFor:1,httpEquiv:1,"http-equiv":"httpEquiv",icon:0,id:0,innerHTML:1,inputMode:1,integrity:0,is:0,itemID:1,itemProp:1,itemRef:1,itemScope:1,itemType:1,keyParams:1,keyType:1,kind:0,label:0,lang:0,list:0,loop:0,low:0,manifest:0,marginWidth:1,marginHeight:1,max:0,maxLength:1,media:0,mediaGroup:1,method:0,min:0,minLength:1,multiple:0,muted:0,name:0,noModule:1,nonce:0,noValidate:1,open:0,optimum:0,pattern:0,placeholder:0,playsInline:1,poster:0,preload:0,profile:0,radioGroup:1,readOnly:1,referrerPolicy:1,rel:0,required:0,reversed:0,role:0,rows:0,rowSpan:1,sandbox:0,scope:0,scoped:0,scrolling:0,seamless:0,selected:0,shape:0,size:0,sizes:0,span:0,spellCheck:1,src:0,srcDoc:1,srcLang:1,srcSet:1,start:0,step:0,style:0,summary:0,tabIndex:1,target:0,title:0,type:0,useMap:1,value:0,width:0,wmode:0,wrap:0,about:0,accentHeight:1,"accent-height":"accentHeight",accumulate:0,additive:0,alignmentBaseline:1,"alignment-baseline":"alignmentBaseline",allowReorder:1,alphabetic:0,amplitude:0,arabicForm:1,"arabic-form":"arabicForm",ascent:0,attributeName:1,attributeType:1,autoReverse:1,azimuth:0,baseFrequency:1,baselineShift:1,"baseline-shift":"baselineShift",baseProfile:1,bbox:0,begin:0,bias:0,by:0,calcMode:1,capHeight:1,"cap-height":"capHeight",clip:0,clipPath:1,"clip-path":"clipPath",clipPathUnits:1,clipRule:1,"clip-rule":"clipRule",color:0,colorInterpolation:1,"color-interpolation":"colorInterpolation",colorInterpolationFilters:1,"color-interpolation-filters":"colorInterpolationFilters",colorProfile:1,"color-profile":"colorProfile",colorRendering:1,"color-rendering":"colorRendering",contentScriptType:1,contentStyleType:1,cursor:0,cx:0,cy:0,d:0,datatype:0,decelerate:0,descent:0,diffuseConstant:1,direction:0,display:0,divisor:0,dominantBaseline:1,"dominant-baseline":"dominantBaseline",dur:0,dx:0,dy:0,edgeMode:1,elevation:0,enableBackground:1,"enable-background":"enableBackground",end:0,exponent:0,externalResourcesRequired:1,fill:0,fillOpacity:1,"fill-opacity":"fillOpacity",fillRule:1,"fill-rule":"fillRule",filter:0,filterRes:1,filterUnits:1,floodOpacity:1,"flood-opacity":"floodOpacity",floodColor:1,"flood-color":"floodColor",focusable:0,fontFamily:1,"font-family":"fontFamily",fontSize:1,"font-size":"fontSize",fontSizeAdjust:1,"font-size-adjust":"fontSizeAdjust",fontStretch:1,"font-stretch":"fontStretch",fontStyle:1,"font-style":"fontStyle",fontVariant:1,"font-variant":"fontVariant",fontWeight:1,"font-weight":"fontWeight",format:0,from:0,fx:0,fy:0,g1:0,g2:0,glyphName:1,"glyph-name":"glyphName",glyphOrientationHorizontal:1,"glyph-orientation-horizontal":"glyphOrientationHorizontal",glyphOrientationVertical:1,"glyph-orientation-vertical":"glyphOrientationVertical",glyphRef:1,gradientTransform:1,gradientUnits:1,hanging:0,horizAdvX:1,"horiz-adv-x":"horizAdvX",horizOriginX:1,"horiz-origin-x":"horizOriginX",ideographic:0,imageRendering:1,"image-rendering":"imageRendering",in2:0,in:0,inlist:0,intercept:0,k1:0,k2:0,k3:0,k4:0,k:0,kernelMatrix:1,kernelUnitLength:1,kerning:0,keyPoints:1,keySplines:1,keyTimes:1,lengthAdjust:1,letterSpacing:1,"letter-spacing":"letterSpacing",lightingColor:1,"lighting-color":"lightingColor",limitingConeAngle:1,local:0,markerEnd:1,"marker-end":"markerEnd",markerHeight:1,markerMid:1,"marker-mid":"markerMid",markerStart:1,"marker-start":"markerStart",markerUnits:1,markerWidth:1,mask:0,maskContentUnits:1,maskUnits:1,mathematical:0,mode:0,numOctaves:1,offset:0,opacity:0,operator:0,order:0,orient:0,orientation:0,origin:0,overflow:0,overlinePosition:1,"overline-position":"overlinePosition",overlineThickness:1,"overline-thickness":"overlineThickness",paintOrder:1,"paint-order":"paintOrder",panose1:0,"panose-1":"panose1",pathLength:1,patternContentUnits:1,patternTransform:1,patternUnits:1,pointerEvents:1,"pointer-events":"pointerEvents",points:0,pointsAtX:1,pointsAtY:1,pointsAtZ:1,prefix:0,preserveAlpha:1,preserveAspectRatio:1,primitiveUnits:1,property:0,r:0,radius:0,refX:1,refY:1,renderingIntent:1,"rendering-intent":"renderingIntent",repeatCount:1,repeatDur:1,requiredExtensions:1,requiredFeatures:1,resource:0,restart:0,result:0,results:0,rotate:0,rx:0,ry:0,scale:0,security:0,seed:0,shapeRendering:1,"shape-rendering":"shapeRendering",slope:0,spacing:0,specularConstant:1,specularExponent:1,speed:0,spreadMethod:1,startOffset:1,stdDeviation:1,stemh:0,stemv:0,stitchTiles:1,stopColor:1,"stop-color":"stopColor",stopOpacity:1,"stop-opacity":"stopOpacity",strikethroughPosition:1,"strikethrough-position":"strikethroughPosition",strikethroughThickness:1,"strikethrough-thickness":"strikethroughThickness",string:0,stroke:0,strokeDasharray:1,"stroke-dasharray":"strokeDasharray",strokeDashoffset:1,"stroke-dashoffset":"strokeDashoffset",strokeLinecap:1,"stroke-linecap":"strokeLinecap",strokeLinejoin:1,"stroke-linejoin":"strokeLinejoin",strokeMiterlimit:1,"stroke-miterlimit":"strokeMiterlimit",strokeWidth:1,"stroke-width":"strokeWidth",strokeOpacity:1,"stroke-opacity":"strokeOpacity",suppressContentEditableWarning:1,suppressHydrationWarning:1,surfaceScale:1,systemLanguage:1,tableValues:1,targetX:1,targetY:1,textAnchor:1,"text-anchor":"textAnchor",textDecoration:1,"text-decoration":"textDecoration",textLength:1,textRendering:1,"text-rendering":"textRendering",to:0,transform:0,typeof:0,u1:0,u2:0,underlinePosition:1,"underline-position":"underlinePosition",underlineThickness:1,"underline-thickness":"underlineThickness",unicode:0,unicodeBidi:1,"unicode-bidi":"unicodeBidi",unicodeRange:1,"unicode-range":"unicodeRange",unitsPerEm:1,"units-per-em":"unitsPerEm",unselectable:0,vAlphabetic:1,"v-alphabetic":"vAlphabetic",values:0,vectorEffect:1,"vector-effect":"vectorEffect",version:0,vertAdvY:1,"vert-adv-y":"vertAdvY",vertOriginX:1,"vert-origin-x":"vertOriginX",vertOriginY:1,"vert-origin-y":"vertOriginY",vHanging:1,"v-hanging":"vHanging",vIdeographic:1,"v-ideographic":"vIdeographic",viewBox:1,viewTarget:1,visibility:0,vMathematical:1,"v-mathematical":"vMathematical",vocab:0,widths:0,wordSpacing:1,"word-spacing":"wordSpacing",writingMode:1,"writing-mode":"writingMode",x1:0,x2:0,x:0,xChannelSelector:1,xHeight:1,"x-height":"xHeight",xlinkActuate:1,"xlink:actuate":"xlinkActuate",xlinkArcrole:1,"xlink:arcrole":"xlinkArcrole",xlinkHref:1,"xlink:href":"xlinkHref",xlinkRole:1,"xlink:role":"xlinkRole",xlinkShow:1,"xlink:show":"xlinkShow",xlinkTitle:1,"xlink:title":"xlinkTitle",xlinkType:1,"xlink:type":"xlinkType",xmlBase:1,"xml:base":"xmlBase",xmlLang:1,"xml:lang":"xmlLang",xmlns:0,"xml:space":"xmlSpace",xmlnsXlink:1,"xmlns:xlink":"xmlnsXlink",xmlSpace:1,y1:0,y2:0,y:0,yChannelSelector:1,z:0,zoomAndPan:1};const vn=0,K=1,$e=2,ze=3,ft=4,yn=5,Sn=6;function qr(e){return $.hasOwnProperty(e)?$[e]:null}function B(e,t,n,r,s,i,a){this.acceptsBooleans=t===$e||t===ze||t===ft,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}const $={},Xr=["children","dangerouslySetInnerHTML","defaultValue","defaultChecked","innerHTML","suppressContentEditableWarning","suppressHydrationWarning","style"];Xr.forEach(e=>{$[e]=new B(e,vn,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(([e,t])=>{$[e]=new B(e,K,!1,t,null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(e=>{$[e]=new B(e,$e,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(e=>{$[e]=new B(e,$e,!1,e,null,!1,!1)});["allowFullScreen","async","autoFocus","autoPlay","controls","default","defer","disabled","disablePictureInPicture","disableRemotePlayback","formNoValidate","hidden","loop","noModule","noValidate","open","playsInline","readOnly","required","reversed","scoped","seamless","itemScope"].forEach(e=>{$[e]=new B(e,ze,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(e=>{$[e]=new B(e,ze,!0,e,null,!1,!1)});["capture","download"].forEach(e=>{$[e]=new B(e,ft,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(e=>{$[e]=new B(e,Sn,!1,e,null,!1,!1)});["rowSpan","start"].forEach(e=>{$[e]=new B(e,yn,!1,e.toLowerCase(),null,!1,!1)});const gt=/[\-\:]([a-z])/g,mt=e=>e[1].toUpperCase();["accent-height","alignment-baseline","arabic-form","baseline-shift","cap-height","clip-path","clip-rule","color-interpolation","color-interpolation-filters","color-profile","color-rendering","dominant-baseline","enable-background","fill-opacity","fill-rule","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","glyph-name","glyph-orientation-horizontal","glyph-orientation-vertical","horiz-adv-x","horiz-origin-x","image-rendering","letter-spacing","lighting-color","marker-end","marker-mid","marker-start","overline-position","overline-thickness","paint-order","panose-1","pointer-events","rendering-intent","shape-rendering","stop-color","stop-opacity","strikethrough-position","strikethrough-thickness","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","text-decoration","text-rendering","underline-position","underline-thickness","unicode-bidi","unicode-range","units-per-em","v-alphabetic","v-hanging","v-ideographic","v-mathematical","vector-effect","vert-adv-y","vert-origin-x","vert-origin-y","word-spacing","writing-mode","xmlns:xlink","x-height"].forEach(e=>{const t=e.replace(gt,mt);$[t]=new B(t,K,!1,e,null,!1,!1)});["xlink:actuate","xlink:arcrole","xlink:role","xlink:show","xlink:title","xlink:type"].forEach(e=>{const t=e.replace(gt,mt);$[t]=new B(t,K,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(e=>{const t=e.replace(gt,mt);$[t]=new B(t,K,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(e=>{$[e]=new B(e,K,!1,e.toLowerCase(),null,!1,!1)});const Zr="xlinkHref";$[Zr]=new B("xlinkHref",K,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(e=>{$[e]=new B(e,K,!1,e.toLowerCase(),null,!0,!0)});const{CAMELCASE:Yr,SAME:Kr,possibleStandardNames:Ot}=De,Qr=":A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",Jr=Qr+"\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",es=RegExp.prototype.test.bind(new RegExp("^(data|aria)-["+Jr+"]*$")),ts=Object.keys(Ot).reduce((e,t)=>{const n=Ot[t];return n===Kr?e[t]=t:n===Yr?e[t.toLowerCase()]=t:e[t]=n,e},{});q.BOOLEAN=ze;q.BOOLEANISH_STRING=$e;q.NUMERIC=yn;q.OVERLOADED_BOOLEAN=ft;q.POSITIVE_NUMERIC=Sn;q.RESERVED=vn;q.STRING=K;q.getPropertyInfo=qr;q.isCustomAttribute=es;q.possibleStandardNames=ts;var xt={},bt={},Pt=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,ns=/\n/g,rs=/^\s*/,ss=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,is=/^:\s*/,as=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,os=/^[;\s]*/,ls=/^\s+|\s+$/g,cs=`
`,Dt="/",$t="*",Q="",us="comment",ds="declaration",hs=function(e,t){if(typeof e!="string")throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var n=1,r=1;function s(g){var p=g.match(ns);p&&(n+=p.length);var x=g.lastIndexOf(cs);r=~x?g.length-x:r+g.length}function i(){var g={line:n,column:r};return function(p){return p.position=new a(g),u(),p}}function a(g){this.start=g,this.end={line:n,column:r},this.source=t.source}a.prototype.content=e;function o(g){var p=new Error(t.source+":"+n+":"+r+": "+g);if(p.reason=g,p.filename=t.source,p.line=n,p.column=r,p.source=e,!t.silent)throw p}function l(g){var p=g.exec(e);if(p){var x=p[0];return s(x),e=e.slice(x.length),p}}function u(){l(rs)}function c(g){var p;for(g=g||[];p=h();)p!==!1&&g.push(p);return g}function h(){var g=i();if(!(Dt!=e.charAt(0)||$t!=e.charAt(1))){for(var p=2;Q!=e.charAt(p)&&($t!=e.charAt(p)||Dt!=e.charAt(p+1));)++p;if(p+=2,Q===e.charAt(p-1))return o("End of comment missing");var x=e.slice(2,p-2);return r+=2,s(x),e=e.slice(p),r+=2,g({type:us,comment:x})}}function f(){var g=i(),p=l(ss);if(p){if(h(),!l(is))return o("property missing ':'");var x=l(as),R=g({type:ds,property:zt(p[0].replace(Pt,Q)),value:x?zt(x[0].replace(Pt,Q)):Q});return l(os),R}}function m(){var g=[];c(g);for(var p;p=f();)p!==!1&&(g.push(p),c(g));return g}return u(),m()};function zt(e){return e?e.replace(ls,Q):Q}var ps=I&&I.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bt,"__esModule",{value:!0});bt.default=gs;var fs=ps(hs);function gs(e,t){var n=null;if(!e||typeof e!="string")return n;var r=(0,fs.default)(e),s=typeof t=="function";return r.forEach(function(i){if(i.type==="declaration"){var a=i.property,o=i.value;s?t(a,o,i):o&&(n=n||{},n[a]=o)}}),n}var Be={};Object.defineProperty(Be,"__esModule",{value:!0});Be.camelCase=void 0;var ms=/^--[a-zA-Z0-9_-]+$/,xs=/-([a-z])/g,bs=/^[^-]+$/,ks=/^-(webkit|moz|ms|o|khtml)-/,ws=/^-(ms)-/,vs=function(e){return!e||bs.test(e)||ms.test(e)},ys=function(e,t){return t.toUpperCase()},Bt=function(e,t){return"".concat(t,"-")},Ss=function(e,t){return t===void 0&&(t={}),vs(e)?e:(e=e.toLowerCase(),t.reactCompat?e=e.replace(ws,Bt):e=e.replace(ks,Bt),e.replace(xs,ys))};Be.camelCase=Ss;var Es=I&&I.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Ts=Es(bt),Cs=Be;function Ze(e,t){var n={};return!e||typeof e!="string"||(0,Ts.default)(e,function(r,s){r&&s&&(n[(0,Cs.camelCase)(r,t)]=s)}),n}Ze.default=Ze;var _s=Ze;(function(e){var t=I&&I.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(e,"__esModule",{value:!0}),e.returnFirstArg=e.canTextBeChildOfNode=e.ELEMENTS_WITH_NO_TEXT_CHILDREN=e.PRESERVE_CUSTOM_ATTRIBUTES=void 0,e.isCustomComponent=i,e.setStyleProp=o;var n=k,r=t(_s),s=new Set(["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"]);function i(c,h){return c.includes("-")?!s.has(c):!!(h&&typeof h.is=="string")}var a={reactCompat:!0};function o(c,h){if(typeof c=="string"){if(!c.trim()){h.style={};return}try{h.style=(0,r.default)(c,a)}catch{h.style={}}}}e.PRESERVE_CUSTOM_ATTRIBUTES=Number(n.version.split(".")[0])>=16,e.ELEMENTS_WITH_NO_TEXT_CHILDREN=new Set(["tr","tbody","thead","tfoot","colgroup","table","head","html","frameset"]);var l=function(c){return!e.ELEMENTS_WITH_NO_TEXT_CHILDREN.has(c.name)};e.canTextBeChildOfNode=l;var u=function(c){return c};e.returnFirstArg=u})(xt);Object.defineProperty(Pe,"__esModule",{value:!0});Pe.default=As;var le=q,Ht=xt,Rs=["checked","value"],js=["input","select","textarea"],Ns={reset:!0,submit:!0};function As(e,t){e===void 0&&(e={});var n={},r=!!(e.type&&Ns[e.type]);for(var s in e){var i=e[s];if((0,le.isCustomAttribute)(s)){n[s]=i;continue}var a=s.toLowerCase(),o=Ft(a);if(o){var l=(0,le.getPropertyInfo)(o);switch(Rs.includes(o)&&js.includes(t)&&!r&&(o=Ft("default"+a)),n[o]=i,l&&l.type){case le.BOOLEAN:n[o]=!0;break;case le.OVERLOADED_BOOLEAN:i===""&&(n[o]=!0);break}continue}Ht.PRESERVE_CUSTOM_ATTRIBUTES&&(n[s]=i)}return(0,Ht.setStyleProp)(e.style,n),n}function Ft(e){return le.possibleStandardNames[e]}var kt={},Ms=I&&I.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(kt,"__esModule",{value:!0});kt.default=En;var We=k,Ls=Ms(Pe),he=xt,Is={cloneElement:We.cloneElement,createElement:We.createElement,isValidElement:We.isValidElement};function En(e,t){t===void 0&&(t={});for(var n=[],r=typeof t.replace=="function",s=t.transform||he.returnFirstArg,i=t.library||Is,a=i.cloneElement,o=i.createElement,l=i.isValidElement,u=e.length,c=0;c<u;c++){var h=e[c];if(r){var f=t.replace(h,c);if(l(f)){u>1&&(f=a(f,{key:f.key||c})),n.push(s(f,h,c));continue}}if(h.type==="text"){var m=!h.data.trim().length;if(m&&h.parent&&!(0,he.canTextBeChildOfNode)(h.parent)||t.trim&&m)continue;n.push(s(h.data,h,c));continue}var g=h,p={};Os(g)?((0,he.setStyleProp)(g.attribs.style,g.attribs),p=g.attribs):g.attribs&&(p=(0,Ls.default)(g.attribs,g.name));var x=void 0;switch(h.type){case"script":case"style":h.children[0]&&(p.dangerouslySetInnerHTML={__html:h.children[0].data});break;case"tag":h.name==="textarea"&&h.children[0]?p.defaultValue=h.children[0].data:h.children&&h.children.length&&(x=En(h.children,t));break;default:continue}u>1&&(p.key=c),n.push(s(o(h.name,p,x),h,c))}return n.length===1?n[0]:n}function Os(e){return he.PRESERVE_CUSTOM_ATTRIBUTES&&e.type==="tag"&&(0,he.isCustomComponent)(e.name,e.attribs)}(function(e){var t=I&&I.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(e,"__esModule",{value:!0}),e.htmlToDOM=e.domToReact=e.attributesToProps=e.Text=e.ProcessingInstruction=e.Element=e.Comment=void 0,e.default=o;var n=t(lt);e.htmlToDOM=n.default;var r=t(Pe);e.attributesToProps=r.default;var s=t(kt);e.domToReact=s.default;var i=ut;Object.defineProperty(e,"Comment",{enumerable:!0,get:function(){return i.Comment}}),Object.defineProperty(e,"Element",{enumerable:!0,get:function(){return i.Element}}),Object.defineProperty(e,"ProcessingInstruction",{enumerable:!0,get:function(){return i.ProcessingInstruction}}),Object.defineProperty(e,"Text",{enumerable:!0,get:function(){return i.Text}});var a={lowerCaseAttributeNames:!1};function o(l,u){if(typeof l!="string")throw new TypeError("First argument must be a string");return l?(0,s.default)((0,n.default)(l,(u==null?void 0:u.htmlparser2)||a),u):[]}})(rn);const Ut=Pn(rn),Ps=Ut.default||Ut,Ds=({children:e,className:t=""})=>{const n=i=>[/<!DOCTYPE\s+html>/i,/<html[\s>]/i,/<head[\s>]/i,/<body[\s>]/i,/<\/[a-z]+>/i].some(o=>o.test(i));let r=e.replace(/\n\s*\n/g,`
`);n(r)&&!r.includes("```")&&(r=r.replace(/</g,"&lt;").replace(/>/g,"&gt;"));const s=C(r);return d.jsx("div",{className:`
        prose prose-slate dark:prose-invert
        dark:prose-p:text-gray-300
        dark:prose-strong:text-gray-100
        dark:prose-headings:text-gray-100
        prose-a:text-blue-600 dark:prose-a:text-blue-400 hover:prose-a:text-blue-500 dark:hover:prose-a:text-blue-300
        [&_ul>li]:marker:text-black dark:[&_ul>li]:marker:text-gray-400
        prose-p:my-0.5
        [&_ul]:mt-[-1.875rem] [&_ul]:mb-[-2.75rem]
        [&_li>ul]:mt-[0.125rem]
        [&_ol]:mt-[-1.875rem] [&_ol]:mb-[-1.875rem]
        [&_ul+ol]:mt-[1.125rem]
        [&_ul_li+ol]:mt-[1.125rem]
        [&_li]:mt-[-28px]
        [&_ul_li_ol]:mt-[1rem] 
        [&_ul>li>ol]:mt-[0.5rem]
        prose-headings:my-1
        prose-pre:my-1
        prose-blockquote:my-1 dark:prose-blockquote:text-gray-300 dark:prose-blockquote:border-gray-700
        prose-hr:my-1
        [&>*:first-child]:!mt-0 
        [&>*:last-child]:!mb-[-30px]
        ${t}
      `,children:Ps(s)})},$s=({content:e,isExpanded:t})=>{const n=k.useMemo(()=>{try{const s=e.trim().split(`
`).filter(i=>i.trim()).map(i=>i.split(",").map(a=>a.trim()));return t?s:s.slice(0,4)}catch{return[]}},[e,t]);return n.length?d.jsx("div",{className:"overflow-x-auto scrollbar-themed",children:d.jsx("table",{className:"min-w-full text-xs md:text-sm dark:text-gray-200",children:d.jsx("tbody",{children:n.map((r,s)=>d.jsx("tr",{className:`
                                ${s===0?"bg-gray-100 dark:bg-gray-700 font-medium":""}
                                ${s%2===1?"bg-gray-50 dark:bg-gray-800":""}
                            `,children:r.map((i,a)=>d.jsx("td",{className:"border border-gray-200 dark:border-gray-600 p-2 truncate max-w-[200px] dark:text-white",title:i,children:i},a))},s))})})}):d.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"No valid CSV content found"})};function wt(e){return!!(e.toLowerCase().endsWith(".html")||e.toLowerCase().endsWith(".htm"))}function vt(e){return!!(e.toLowerCase().endsWith(".mermaid")||e.toLowerCase().endsWith(".mmd"))}function Tn(e){return!!e.toLowerCase().endsWith(".csv")}function Cn(e){try{return new TextDecoder().decode(Uint8Array.from(atob(e),t=>t.charCodeAt(0)))}catch{return atob(e)}}const zs=({file:e,className:t,onDownload:n,onPreview:r,onRun:s})=>{const[i,a]=k.useState(!1),[o,l]=k.useState(!1),u=Cn(e.content),c=Tn(e.name),h=wt(e.name)||vt(e.name),f=()=>{navigator.clipboard.writeText(u),l(!0),setTimeout(()=>l(!1),1e3)};return d.jsx("div",{className:`mt-2 w-full max-w-sm md:max-w-md ${t}`,children:d.jsxs("div",{className:"relative",children:[d.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg",children:[d.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 dark:border-gray-700",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("svg",{className:"w-4 h-4 mr-2 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),d.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 max-w-[250px] truncate",children:e.name})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[h&&s&&d.jsx("button",{onClick:s,className:"p-1.5 rounded bg-green-200 dark:bg-green-700 hover:bg-green-300 dark:hover:bg-green-600 transition-colors",title:"Run code",children:d.jsxs("svg",{className:"w-4 h-4 text-green-800 dark:text-green-300",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"}),d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 8l6 4-6 4V8z"})]})}),r&&d.jsx("button",{onClick:r,className:"p-1.5 rounded bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:"Preview file",children:d.jsxs("svg",{className:"w-4 h-4 text-gray-600 dark:text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),d.jsx("button",{onClick:n,className:"p-1.5 rounded bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:"Download file",children:d.jsx("svg",{className:"w-4 h-4 text-gray-600 dark:text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),d.jsx("button",{onClick:f,className:`p-1.5 rounded bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-all duration-300 ${o?"scale-110":"scale-100"}`,title:o?"Copied!":"Copy content",children:o?d.jsx("svg",{className:"w-4 h-4 text-green-600 dark:text-green-400 transition-all duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):d.jsx("svg",{className:"w-4 h-4 text-gray-600 dark:text-gray-300 transition-all duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})]}),d.jsx("div",{className:`p-3 scrollbar-themed ${i?"overflow-auto max-h-[500px]":"overflow-hidden"}`,children:c?d.jsx($s,{content:u,isExpanded:i}):d.jsx("pre",{className:"font-mono text-xs md:text-sm text-gray-800 dark:text-gray-200",children:d.jsx("code",{children:i?u:u.split(`
`).slice(0,5).join(`
`)})})})]}),(!c&&u.split(`
`).length>5||c&&u.split(`
`).length>4)&&d.jsx("button",{onClick:()=>a(!i),className:"mt-2 text-xs md:text-sm text-solace-blue dark:text-solace-green hover:opacity-80 transition-opacity",children:i?"Show less":"Show more"})]})})},Bs=({file:e,onPreview:t,onRun:n})=>{var o,l;const r=(o=e.mime_type)==null?void 0:o.startsWith("image/"),s=((l=e.mime_type)==null?void 0:l.startsWith("text/"))||e.name.match(/\.(txt|json|csv|md|log|html|htm|css|js|mmd|mermaid)$/i),i=wt(e.name)||vt(e.name),a=()=>{const u=new Blob([Uint8Array.from(atob(e.content),f=>f.charCodeAt(0))],{type:e.mime_type??"application/octet-stream"}),c=URL.createObjectURL(u),h=document.createElement("a");h.href=c,h.download=e.name,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(c)};return r?d.jsxs("div",{className:"w-full max-w-[85vw] md:max-w-md",children:[d.jsx("img",{src:`data:${e.mime_type};base64,${e.content}`,alt:e.name,className:"w-full h-auto object-contain rounded-lg shadow-md"}),d.jsx("div",{className:"mt-2",children:d.jsx(Ye,{filename:e.name,onDownload:a})})]}):s?d.jsx("div",{className:"w-full max-w-[80vw] md:max-w-md ",children:d.jsx(zs,{file:e,onDownload:a,onPreview:t?()=>t(e):void 0,onRun:i&&n?()=>n(e):void 0})}):d.jsx("div",{className:"w-full max-w-[80vw] md:max-w-md",children:d.jsx(Ye,{filename:e.name,onDownload:a})})},Ye=({filename:e,onDownload:t})=>d.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 dark:bg-gray-700 rounded-lg p-1.5 md:p-2 w-full max-w-[85vw] md:max-w-md",children:[d.jsxs("div",{className:"flex items-center gap-1 md:gap-2 flex-1 min-w-0",children:[d.jsx("div",{className:"bg-gray-200 dark:bg-gray-600 p-1.5 md:p-2 rounded flex-shrink-0",children:d.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),d.jsx("span",{className:"text-xs md:text-sm text-gray-700 dark:text-gray-300 truncate",children:e})]}),t&&d.jsx("button",{onClick:t,className:"flex-shrink-0 bg-solace-blue dark:bg-solace-green text-white px-2 md:px-3 py-1 rounded text-xs md:text-sm hover:opacity-80 transition-opacity",children:"Download"})]}),Hs=k.memo(()=>d.jsxs("span",{className:"inline-flex items-center ml-2",children:[d.jsx("style",{children:`
        .loading-dot {
          opacity: 0.3;
          animation: loadingFade 1.2s ease-in-out infinite;
        }
        .loading-dot:nth-child(1) {
          animation-delay: 0s;
        }
        .loading-dot:nth-child(2) {
          animation-delay: 0.4s;
        }
        .loading-dot:nth-child(3) {
          animation-delay: 0.8s;
        }
        @keyframes loadingFade {
          0% {
            opacity: 0.3;
            transform: scale(0.8);
          }
          50% {
            opacity: 1;
            transform: scale(1);
          }
          100% {
            opacity: 0.3;
            transform: scale(0.8);
          }
        }
      `}),[...Array(3)].map((e,t)=>d.jsx("span",{className:"loading-dot w-1.5 h-1.5 mx-0.5 rounded-full bg-current inline-block"},t))]}));function Fs(e){return re({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"},child:[]}]})(e)}function Us(e){return re({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M0 56v240c0 13.255 10.745 24 24 24h80c13.255 0 24-10.745 24-24V56c0-13.255-10.745-24-24-24H24C10.745 32 0 42.745 0 56zm40 200c0-13.255 10.745-24 24-24s24 10.745 24 24-10.745 24-24 24-24-10.745-24-24zm272 256c-20.183 0-29.485-39.293-33.931-57.795-5.206-21.666-10.589-44.07-25.393-58.902-32.469-32.524-49.503-73.967-89.117-113.111a11.98 11.98 0 0 1-3.558-8.521V59.901c0-6.541 5.243-11.878 11.783-11.998 15.831-.29 36.694-9.079 52.651-16.178C256.189 17.598 295.709.017 343.995 0h2.844c42.777 0 93.363.413 113.774 29.737 8.392 12.057 10.446 27.034 6.148 44.632 16.312 17.053 25.063 48.863 16.382 74.757 17.544 23.432 19.143 56.132 9.308 79.469l.11.11c11.893 11.949 19.523 31.259 19.439 49.197-.156 30.352-26.157 58.098-59.553 58.098H350.723C358.03 364.34 384 388.132 384 430.548 384 504 336 512 312 512z"},child:[]}]})(e)}function Gs(e){return re({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M104 224H24c-13.255 0-24 10.745-24 24v240c0 13.255 10.745 24 24 24h80c13.255 0 24-10.745 24-24V248c0-13.255-10.745-24-24-24zM64 472c-13.255 0-24-10.745-24-24s10.745-24 24-24 24 10.745 24 24-10.745 24-24 24zM384 81.452c0 42.416-25.97 66.208-33.277 94.548h101.723c33.397 0 59.397 27.746 59.553 58.098.084 17.938-7.546 37.249-19.439 49.197l-.11.11c9.836 23.337 8.237 56.037-9.308 79.469 8.681 25.895-.069 57.704-16.382 74.757 4.298 17.598 2.244 32.575-6.148 44.632C440.202 511.587 389.616 512 346.839 512l-2.845-.001c-48.287-.017-87.806-17.598-119.56-31.725-15.957-7.099-36.821-15.887-52.651-16.178-6.54-.12-11.783-5.457-11.783-11.998v-213.77c0-3.2 1.282-6.271 3.558-8.521 39.614-39.144 56.648-80.587 89.117-113.111 14.804-14.832 20.188-37.236 25.393-58.902C282.515 39.293 291.817 0 312 0c24 0 72 8 72 81.452z"},child:[]}]})(e)}const Ee=({messageId:e,messageText:t,metadata:n})=>{const[r,s]=k.useState(!1),[i,a]=k.useState(""),[o,l]=k.useState(!1),u=async(m,g)=>{try{let p=Ke("csrf_token");if(p||(p=await Qe()),!(await fetch("/api/v1/feedback",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":p??""},body:JSON.stringify({messageId:n==null?void 0:n.messageId,sessionId:n==null?void 0:n.sessionId,isPositive:m,comment:g})})).ok)throw new Error("Failed to submit feedback")}catch(p){console.error("Error submitting feedback:",p)}},c=async m=>{m?(await u(!0),l(!0)):s(!0)},h=async()=>{i.trim()&&(await u(!1,i),s(!1),l(!0))},f=async()=>{await navigator.clipboard.writeText(t)};return o?d.jsx("div",{className:"text-sm text-gray-500 mt-1 italic",children:"Thanks for your feedback"}):d.jsxs("div",{className:"flex flex-col gap-1",children:[d.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[d.jsx("button",{onClick:()=>c(!0),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors duration-200",disabled:o,title:"Helpful",children:d.jsx(Gs,{className:"text-gray-400 hover:text-green-500 w-3.5 h-3.5"})}),d.jsx("button",{onClick:()=>c(!1),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors duration-200",disabled:o,title:"Not helpful",children:d.jsx(Us,{className:"text-gray-400 hover:text-red-500 w-3.5 h-3.5"})}),d.jsx("button",{onClick:f,className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-colors duration-200",title:"Copy message",children:d.jsx(Fs,{className:"text-gray-400 hover:text-blue-500 w-3.5 h-3.5"})})]}),r&&d.jsx("div",{className:"flex flex-col gap-2 mt-1 animate-slideDown",children:d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",value:i,onChange:m=>a(m.target.value),className:`flex-1 px-3 py-1.5 text-sm border rounded-md min-w-[230px]
                dark:bg-gray-700 dark:border-gray-600 
                focus:outline-none focus:ring-1 focus:ring-solace-blue 
                dark:focus:ring-solace-green dark:text-white
                transition-all duration-200`,placeholder:"What went wrong? (optional)",onKeyDown:m=>{m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),h()),m.key==="Escape"&&s(!1)},autoFocus:!0}),d.jsx("button",{onClick:h,className:`px-3 py-1.5 bg-solace-blue text-white text-sm font-medium rounded-md 
                hover:bg-blue-600 transition-colors duration-200 dark:bg-solace-green`,children:"Send"}),d.jsx("button",{onClick:()=>s(!1),className:`px-3 py-1.5 bg-gray-200 text-gray-700 text-sm font-medium rounded-md 
                hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600 
                transition-colors duration-200`,children:"Cancel"})]})})]})};function Ws({msg:e,idx:t,alreadyRendered:n,onPreviewFile:r,onRunFile:s}){var l,u;const{configCollectFeedback:i}=Ae(),a=()=>{if(!e.statusMessage)return null;const c=e.statusMessage.message.includes("✅"),h=e.text.includes("There was an error processing your request. Please try again."),f=e.statusMessage.message.includes("🤔");return d.jsx("div",{className:`
        mb-2 rounded-md overflow-hidden
        ${c?"bg-green-50 dark:bg-green-900/30 border-green-200 dark:border-green-800/50":h?"bg-red-50 dark:bg-red-900/30 border-red-200 dark:border-red-800/50":f?"bg-blue-50 dark:bg-blue-900/30 border-blue-200 dark:border-blue-800/50":"bg-gray-100 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600/50"}
        border
        text-gray-800 dark:text-gray-200
        shadow-sm
      `,children:d.jsxs("div",{className:"px-3 py-2 flex items-center space-x-2.5",children:[!c&&!h&&d.jsx("span",{className:"flex-shrink-0 h-2.5 w-2.5 rounded-full bg-solace-blue dark:bg-solace-green animate-pulse"}),d.jsx("span",{className:"text-sm",children:e.statusMessage.message})]})})},o=c=>c.isUser?d.jsx("span",{children:c.text}):c.isStatusMessage?d.jsx("span",{children:c.text.split(" ").map((h,f,m)=>d.jsxs("span",{children:[h,f===m.length-1?d.jsx(Hs,{}):" "]},`${h}-${f}`))}):d.jsx(Ds,{children:c.text});return d.jsx("div",{className:`my-4 flex ${e.isUser?"justify-end":"justify-start"}`,children:d.jsxs("div",{className:"relative",children:[d.jsxs("div",{className:`${e.isUser?"mr-3 flex flex-col items-end pb-4":"ml-3 flex flex-col items-start pb-4"}`,children:[e.statusMessage&&a(),((l=e.text)==null?void 0:l.trim())&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:`p-3 rounded-lg whitespace-pre-wrap max-w-[85vw] sm:max-w-[70vw] ${e.isUser?"bg-solace-blue text-white dark:bg-solace-green ml-4 ":"bg-gray-200 dark:bg-gray-600 text-black dark:text-white"}`,children:o(e)}),i&&!e.isUser&&!e.isStatusMessage&&(e.metadata?d.jsx(Ee,{messageId:t,messageText:e.text,metadata:e.metadata}):d.jsx(Ee,{messageId:t,messageText:e.text}))]}),e.files&&e.files.length>0&&d.jsxs("div",{className:"mt-2 space-y-2 self-stretch",children:[e.files.map((c,h)=>d.jsx(Bs,{file:c,onPreview:r?()=>r(c):void 0,onRun:s?()=>s(c):void 0},`bot-file-${t}-${h}`)),!((u=e.text)!=null&&u.trim())&&i&&!e.isUser&&!e.isStatusMessage&&(e.metadata?d.jsx(Ee,{messageId:t,messageText:e.text,metadata:e.metadata}):d.jsx(Ee,{messageId:t,messageText:e.text}))]}),e.uploadedFiles&&e.uploadedFiles.length>0&&d.jsx("div",{className:"mt-2 space-y-2 self-stretch ml-4",children:e.uploadedFiles.map((c,h)=>d.jsx(Ye,{filename:c.name},`uploaded-file-${t}-${h}`))})]}),d.jsx("span",{className:`absolute -top-6 ${e.isUser?"right-[-20px]":"left-[-20px]"} w-8 h-8 flex items-center justify-center rounded-full ${e.isUser?"bg-gray-200 text-white dark:bg-gray-600":"bg-transparent dark:bg-transparent text-black dark:text-white"}`,children:e.isUser?"👤":d.jsx("img",{src:"solace_chat_icon.png",alt:"Bot Icon",style:{width:24,height:24}})})]})})}const Vs=k.memo(Ws);function qs({messages:e,scrollToBottom:t,messagesEndRef:n,onPreviewFile:r,onRunFile:s}){const i=k.useRef(new Set),a=k.useMemo(()=>e.map((o,l)=>{var h;if(!o)return null;const u=!o.isUser&&!o.isStatusMessage,c=i.current.has(l);return u&&!c&&i.current.add(l),d.jsx(Vs,{msg:o,idx:l,alreadyRendered:c,onPreviewFile:r,onRunFile:s},`${(h=o.metadata)==null?void 0:h.sessionId}-${l}-${o.isUser?"user":"bot"}`)}),[e,r]);return e.length===0&&i.current.clear(),d.jsxs("div",{className:"space-y-4 py-4",children:[a,d.jsx("div",{ref:n,className:"h-0"})]})}const Xs=({file:e,onRemove:t})=>d.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 dark:bg-gray-700 rounded-lg p-2 max-w-fit",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"bg-gray-200 dark:bg-gray-600 p-2 rounded",children:d.jsx("svg",{className:"w-5 h-5 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),d.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.name})]}),d.jsx("button",{onClick:t,className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-full",type:"button",children:d.jsx("svg",{className:"w-4 h-4 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]});function Zs({userInput:e,setUserInput:t,handleSubmit:n,isResponding:r,selectedFiles:s,setSelectedFiles:i}){const a=k.useRef(null),[o,l]=k.useState(!1),u=k.useRef(null),c=()=>{var x;(x=a.current)==null||x.click()},h=x=>{const R=x.target.files;if(R){const S=Array.from(R).filter(E=>!s.some(M=>M.name===E.name&&M.size===E.size));i(E=>[...E,...S])}},f=x=>{i(R=>R.filter((S,E)=>E!==x)),a.current&&(a.current.value="")},m=x=>{n(x,s),i([]),a.current&&(a.current.value=""),u.current&&(u.current.style.height="24px"),l(!1)},g=x=>{const R=x.target;R.style.height="auto";let S;window.innerWidth<640?S=80:window.innerWidth<768?S=150:S=200;const E=Math.min(R.scrollHeight,S);R.style.height=`${E}px`,l(R.scrollHeight>30),t(x.target.value)},p=x=>{x.key==="Enter"&&!x.shiftKey&&(x.preventDefault(),m(x))};return d.jsxs("div",{className:"bg-white dark:bg-gray-900",children:[d.jsx("div",{className:"px-4 sm:px-6 flex flex-wrap gap-2",children:s.map((x,R)=>d.jsx(Xs,{file:x,onRemove:()=>f(R)},x.name))}),d.jsxs("form",{onSubmit:m,className:"flex items-end px-4 sm:px-6 py-2 sm:rounded-lg",children:[d.jsx("input",{type:"file",ref:a,className:"hidden",multiple:!0,onChange:h}),d.jsxs("div",{className:`flex-1 flex items-end gap-2 px-4 py-2 border border-gray-300 dark:border-gray-600 ${o?"rounded-lg":"rounded-full"} bg-white dark:bg-gray-700`,children:[d.jsx("button",{type:"button",onClick:c,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 flex-shrink-0",children:d.jsx(qn,{className:"w-5 h-5"})}),d.jsx("textarea",{ref:u,value:e,onChange:g,onKeyDown:p,placeholder:"Write your question...",rows:1,className:"flex-1 bg-transparent dark:text-white focus:outline-none resize-none overflow-y-auto scrollbar-hide min-h-[24px]",style:{lineHeight:"24px"}})]}),d.jsx("button",{type:"submit",disabled:r,className:`ml-2 w-10 h-10 flex items-center justify-center text-white rounded-full transform transition-all duration-200 ease-in-out ${r?"bg-gray-400 cursor-not-allowed opacity-50":"bg-solace-blue dark:bg-solace-green hover:bg-blue-700 dark:hover:bg-green-600 hover:scale-105"}`,children:d.jsx(Xn,{className:"w-5 h-5"})})]})]})}const Ys=({content:e,width:t})=>{const n=k.useMemo(()=>{try{return e.trim().split(`
`).filter(i=>i.trim()).map(i=>i.split(",").map(a=>a.trim()))}catch{return[]}},[e]);return n.length?d.jsx("div",{className:"overflow-x-auto scrollbar-themed",style:{maxWidth:`${t}px`,maxHeight:"calc(100vh - 200px)"},children:d.jsxs("table",{className:"min-w-full text-sm dark:text-gray-200",children:[d.jsx("thead",{className:"bg-gray-100 dark:bg-gray-700 sticky top-0 z-10",children:n.length>0&&d.jsx("tr",{children:n[0].map((r,s)=>d.jsx("th",{className:"border border-gray-200 dark:border-gray-600 p-2 font-medium text-left dark:text-white",children:r},s))})}),d.jsx("tbody",{children:n.slice(1).map((r,s)=>d.jsx("tr",{className:s%2===0?"bg-white dark:bg-gray-900":"bg-gray-50 dark:bg-gray-800",children:r.map((i,a)=>d.jsx("td",{className:"border border-gray-200 dark:border-gray-600 p-2 truncate dark:text-white",title:i,children:i},a))},s))})]})}):d.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"No valid CSV content found"})},Ks=({content:e,width:t})=>{const[n,r]=k.useState("");return k.useEffect(()=>{const s=e.replace(/<script>([\s\S]*?)<\/script>/g,(i,a)=>`<script>(function() {
${a}
})();<\/script>`);r(s)},[e]),d.jsx("div",{className:"bg-white rounded-md overflow-hidden shadow-md",style:{maxWidth:`${t}px`,height:"calc(100vh - 200px)"},children:d.jsx("iframe",{srcDoc:n,title:"HTML Preview",sandbox:"allow-scripts allow-same-origin allow-downloads",className:"w-full h-full border-none"})})},Qs=({content:e,width:t})=>{const[n,r]=k.useState("");return k.useEffect(()=>{r(`<!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"><\/script>
        <script src="https://cdn.jsdelivr.net/npm/panzoom@9.4.0/dist/panzoom.min.js"><\/script>
        <script>
          document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
              startOnLoad: true,
              theme: 'default',
              fontFamily: 'arial, sans-serif',
              logLevel: 'error',
              securityLevel: 'strict'
            });
            
            // Initialize panzoom after Mermaid rendering
            mermaid.run().then(() => {
              const diagramContainer = document.getElementById('diagram-container');
              if (diagramContainer) {
                const pz = panzoom(diagramContainer, {
                  maxZoom: 10,
                  minZoom: 0.1,
                  smoothScroll: true,
                  bounds: true,
                  boundsPadding: 0.1
                });
                
                // Add zoom controls
                document.getElementById('reset').addEventListener('click', () => {
                  pz.moveTo(0, 0);
                  pz.zoomAbs(0, 0, 1);
                });
              }
            });
            
            // Listen for message to send SVG data back to parent
            window.addEventListener('message', function(event) {
              if (event.data && event.data.action === 'getMermaidSvg') {
                const svgElement = document.querySelector('.mermaid svg');
                if (svgElement) {
                  const svgData = new XMLSerializer().serializeToString(svgElement);
                  window.parent.postMessage({
                    action: 'downloadSvg',
                    svgData: svgData,
                    filename: event.data.filename || 'mermaid-diagram.svg'
                  }, '*');
                } else {
                  console.error('SVG element not found');
                }
              }
            });
          });
        <\/script>
        <style>
          html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
          }
          .container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
          }
          .diagram-wrapper {
            flex: 1;
            overflow: hidden;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #f9f9f9;
          }
          #diagram-container {
            transform-origin: 0 0;
            cursor: grab;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            background-color: white;
            padding: 20px;
            border-radius: 5px;
          }
          #diagram-container:active {
            cursor: grabbing;
          }
          .mermaid {
            display: flex;
            justify-content: center;
          }
          .controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 5px;
          }
          .control-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background-color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
          }
          .control-btn:hover {
            background-color: #f0f0f0;
          }
          .instructions {
            position: fixed;
            top: 10px;
            left: 10px;
            background-color: rgba(255,255,255,0.8);
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            color: #666;
          }
        </style>
      </head>
      <body>
        <div class="container">
          <div class="diagram-wrapper">
            <div id="diagram-container">
              <div class="mermaid">
                ${e}
              </div>
            </div>
          </div>
          <div class="instructions">
            Drag to pan and scroll to zoom
          </div>
          <div class="controls">
            <button id="reset" class="control-btn">↺</button>
          </div>
        </div>
      </body>
      </html>`)},[e]),d.jsx("div",{className:"bg-white rounded-md overflow-hidden shadow-md",style:{maxWidth:`${t}px`,height:"calc(100vh - 200px)"},children:d.jsx("iframe",{srcDoc:n,title:"Mermaid Diagram",sandbox:"allow-scripts allow-same-origin allow-downloads",className:"w-full h-full border-none"})})},Js=({content:e,width:t,rendererType:n})=>{switch(n){case"mermaid":return d.jsx(Qs,{content:e,width:t});case"html":return d.jsx(Ks,{content:e,width:t});default:return d.jsx("div",{children:"Unsupported content type"})}},ei=({file:e,onClose:t,initialWidth:n=window.innerWidth*.4,autoRun:r=!1})=>{const[s,i]=k.useState(n),[a,o]=k.useState(!1),[l,u]=k.useState(r),c=k.useRef(null),h=Cn(e.content),f=Tn(e.name),m=wt(e.name),g=vt(e.name);k.useEffect(()=>{(m||g)&&r&&u(!0)},[r,e,m,g]),k.useEffect(()=>{const S=E=>{if(E.data&&E.data.action==="downloadSvg"){const M=new Blob([E.data.svgData],{type:"image/svg+xml"}),P=URL.createObjectURL(M),D=document.createElement("a");D.download=E.data.filename,D.href=P,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(P)}};return window.addEventListener("message",S),()=>{window.removeEventListener("message",S)}},[]);const p=()=>{var E;const S=(E=c.current)==null?void 0:E.querySelector("iframe");if(S!=null&&S.contentWindow){const M=window.location.origin;S.contentWindow.postMessage({action:"getMermaidSvg",filename:`${e.name.replace(/\.[^/.]+$/,"")}.svg`},M)}};k.useEffect(()=>(a?document.body.classList.add("resize-active"):document.body.classList.remove("resize-active"),()=>{document.body.classList.remove("resize-active")}),[a]),k.useEffect(()=>{const S=M=>{if(!a)return;M.preventDefault();const P=document.body.clientWidth,D=P-M.clientX,W=Math.max(300,Math.min(D,P*.7));i(W)},E=()=>{o(!1)};return a&&(window.addEventListener("mousemove",S),window.addEventListener("mouseup",E)),()=>{window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",E)}},[a]);const x=S=>{S.preventDefault(),o(!0)},R=()=>{u(S=>!S)};return d.jsxs("div",{ref:c,className:`fixed top-[72px] right-0 bottom-0 bg-white dark:bg-gray-800 shadow-lg border-l border-gray-200 dark:border-gray-700 z-30 flex flex-col ${a?"select-none":""}`,style:{width:`${s}px`},children:[d.jsx("div",{className:"absolute top-0 bottom-0 left-0 w-1 cursor-col-resize hover:bg-solace-blue dark:hover:bg-solace-green",onMouseDown:x}),d.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[d.jsxs("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 truncate",children:["Preview: ",e.name]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[(m||g)&&d.jsx("button",{onClick:R,className:`px-3 py-1.5 rounded-full text-white shadow-sm transition-all duration-150 text-xs font-medium flex items-center ${l?"bg-red-500 hover:bg-red-600 active:bg-red-700":"bg-green-500 hover:bg-green-600 active:bg-green-700"}`,children:l?d.jsxs(d.Fragment,{children:[d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1.5",viewBox:"0 0 20 20",fill:"currentColor",children:d.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z",clipRule:"evenodd"})}),"Stop"]}):d.jsxs(d.Fragment,{children:[d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1.5",viewBox:"0 0 20 20",fill:"currentColor",children:d.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})}),"Run"]})}),g&&l&&d.jsxs("button",{onClick:p,className:"px-3 py-1.5 rounded-full bg-green-500 hover:bg-green-600 active:bg-green-700 text-white shadow-sm transition-all duration-150 text-xs font-medium flex items-center",children:[d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"SVG"]}),d.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700",children:d.jsx("svg",{className:"w-5 h-5 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),d.jsx("div",{className:"flex-1 pt-4 px-4 pb-8 overflow-auto",children:f?d.jsx(Ys,{content:h,width:s-32}):(m||g)&&l?d.jsx(Js,{content:h,width:s-32,rendererType:g?"mermaid":"html"}):d.jsx("pre",{className:"text-xs md:text-sm text-gray-800 dark:text-gray-200 whitespace-pre-wrap break-words",children:h})})]})};function ti({messages:e,userInput:t,setUserInput:n,handleSubmit:r,isResponding:s,selectedFiles:i,setSelectedFiles:a,onPreviewOpen:o,onPreviewClose:l}){const[u,c]=k.useState(!1),[h,f]=k.useState(null),[m,g]=k.useState(!1),p=k.useRef(!1),x=k.useRef(0),R=k.useRef(null),S=100,E=k.useCallback(()=>{const L=window.scrollY,X=window.innerHeight;return document.body.offsetHeight-(L+X)<S},[]),M=k.useCallback(()=>{if(p.current)return;const L=window.scrollY,X=L<x.current;X&&!E()?c(!0):!X&&E()&&c(!1),x.current=L},[E]);k.useEffect(()=>(x.current=window.scrollY,window.addEventListener("scroll",M),()=>{window.removeEventListener("scroll",M)}),[M]),k.useEffect(()=>{e.length===1&&c(!1)},[e]);const P=k.useCallback(()=>{var L;p.current=!0,(L=R.current)==null||L.scrollIntoView({behavior:"smooth"}),setTimeout(()=>{p.current=!1,E()&&c(!1)},300)},[E]);k.useEffect(()=>{u||P()},[e,u,P]);const D=k.useCallback((L,X=!1)=>{f(L),g(X),o&&o()},[o]),W=k.useCallback(L=>{D(L,!0)},[D]);k.useEffect(()=>{const L=()=>{h&&H()};return window.addEventListener("new-chat-session",L),()=>{window.removeEventListener("new-chat-session",L)}},[h]);const H=k.useCallback(()=>{f(null),g(!1),l&&l()},[l]);return d.jsxs("div",{className:"flex flex-col h-full relative",children:[d.jsx("div",{className:h?"flex-1 pr-[300px] transition-all duration-300":"flex-1",children:d.jsx(qs,{messages:e,scrollToBottom:P,messagesEndRef:R,onPreviewFile:D,onRunFile:W})}),h&&d.jsx(ei,{file:h,onClose:H,autoRun:m}),u&&d.jsx("div",{className:`
            fixed bottom-20 left-0 
            z-20 
            transition-all duration-300
            ${h?"right-[300px]":"right-0"}
          `,children:d.jsx("div",{className:`
              flex justify-center
              ${h?"md:w-[60%] ml-[60px] mr-[60px]":"md:w-2/4 w-11/12 mx-auto"}
            `,children:d.jsx("button",{type:"button",onClick:P,className:`p-2 rounded-full bg-slate-300 dark:bg-gray-700 text-black dark:text-gray-200 
                      shadow hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors`,children:d.jsx(Vn,{className:"w-4 h-4",strokeWidth:3})})})}),d.jsx("div",{className:`
          fixed bottom-0 left-0 
          z-10 
          bg-white/95 dark:bg-gray-900/95 
          backdrop-blur-sm
          transition-all duration-300
          ${h?"right-[300px]":"right-0"}
        `,children:d.jsx("div",{className:`py-2
            ${h?"md:w-[60%] ml-[60px] mr-[60px]":"md:w-2/4 w-11/12 mx-auto"}
          `,children:d.jsx(Zs,{userInput:t,setUserInput:n,handleSubmit:L=>{r(L,i),a([])},isResponding:s,selectedFiles:i,setSelectedFiles:a})})})]})}function ni({darkMode:e,setDarkMode:t,className:n=""}){const r=()=>{const s=!e;t(s),localStorage.setItem("darkMode",JSON.stringify(s))};return d.jsx("button",{onClick:r,className:`
        p-2 rounded-full transition-all duration-200
        hover:bg-white/15 active:scale-95
        flex items-center justify-center
        ${n}
      `,title:e?"Switch to Light Mode":"Switch to Dark Mode",children:e?d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"})}):d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"})})})}function ri(){const{configUseAuthorization:e,configWelcomeMessage:t,configServerUrl:n,configBotName:r}=Ae(),[s,i]=k.useState(!1),[a,o]=k.useState([]),[l,u]=k.useState(!1),c=k.useRef(0),h={serverUrl:n},f={text:t||"👋 Hi! I'm Agent Mesh. How can I help you today?",isUser:!1},m=e,g=e,{isValidatingToken:p,isAuthenticated:x,handleLogin:R}=Dn({serverUrl:h.serverUrl,useAuthorization:m,defaultIsAuthenticated:g}),{messages:S,userInput:E,setUserInput:M,isResponding:P,handleNewSession:D,handleSubmit:W,darkMode:H,setDarkMode:L}=$n({serverUrl:h.serverUrl,welcomeMessage:f}),X=O=>{O.preventDefault(),O.stopPropagation(),c.current++,O.dataTransfer.items&&O.dataTransfer.items.length>0&&i(!0)},ge=O=>{O.preventDefault(),O.stopPropagation(),c.current--,c.current===0&&i(!1)},He=O=>{O.preventDefault(),O.stopPropagation()},Fe=O=>{O.preventDefault(),O.stopPropagation(),i(!1),c.current=0;const me=Array.from(O.dataTransfer.files);me.length>0&&o(Ue=>[...Ue,...me])};if(m){if(p)return d.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-900 flex items-center justify-center",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-solace-green mx-auto mb-4"}),d.jsx("h1",{className:"text-2xl mb-4 text-black dark:text-white",children:"Validating your session..."})]})});if(!x)return d.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-900 flex items-center justify-center",children:d.jsxs("div",{className:"text-center",children:[d.jsxs("h1",{className:"text-2xl mb-4 text-black dark:text-white",children:["Welcome to ",r]}),d.jsx("p",{className:"mb-4 text-black dark:text-white",children:"Please log in to continue"}),d.jsx("button",{onClick:R,className:"bg-solace-green text-white px-6 py-2 rounded shadow hover:bg-solace-dark-green",children:"Login"})]})})}return d.jsxs("div",{className:`${H?"dark":""} min-h-screen relative`,onDragEnter:X,onDragOver:He,onDragLeave:ge,onDrop:Fe,children:[s&&d.jsx("div",{className:"fixed inset-0 w-full h-full bg-gray-900/50 flex items-center justify-center z-[9999]",children:d.jsx("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-lg shadow-lg",children:d.jsxs("div",{className:"flex flex-col items-center",children:[d.jsx("div",{className:"text-solace-blue dark:text-solace-green text-4xl mb-4",children:"📂"}),d.jsx("p",{className:"text-lg font-medium text-solace-blue dark:text-solace-green",children:"Add Anything"}),d.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:"Drop any file here to add it to the conversation"})]})})}),d.jsxs("header",{className:"fixed top-0 left-0 right-0 bg-solace-light-blue text-white p-4 flex justify-between items-center shadow-lg backdrop-blur-sm z-50 transition-all duration-300",children:[d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx("div",{className:`h-10 w-10 rounded-full overflow-hidden border-2 border-white/20 shadow-md
                    ${H?"bg-gray-800":"bg-white"}`,children:d.jsx("img",{src:"/solace_chat_header_icon.png",alt:"Agent Mesh Logo",className:"h-full w-full object-cover"})}),d.jsx("h1",{className:"text-xl font-semibold tracking-tight",children:r})]}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs("button",{onClick:D,className:`bg-white/15 hover:bg-white/25 text-white px-5 py-2 rounded-full
                      transition-all duration-200 text-sm font-medium flex items-center space-x-2
                      border border-white/20 hover:border-white/30 shadow-sm`,children:[d.jsx("span",{children:"New Session"}),d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})]}),d.jsx(ni,{darkMode:H,setDarkMode:L,className:"p-2 hover:bg-white/15 rounded-full transition-all duration-200"})]})]}),d.jsx("main",{className:"flex-1 pt-20 bg-white dark:bg-gray-900 min-h-screen",children:d.jsx("div",{className:`pb-16 w-11/12 transition-all duration-300
            ${l?"md:w-[60%] ml-[100px] mr-auto":"md:w-2/4 mx-auto"}
          `,children:d.jsx(ti,{messages:S,userInput:E,setUserInput:M,handleSubmit:O=>{W(O,a),o([])},isResponding:P,selectedFiles:a,setSelectedFiles:o,onPreviewOpen:()=>u(!0),onPreviewClose:()=>u(!1)})})})]})}function li(){return d.jsx(ri,{})}export{li as default};
