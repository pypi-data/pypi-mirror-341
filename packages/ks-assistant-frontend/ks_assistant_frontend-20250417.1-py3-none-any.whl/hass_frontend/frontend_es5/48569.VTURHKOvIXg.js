/*! For license information please see 48569.VTURHKOvIXg.js.LICENSE.txt */
"use strict";(self.webpackChunkks_assistant_frontend=self.webpackChunkks_assistant_frontend||[]).push([[48569],{74455:function(t,n,i){var e=i(35806),o=i(71008),a=i(62193),r=i(2816),c=i(27927),u=(i(81027),i(14565)),s=i(29818);(0,c.A)([(0,s.EM)("ha-chip-set")],(function(t,n){var i=function(n){function i(){var n;(0,o.A)(this,i);for(var e=arguments.length,r=new Array(e),c=0;c<e;c++)r[c]=arguments[c];return n=(0,a.A)(this,i,[].concat(r)),t(n),n}return(0,r.A)(i,n),(0,e.A)(i)}(n);return{F:i,d:[]}}),u.Y)},81771:function(t,n,i){i.d(n,{$W:function(){return f},Dp:function(){return m},EC:function(){return r},HB:function(){return v},S9:function(){return _},XF:function(){return u},b1:function(){return h},bV:function(){return c},lB:function(){return s},lg:function(){return d},mX:function(){return y},oj:function(){return l},rY:function(){return g},vH:function(){return p}});i(26098);var e,o=i(16312),a=i(55979),r="single",c=10,u=function(t){if("condition"in t&&Array.isArray(t.condition))return{condition:"and",conditions:t.condition};for(var n=0,i=["and","or","not"];n<i.length;n++){var e=i[n];if(e in t)return{condition:e,conditions:t[e]}}return t},s=function(t,n){t.callService("automation","trigger",{entity_id:n,skip_condition:!0})},d=function(t,n){return t.callApi("DELETE","config/automation/config/".concat(n))},l=function(t,n){return t.callApi("GET","config/automation/config/".concat(n))},f=function(t,n){return t.callWS({type:"automation/config",entity_id:n})},h=function(t,n,i){return t.callApi("POST","config/automation/config/".concat(n),i)},v=function(t){for(var n=0,i=["trigger","condition","action"];n<i.length;n++){var e=i[n],o=t[e];o&&!Array.isArray(o)&&(t[e]=[o])}return t.action&&(t.action=(0,a.Rn)(t.action)),t},y=function(t){e=t,(0,o.o)("/config/automation/edit/new")},p=function(t){y(Object.assign(Object.assign({},t),{},{id:void 0,alias:void 0}))},g=function(){var t=e;return e=void 0,t},m=function(t,n,i,e){return t.connection.subscribeMessage(n,{type:"subscribe_trigger",trigger:i,variables:e})},_=function(t,n,i){return t.callWS({type:"test_condition",condition:n,variables:i})}},31338:function(t,n,i){i.d(n,{I$:function(){return d},I3:function(){return g},PV:function(){return p},Po:function(){return h},RK:function(){return A},TB:function(){return l},TH:function(){return k},T_:function(){return _},am:function(){return r},jR:function(){return s},ng:function(){return c},nx:function(){return m},o9:function(){return u}});var e=i(91001),o=(i(81027),i(82386),i(50693),i(21631),i(36604),i(19244)),a=i(94929),r=function(t,n){return t.callWS({type:"device_automation/action/list",device_id:n})},c=function(t,n){return t.callWS({type:"device_automation/condition/list",device_id:n})},u=function(t,n){return t.callWS({type:"device_automation/trigger/list",device_id:n})},s=function(t,n){return t.callWS({type:"device_automation/action/capabilities",action:n})},d=function(t,n){return t.callWS({type:"device_automation/condition/capabilities",condition:n})},l=function(t,n){return t.callWS({type:"device_automation/trigger/capabilities",trigger:n})},f=["device_id","domain","entity_id","type","subtype","event","condition","platform"],h=function(t,n,i){if((0,e.A)(n)!==(0,e.A)(i))return!1;for(var o in n){var a,r;if(f.includes(o))if("entity_id"!==o||(null===(a=n[o])||void 0===a?void 0:a.includes("."))===(null===(r=i[o])||void 0===r?void 0:r.includes("."))){if(!Object.is(n[o],i[o]))return!1}else if(!v(t,n[o],i[o]))return!1}for(var c in i){var u,s;if(f.includes(c))if("entity_id"!==c||(null===(u=n[c])||void 0===u?void 0:u.includes("."))===(null===(s=i[c])||void 0===s?void 0:s.includes("."))){if(!Object.is(n[c],i[c]))return!1}else if(!v(t,n[c],i[c]))return!1}return!0},v=function(t,n,i){return!(!n||!i)&&(n.includes(".")&&(n=(0,a.Ox)(t)[n].id),i.includes(".")&&(i=(0,a.Ox)(t)[i].id),n===i)},y=function(t,n,i){if(!i)return"<"+t.localize("ui.panel.config.automation.editor.unknown_entity")+">";if(i.includes(".")){var e=t.states[i];return e?(0,o.u)(e):i}var r=(0,a.P9)(n)[i];return r?(0,a.jh)(t,r)||i:"<"+t.localize("ui.panel.config.automation.editor.unknown_entity")+">"},p=function(t,n,i){return t.localize("component.".concat(i.domain,".device_automation.action_type.").concat(i.type),{entity_name:y(t,n,i.entity_id),subtype:i.subtype?t.localize("component.".concat(i.domain,".device_automation.action_subtype.").concat(i.subtype))||i.subtype:""})||(i.subtype?'"'.concat(i.subtype,'" ').concat(i.type):i.type)},g=function(t,n,i){return t.localize("component.".concat(i.domain,".device_automation.condition_type.").concat(i.type),{entity_name:y(t,n,i.entity_id),subtype:i.subtype?t.localize("component.".concat(i.domain,".device_automation.condition_subtype.").concat(i.subtype))||i.subtype:""})||(i.subtype?'"'.concat(i.subtype,'" ').concat(i.type):i.type)},m=function(t,n,i){return t.localize("component.".concat(i.domain,".device_automation.trigger_type.").concat(i.type),{entity_name:y(t,n,i.entity_id),subtype:i.subtype?t.localize("component.".concat(i.domain,".device_automation.trigger_subtype.").concat(i.subtype))||i.subtype:""})||(i.subtype?'"'.concat(i.subtype,'" ').concat(i.type):i.type)},_=function(t,n){return function(i){return t.localize("component.".concat(n.domain,".device_automation.extra_fields.").concat(i.name))||i.name}},k=function(t,n){return function(i){return t.localize("component.".concat(n.domain,".device_automation.extra_fields_descriptions.").concat(i.name))}},A=function(t,n){var i,e,o,a;return null===(i=t.metadata)||void 0===i||!i.secondary||null!==(e=n.metadata)&&void 0!==e&&e.secondary?null!==(o=t.metadata)&&void 0!==o&&o.secondary||null===(a=n.metadata)||void 0===a||!a.secondary?0:-1:1}},48569:function(t,n,i){i.r(n),i.d(n,{DialogDeviceAutomation:function(){return D}});var e,o,a,r,c,u,s,d,l,f=i(64599),h=i(33994),v=i(22858),y=i(35806),p=i(71008),g=i(62193),m=i(2816),_=i(27927),k=i(35890),A=(i(81027),i(33231),i(54838),i(15112)),b=i(29818),w=i(34897),S=(i(3276),i(31338)),x=i(55321),z=(i(13025),i(97741),i(26098),i(39790),i(253),i(2075),i(16891),i(83546),i(74455),i(81771)),E=i(55979),R=(0,_.A)(null,(function(t,n){return{F:function(n){function i(n){var e;return(0,p.A)(this,i),(e=(0,g.A)(this,i)).headerKey=void 0,e.type=void 0,t(e),e._localizeDeviceAutomation=n,e}return(0,m.A)(i,n),(0,y.A)(i)}(n),d:[{kind:"field",decorators:[(0,b.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,b.MZ)()],key:"deviceId",value:void 0},{kind:"field",decorators:[(0,b.MZ)({type:Boolean})],key:"script",value:function(){return!1}},{kind:"field",decorators:[(0,b.MZ)({attribute:!1})],key:"automations",value:function(){return[]}},{kind:"field",decorators:[(0,b.MZ)({attribute:!1})],key:"entityReg",value:void 0},{kind:"field",decorators:[(0,b.wk)()],key:"_showSecondary",value:function(){return!1}},{kind:"field",key:"_localizeDeviceAutomation",value:void 0},{kind:"method",key:"shouldUpdate",value:function(t){if(t.has("deviceId")||t.has("automations"))return!0;var n=t.get("hass");return!n||n.language!==this.hass.language}},{kind:"method",key:"render",value:function(){var t=this;if(0===this.automations.length||!this.entityReg)return A.s6;var n=this._showSecondary?this.automations:this.automations.filter((function(t){var n;return!1===(null===(n=t.metadata)||void 0===n?void 0:n.secondary)}));return(0,A.qy)(e||(e=(0,f.A)([" <h3>",'</h3> <div class="content"> <ha-chip-set> '," </ha-chip-set> "," </div> "])),this.hass.localize(this.headerKey),n.map((function(n,i){var e;return(0,A.qy)(o||(o=(0,f.A)([' <ha-assist-chip filled .index="','" @click="','" class="','" .label="','"> </ha-assist-chip> '])),i,t._handleAutomationClicked,null!==(e=n.metadata)&&void 0!==e&&e.secondary?"secondary":"",t._localizeDeviceAutomation(t.hass,t.entityReg,n))})),!this._showSecondary&&n.length<this.automations.length?(0,A.qy)(a||(a=(0,f.A)(['<button class="link" @click="','"> Show '," more... </button>"])),this._toggleSecondary,this.automations.length-n.length):"")}},{kind:"method",key:"_toggleSecondary",value:function(){this._showSecondary=!this._showSecondary}},{kind:"method",key:"_handleAutomationClicked",value:function(t){var n=Object.assign({},this.automations[t.currentTarget.index]);if(n){if(delete n.metadata,this.script)return(0,E.AM)({sequence:[n]}),void(0,w.r)(this,"entry-selected");var i={};i[this.type]=[n],(0,z.mX)(i),(0,w.r)(this,"entry-selected")}}},{kind:"field",static:!0,key:"styles",value:function(){return[x.og,(0,A.AH)(r||(r=(0,f.A)(["h3{color:var(--primary-text-color)}.secondary{--ha-assist-chip-filled-container-color:rgba(\n          var(--rgb-primary-text-color),\n          0.07\n        )}button.link{color:var(--primary-color)}"])))]}}]}}),A.WF),D=((0,_.A)([(0,b.EM)("ha-device-actions-card")],(function(t,n){return{F:function(n){function i(){var n;return(0,p.A)(this,i),n=(0,g.A)(this,i,[S.PV]),t(n),n}return(0,m.A)(i,n),(0,y.A)(i)}(n),d:[{kind:"field",key:"type",value:function(){return"action"}},{kind:"field",key:"headerKey",value:function(){return"ui.panel.config.devices.automation.actions.caption"}}]}}),R),(0,_.A)([(0,b.EM)("ha-device-conditions-card")],(function(t,n){return{F:function(n){function i(){var n;return(0,p.A)(this,i),n=(0,g.A)(this,i,[S.I3]),t(n),n}return(0,m.A)(i,n),(0,y.A)(i)}(n),d:[{kind:"field",key:"type",value:function(){return"condition"}},{kind:"field",key:"headerKey",value:function(){return"ui.panel.config.devices.automation.conditions.caption"}}]}}),R),(0,_.A)([(0,b.EM)("ha-device-triggers-card")],(function(t,n){return{F:function(n){function i(){var n;return(0,p.A)(this,i),n=(0,g.A)(this,i,[S.nx]),t(n),n}return(0,m.A)(i,n),(0,y.A)(i)}(n),d:[{kind:"field",key:"type",value:function(){return"trigger"}},{kind:"field",key:"headerKey",value:function(){return"ui.panel.config.devices.automation.triggers.caption"}}]}}),R),(0,_.A)([(0,b.EM)("dialog-device-automation")],(function(t,n){var i,e=function(n){function i(){var n;(0,p.A)(this,i);for(var e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];return n=(0,g.A)(this,i,[].concat(o)),t(n),n}return(0,m.A)(i,n),(0,y.A)(i)}(n);return{F:e,d:[{kind:"field",decorators:[(0,b.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,b.wk)()],key:"_triggers",value:function(){return[]}},{kind:"field",decorators:[(0,b.wk)()],key:"_conditions",value:function(){return[]}},{kind:"field",decorators:[(0,b.wk)()],key:"_actions",value:function(){return[]}},{kind:"field",decorators:[(0,b.wk)()],key:"_params",value:void 0},{kind:"method",key:"showDialog",value:(i=(0,v.A)((0,h.A)().mark((function t(n){return(0,h.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._params=n,t.next=3,this.updateComplete;case 3:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{kind:"method",key:"closeDialog",value:function(){this._params=void 0,(0,w.r)(this,"dialog-closed",{dialog:this.localName})}},{kind:"method",key:"firstUpdated",value:function(t){(0,k.A)(e,"firstUpdated",this,3)([t]),this.hass.loadBackendTranslation("device_automation")}},{kind:"method",key:"updated",value:function(t){var n=this;if((0,k.A)(e,"updated",this,3)([t]),t.has("_params")&&(this._triggers=[],this._conditions=[],this._actions=[],this._params)){var i=this._params,o=i.device,a=i.script;(0,S.am)(this.hass,o.id).then((function(t){n._actions=t.sort(S.RK)})),a||((0,S.o9)(this.hass,o.id).then((function(t){n._triggers=t.sort(S.RK)})),(0,S.ng)(this.hass,o.id).then((function(t){n._conditions=t.sort(S.RK)})))}}},{kind:"method",key:"render",value:function(){return this._params?(0,A.qy)(c||(c=(0,f.A)([' <ha-dialog open @closed="','" .heading="','"> <div @entry-selected="','"> ',' </div> <mwc-button slot="primaryAction" @click="','"> '," </mwc-button> </ha-dialog> "])),this.closeDialog,this.hass.localize("ui.panel.config.devices.".concat(this._params.script?"script":"automation",".create"),{type:this.hass.localize("ui.panel.config.devices.type.".concat(this._params.device.entry_type||"device"))}),this.closeDialog,this._triggers.length||this._conditions.length||this._actions.length?(0,A.qy)(u||(u=(0,f.A)([" "," "," "," "])),this._triggers.length?(0,A.qy)(s||(s=(0,f.A)([' <ha-device-triggers-card .hass="','" .automations="','" .entityReg="','"></ha-device-triggers-card> '])),this.hass,this._triggers,this._params.entityReg):"",this._conditions.length?(0,A.qy)(d||(d=(0,f.A)([' <ha-device-conditions-card .hass="','" .automations="','" .entityReg="','"></ha-device-conditions-card> '])),this.hass,this._conditions,this._params.entityReg):"",this._actions.length?(0,A.qy)(l||(l=(0,f.A)([' <ha-device-actions-card .hass="','" .automations="','" .script="','" .entityReg="','"></ha-device-actions-card> '])),this.hass,this._actions,this._params.script,this._params.entityReg):""):this.hass.localize("ui.panel.config.devices.automation.no_device_automations"),this.closeDialog,this.hass.localize("ui.common.close")):A.s6}},{kind:"get",static:!0,key:"styles",value:function(){return x.nA}}]}}),A.WF))},14565:function(t,n,i){i.d(n,{Y:function(){return g}});var e,o,a=i(35806),r=i(71008),c=i(62193),u=i(2816),s=i(79192),d=i(29818),l=i(64782),f=i(64599),h=(i(13025),i(44124),i(39805),i(39790),i(253),i(2075),i(94438),i(55815),i(15112)),v=i(40141),y=function(t){function n(){var t;return(0,r.A)(this,n),(t=(0,c.A)(this,n)).internals=t.attachInternals(),h.S$||(t.addEventListener("focusin",t.updateTabIndices.bind(t)),t.addEventListener("update-focus",t.updateTabIndices.bind(t)),t.addEventListener("keydown",t.handleKeyDown.bind(t)),t.internals.role="toolbar"),t}return(0,u.A)(n,t),(0,a.A)(n,[{key:"chips",get:function(){return this.childElements.filter((function(t){return t instanceof v.v}))}},{key:"render",value:function(){return(0,h.qy)(e||(e=(0,f.A)(['<slot @slotchange="','"></slot>'])),this.updateTabIndices)}},{key:"handleKeyDown",value:function(t){var n="ArrowLeft"===t.key,i="ArrowRight"===t.key,e="Home"===t.key,o="End"===t.key;if(n||i||e||o){var a=this.chips;if(!(a.length<2)){if(t.preventDefault(),e||o)return a[e?0:a.length-1].focus({trailing:o}),void this.updateTabIndices();var r="rtl"===getComputedStyle(this).direction?n:i,c=a.find((function(t){return t.matches(":focus-within")}));if(!c)return(r?a[0]:a[a.length-1]).focus({trailing:!r}),void this.updateTabIndices();for(var u=a.indexOf(c),s=r?u+1:u-1;s!==u;){s>=a.length?s=0:s<0&&(s=a.length-1);var d=a[s];if(!d.disabled||d.alwaysFocusable){d.focus({trailing:!r}),this.updateTabIndices();break}r?s++:s--}}}}},{key:"updateTabIndices",value:function(){var t,n,i=this.chips,e=(0,l.A)(i);try{for(e.s();!(n=e.n()).done;){var o=n.value,a=o.alwaysFocusable||!o.disabled;o.matches(":focus-within")&&a?t=o:(a&&!t&&(t=o),o.tabIndex=-1)}}catch(r){e.e(r)}finally{e.f()}t&&(t.tabIndex=0)}}])}(h.WF);(0,s.__decorate)([(0,d.KN)()],y.prototype,"childElements",void 0);var p=(0,h.AH)(o||(o=(0,f.A)([":host{display:flex;flex-wrap:wrap;gap:8px}"]))),g=function(t){function n(){return(0,r.A)(this,n),(0,c.A)(this,n,arguments)}return(0,u.A)(n,t),(0,a.A)(n)}(y);g.styles=[p],g=(0,s.__decorate)([(0,d.EM)("md-chip-set")],g)}}]);
//# sourceMappingURL=48569.VTURHKOvIXg.js.map