export const id=77907;export const ids=[77907];export const modules={99890:(e,t,i)=>{i.d(t,{g:()=>n});const n=e=>(t,i)=>e.includes(t,i)},81771:(e,t,i)=>{i.d(t,{$W:()=>f,Dp:()=>q,EC:()=>s,HB:()=>g,S9:()=>h,XF:()=>o,b1:()=>p,bV:()=>a,lB:()=>c,lg:()=>l,mX:()=>_,oj:()=>u,rY:()=>y,vH:()=>m});var n=i(16312),r=i(55979);const s="single",a=10,o=e=>{if("condition"in e&&Array.isArray(e.condition))return{condition:"and",conditions:e.condition};for(const t of["and","or","not"])if(t in e)return{condition:t,conditions:e[t]};return e},c=(e,t)=>{e.callService("automation","trigger",{entity_id:t,skip_condition:!0})},l=(e,t)=>e.callApi("DELETE",`config/automation/config/${t}`);let d;const u=(e,t)=>e.callApi("GET",`config/automation/config/${t}`),f=(e,t)=>e.callWS({type:"automation/config",entity_id:t}),p=(e,t,i)=>e.callApi("POST",`config/automation/config/${t}`,i),g=e=>{for(const t of["trigger","condition","action"]){const i=e[t];i&&!Array.isArray(i)&&(e[t]=[i])}return e.action&&(e.action=(0,r.Rn)(e.action)),e},_=e=>{d=e,(0,n.o)("/config/automation/edit/new")},m=e=>{_({...e,id:void 0,alias:void 0})},y=()=>{const e=d;return d=void 0,e},q=(e,t,i,n)=>e.connection.subscribeMessage(t,{type:"subscribe_trigger",trigger:i,variables:n}),h=(e,t,i)=>e.callWS({type:"test_condition",condition:t,variables:i})},55979:(e,t,i)=>{i.d(t,{AM:()=>v,BD:()=>u,FN:()=>o,Ht:()=>m,Iq:()=>c,Kq:()=>q,NX:()=>Y,Q2:()=>_,R$:()=>h,Rn:()=>k,TP:()=>b,kR:()=>g,pq:()=>j});i(16891);var n=i(66419),r=i(99890),s=i(16312),a=i(59780);const o=["single","restart","queued","parallel"],c=(0,r.g)(["queued","parallel"]),l=(0,n.Ik)({alias:(0,n.lq)((0,n.Yj)()),continue_on_error:(0,n.lq)((0,n.zM)()),enabled:(0,n.lq)((0,n.zM)())}),d=(0,n.Ik)({entity_id:(0,n.lq)((0,n.KC)([(0,n.Yj)(),(0,n.YO)((0,n.Yj)())])),device_id:(0,n.lq)((0,n.KC)([(0,n.Yj)(),(0,n.YO)((0,n.Yj)())])),area_id:(0,n.lq)((0,n.KC)([(0,n.Yj)(),(0,n.YO)((0,n.Yj)())])),floor_id:(0,n.lq)((0,n.KC)([(0,n.Yj)(),(0,n.YO)((0,n.Yj)())])),label_id:(0,n.lq)((0,n.KC)([(0,n.Yj)(),(0,n.YO)((0,n.Yj)())]))}),u=(0,n.kp)(l,(0,n.Ik)({action:(0,n.lq)((0,n.Yj)()),service_template:(0,n.lq)((0,n.Yj)()),entity_id:(0,n.lq)((0,n.Yj)()),target:(0,n.lq)(d),data:(0,n.lq)((0,n.Ik)()),response_variable:(0,n.lq)((0,n.Yj)()),metadata:(0,n.lq)((0,n.Ik)())})),f=(0,n.kp)(l,(0,n.Ik)({action:(0,n.eu)("media_player.play_media"),target:(0,n.lq)((0,n.Ik)({entity_id:(0,n.lq)((0,n.Yj)())})),entity_id:(0,n.lq)((0,n.Yj)()),data:(0,n.Ik)({media_content_id:(0,n.Yj)(),media_content_type:(0,n.Yj)()}),metadata:(0,n.Ik)()})),p=(0,n.kp)(l,(0,n.Ik)({action:(0,n.eu)("scene.turn_on"),target:(0,n.lq)((0,n.Ik)({entity_id:(0,n.lq)((0,n.Yj)())})),entity_id:(0,n.lq)((0,n.Yj)()),metadata:(0,n.Ik)()})),g=(e,t,i)=>e.callService("script",t,i),_=e=>"off"===e.state||!!("on"===e.state&&c(e.attributes.mode)&&e.attributes.current<e.attributes.max),m=(e,t)=>e.callApi("DELETE",`config/script/config/${t}`);let y;const q=(e,t)=>e.callApi("GET",`config/script/config/${t}`),h=(e,t)=>e.callWS({type:"script/config",entity_id:t}),v=e=>{y=e,(0,s.o)("/config/script/edit/new")},Y=()=>{const e=y;return y=void 0,e},j=e=>{if("delay"in e)return"delay";if("wait_template"in e)return"wait_template";if(["condition","and","or","not"].some((t=>t in e)))return"check_condition";if("event"in e)return"fire_event";if("device_id"in e)return"device_action";if("scene"in e)return"activate_scene";if("repeat"in e)return"repeat";if("choose"in e)return"choose";if("if"in e)return"if";if("wait_for_trigger"in e)return"wait_for_trigger";if("variables"in e)return"variables";if("stop"in e)return"stop";if("sequence"in e)return"sequence";if("parallel"in e)return"parallel";if("set_conversation_response"in e)return"set_conversation_response";if("action"in e){if("metadata"in e){if((0,n.is)(e,p))return"activate_scene";if((0,n.is)(e,f))return"play_media"}return"service"}return"unknown"},b=(e,t)=>{const i=e.services.script[(0,a.Y)(t)]?.fields;return void 0!==i&&Object.keys(i).length>0},k=e=>{if(Array.isArray(e))return e.map(k);if("service"in e&&("action"in e||(e.action=e.service),delete e.service),"sequence"in e)for(const t of e.sequence)k(t);const t=j(e);if("parallel"===t){k(e.parallel)}if("choose"===t){const t=e;if(Array.isArray(t.choose))for(const e of t.choose)k(e.sequence);else t.choose&&k(t.choose.sequence);t.default&&k(t.default)}if("repeat"===t){k(e.repeat.sequence)}if("if"===t){const t=e;k(t.then),t.else&&k(t.else)}return e}},77907:(e,t,i)=>{i.r(t),i.d(t,{addExternalBarCodeListener:()=>c,attachExternalToApp:()=>o});i(24545),i(51855),i(82130),i(31743),i(22328),i(4959),i(62435),i(253),i(54846);var n=i(34897),r=i(74005),s=i(81771);const a=new Set,o=e=>{window.addEventListener("haptic",(t=>e.hass.auth.external.fireMessage({type:"haptic",payload:{hapticType:t.detail}}))),e.hass.auth.external.addCommandHandler((t=>l(e,t)))},c=e=>(a.add(e),()=>{a.delete(e)}),l=(e,t)=>{const i=e.hass.auth.external;if("restart"===t.command)e.hass.connection.reconnect(!0),i.fireMessage({id:t.id,type:"result",success:!0,result:null});else if("notifications/show"===t.command)(0,n.r)(e,"hass-show-notifications"),i.fireMessage({id:t.id,type:"result",success:!0,result:null});else if("sidebar/toggle"===t.command){if(r.G.history.state?.open)return i.fireMessage({id:t.id,type:"result",success:!1,error:{code:"not_allowed",message:"dialog open"}}),!0;(0,n.r)(e,"hass-toggle-menu"),i.fireMessage({id:t.id,type:"result",success:!0,result:null})}else if("sidebar/show"===t.command){if(r.G.history.state?.open)return i.fireMessage({id:t.id,type:"result",success:!1,error:{code:"not_allowed",message:"dialog open"}}),!0;(0,n.r)(e,"hass-toggle-menu",{open:!0}),i.fireMessage({id:t.id,type:"result",success:!0,result:null})}else if("automation/editor/show"===t.command)(0,s.mX)(t.payload?.config),i.fireMessage({id:t.id,type:"result",success:!0,result:null});else if("bar_code/scan_result"===t.command)a.forEach((e=>e(t))),i.fireMessage({id:t.id,type:"result",success:!0,result:null});else{if("bar_code/aborted"!==t.command)return!1;a.forEach((e=>e(t))),i.fireMessage({id:t.id,type:"result",success:!0,result:null})}return!0}}};
//# sourceMappingURL=77907.krD6_Qq3qEY.js.map