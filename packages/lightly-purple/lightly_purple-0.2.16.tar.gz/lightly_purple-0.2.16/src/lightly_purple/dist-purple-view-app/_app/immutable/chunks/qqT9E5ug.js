const F=/\{[^{}]+\}/g,W=()=>{var r,t;return typeof process=="object"&&Number.parseInt((t=(r=process==null?void 0:process.versions)==null?void 0:r.node)==null?void 0:t.substring(0,2))>=18&&process.versions.undici};function B(){return Math.random().toString(36).slice(2,11)}function M(r){let{baseUrl:t="",Request:e=globalThis.Request,fetch:i=globalThis.fetch,querySerializer:n,bodySerializer:o,headers:a,requestInitExt:f=void 0,...v}={...r};f=W()?f:void 0,t=H(t);const y=[];async function h(l,s){const{baseUrl:b,fetch:U=i,Request:K=e,headers:P,params:R={},parseAs:q="json",querySerializer:j,bodySerializer:O=o??G,body:C,...A}=s||{};b&&(t=H(b));let x=typeof n=="function"?n:I(n);j&&(x=typeof j=="function"?j:I({...typeof n=="object"?n:{},...j}));const z=C===void 0?void 0:O(C),L=z===void 0||z instanceof FormData?{}:{"Content-Type":"application/json"},N={redirect:"follow",...v,...A,body:z,headers:_(L,a,P,R.header)};let g,E,m=new e(J(l,{baseUrl:t,params:R,querySerializer:x}),N);for(const u in A)u in m||(m[u]=A[u]);if(y.length){g=B(),E=Object.freeze({baseUrl:t,fetch:U,parseAs:q,querySerializer:x,bodySerializer:O});for(const u of y)if(u&&typeof u=="object"&&typeof u.onRequest=="function"){const d=await u.onRequest({request:m,schemaPath:l,params:R,options:E,id:g});if(d){if(!(d instanceof e))throw new Error("onRequest: must return new Request() when modifying the request");m=d}}}let c;try{c=await U(m,f)}catch(u){let d=u;if(y.length)for(let p=y.length-1;p>=0;p--){const $=y[p];if($&&typeof $=="object"&&typeof $.onError=="function"){const w=await $.onError({request:m,error:d,schemaPath:l,params:R,options:E,id:g});if(w){if(w instanceof Response){d=void 0,c=w;break}if(w instanceof Error){d=w;continue}throw new Error("onError: must return new Response() or instance of Error")}}}if(d)throw d}if(y.length)for(let u=y.length-1;u>=0;u--){const d=y[u];if(d&&typeof d=="object"&&typeof d.onResponse=="function"){const p=await d.onResponse({request:m,response:c,schemaPath:l,params:R,options:E,id:g});if(p){if(!(p instanceof Response))throw new Error("onResponse: must return new Response() when modifying the response");c=p}}}if(c.status===204||c.headers.get("Content-Length")==="0")return c.ok?{data:void 0,response:c}:{error:void 0,response:c};if(c.ok)return q==="stream"?{data:c.body,response:c}:{data:await c[q](),response:c};let T=await c.text();try{T=JSON.parse(T)}catch{}return{error:T,response:c}}return{request(l,s,b){return h(s,{...b,method:l.toUpperCase()})},GET(l,s){return h(l,{...s,method:"GET"})},PUT(l,s){return h(l,{...s,method:"PUT"})},POST(l,s){return h(l,{...s,method:"POST"})},DELETE(l,s){return h(l,{...s,method:"DELETE"})},OPTIONS(l,s){return h(l,{...s,method:"OPTIONS"})},HEAD(l,s){return h(l,{...s,method:"HEAD"})},PATCH(l,s){return h(l,{...s,method:"PATCH"})},TRACE(l,s){return h(l,{...s,method:"TRACE"})},use(...l){for(const s of l)if(s){if(typeof s!="object"||!("onRequest"in s||"onResponse"in s||"onError"in s))throw new Error("Middleware must be an object with one of `onRequest()`, `onResponse() or `onError()`");y.push(s)}},eject(...l){for(const s of l){const b=y.indexOf(s);b!==-1&&y.splice(b,1)}}}}function S(r,t,e){if(t==null)return"";if(typeof t=="object")throw new Error("Deeply-nested arrays/objects arenâ€™t supported. Provide your own `querySerializer()` to handle these.");return`${r}=${(e==null?void 0:e.allowReserved)===!0?t:encodeURIComponent(t)}`}function D(r,t,e){if(!t||typeof t!="object")return"";const i=[],n={simple:",",label:".",matrix:";"}[e.style]||"&";if(e.style!=="deepObject"&&e.explode===!1){for(const f in t)i.push(f,e.allowReserved===!0?t[f]:encodeURIComponent(t[f]));const a=i.join(",");switch(e.style){case"form":return`${r}=${a}`;case"label":return`.${a}`;case"matrix":return`;${r}=${a}`;default:return a}}for(const a in t){const f=e.style==="deepObject"?`${r}[${a}]`:a;i.push(S(f,t[a],e))}const o=i.join(n);return e.style==="label"||e.style==="matrix"?`${n}${o}`:o}function k(r,t,e){if(!Array.isArray(t))return"";if(e.explode===!1){const o={form:",",spaceDelimited:"%20",pipeDelimited:"|"}[e.style]||",",a=(e.allowReserved===!0?t:t.map(f=>encodeURIComponent(f))).join(o);switch(e.style){case"simple":return a;case"label":return`.${a}`;case"matrix":return`;${r}=${a}`;default:return`${r}=${a}`}}const i={simple:",",label:".",matrix:";"}[e.style]||"&",n=[];for(const o of t)e.style==="simple"||e.style==="label"?n.push(e.allowReserved===!0?o:encodeURIComponent(o)):n.push(S(r,o,e));return e.style==="label"||e.style==="matrix"?`${i}${n.join(i)}`:n.join(i)}function I(r){return function(e){const i=[];if(e&&typeof e=="object")for(const n in e){const o=e[n];if(o!=null){if(Array.isArray(o)){if(o.length===0)continue;i.push(k(n,o,{style:"form",explode:!0,...r==null?void 0:r.array,allowReserved:(r==null?void 0:r.allowReserved)||!1}));continue}if(typeof o=="object"){i.push(D(n,o,{style:"deepObject",explode:!0,...r==null?void 0:r.object,allowReserved:(r==null?void 0:r.allowReserved)||!1}));continue}i.push(S(n,o,r))}}return i.join("&")}}function Q(r,t){let e=r;for(const i of r.match(F)??[]){let n=i.substring(1,i.length-1),o=!1,a="simple";if(n.endsWith("*")&&(o=!0,n=n.substring(0,n.length-1)),n.startsWith(".")?(a="label",n=n.substring(1)):n.startsWith(";")&&(a="matrix",n=n.substring(1)),!t||t[n]===void 0||t[n]===null)continue;const f=t[n];if(Array.isArray(f)){e=e.replace(i,k(n,f,{style:a,explode:o}));continue}if(typeof f=="object"){e=e.replace(i,D(n,f,{style:a,explode:o}));continue}if(a==="matrix"){e=e.replace(i,`;${S(n,f)}`);continue}e=e.replace(i,a==="label"?`.${encodeURIComponent(f)}`:encodeURIComponent(f))}return e}function G(r){return r instanceof FormData?r:JSON.stringify(r)}function J(r,t){var n;let e=`${t.baseUrl}${r}`;(n=t.params)!=null&&n.path&&(e=Q(e,t.params.path));let i=t.querySerializer(t.params.query??{});return i.startsWith("?")&&(i=i.substring(1)),i&&(e+=`?${i}`),e}function _(...r){const t=new Headers;for(const e of r){if(!e||typeof e!="object")continue;const i=e instanceof Headers?e.entries():Object.entries(e);for(const[n,o]of i)if(o===null)t.delete(n);else if(Array.isArray(o))for(const a of o)t.append(n,a);else o!==void 0&&t.set(n,o)}return t}function H(r){return r.endsWith("/")?r.substring(0,r.length-1):r}const V=M({baseUrl:"http://localhost:8001/",fetch});export{V as c};
