import{P as Yt,c as Ft}from"../chunks/BzArsHZA.js";import{c as Mt,a as E,t as H,s as et,b as Xt}from"../chunks/BIBpUM06.js";import{p as nt,f as rt,v as Tt,a as at,c as b,j as s,l as j,s as N,r as _,o as st,t as J,q as tt,al as qt,e as Nt,ad as Ut}from"../chunks/CXxiYbHI.js";import{e as At,r as kt,i as dt,c as _t,s as jt,a as ot,b as Bt}from"../chunks/CCXSUNwX.js";import{o as Pt,s as ht,u as Kt,B as gt,D as wt,F as Jt,H as Qt,J as It,T as yt,K as xt,e as ut,c as ct,L as Et,j as Dt,M as Ct,k as Ot,b as $t,g as te}from"../chunks/BYGGi5BS.js";import{S as Vt,f as mt,a as ft,T as ee,A as ne}from"../chunks/kGNeBKGb.js";import{r as Zt}from"../chunks/Cbydd1_z.js";import{a as Gt}from"../chunks/BMn8bbDJ.js";import{p as ae}from"../chunks/DDh19orn.js";import{S as oe}from"../chunks/Cpgl9aC0.js";import{g as ie}from"../chunks/pKKESLv8.js";import"../chunks/DsN2YVC9.js";import{a as se}from"../chunks/DJQw4C5G.js";function re(n){const e=new Map;return n.forEach(o=>{const u=o.annotation_label.annotation_label_name;u&&e.set(u,(e.get(u)||0)+1)}),e}function le(n,e){nt(e,!0);let o=kt(e,["$$slots","$$events","$$legacy"]);Pt(n,At({name:"move-left"},()=>o,{iconNode:[["path",{d:"M6 8L2 12L6 16"}],["path",{d:"M2 12H22"}]],children:(m,f)=>{var d=Mt(),p=rt(d);ht(p,()=>e.children??Tt),E(m,d)},$$slots:{default:!0}})),at()}function ue(n,e){nt(e,!0);let o=kt(e,["$$slots","$$events","$$legacy"]);Pt(n,At({name:"zoom-in"},()=>o,{iconNode:[["circle",{cx:"11",cy:"11",r:"8"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11"}]],children:(m,f)=>{var d=Mt(),p=rt(d);ht(p,()=>e.children??Tt),E(m,d)},$$slots:{default:!0}})),at()}function ce(n,e){nt(e,!0);let o=kt(e,["$$slots","$$events","$$legacy"]);Pt(n,At({name:"zoom-out"},()=>o,{iconNode:[["circle",{cx:"11",cy:"11",r:"8"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11"}]],children:(m,f)=>{var d=Mt(),p=rt(d);ht(p,()=>e.children??Tt),E(m,d)},$$slots:{default:!0}})),at()}var de=H('<div class="h-full w-full overflow-hidden"><div class="sample relative h-full w-full"><div class="absolute right-4 top-2 z-30"><!></div> <!></div></div>'),he=H('<div class="flex h-full w-full flex-col space-y-4"><div class="flex w-full items-center space-x-4"><!> <h2 data-testid="sample-filename" class="text-xl font-semibold tracking-tight"> </h2></div> <!> <div class="flex min-h-0 flex-1 gap-4"><div class="flex-1"><!></div> <div class="relative w-[375px]"><!></div></div></div>');function me(n,e){nt(e,!0);const[o,u]=jt(),m=()=>_t(w,"$lastGridType",o),f=()=>_t(B,"$selectedSampleAnnotationCropIds",o),d=()=>_t(y,"$selectedSampleIds",o),p=j(()=>{const I=ae.data.annotationId;if(I)return e.sample.annotations.find(Y=>Y.annotation_id===I)}),{lastGridType:w,selectedSampleIds:y,toggleSampleSelection:T,toggleSampleAnnotationCropSelection:D,selectedSampleAnnotationCropIds:B}=Kt();let P=st(!0);const L=()=>{tt(P,!s(P))},V=j(()=>!!s(p));var Z=he(),l=b(Z),G=b(l);const W=j(()=>m()==="samples"?Zt.toSamples(e.sample.dataset_id):Zt.toAnnotations(e.sample.dataset_id));gt(G,{variant:"outline",get href(){return s(W)},children:(I,Y)=>{le(I,{})},$$slots:{default:!0}});var X=N(G,2),S=b(X);_(X),_(l);var c=N(l,2);Vt(c,{class:"mb-4 bg-border-hard"});var M=N(c,2),x=b(M),O=b(x);Wt(O,{className:"h-full",children:(I,Y)=>{Lt(I,{className:"h-full",children:(t,i)=>{var a=de(),r=b(a),h=b(r),v=b(h);{var g=A=>{const F=j(()=>f().has(s(p).annotation_id));Gt(A,{onSelect:()=>D(s(p).annotation_id),get isSelected(){return s(F)}})},z=A=>{const F=j(()=>d().has(e.sample.sample_id));Gt(A,{onSelect:()=>T(e.sample.sample_id),get isSelected(){return s(F)}})};dt(v,A=>{s(V)&&s(p)?A(g):A(z,!1)})}_(h);var k=N(h,2);const q=j(()=>Yt+e.sample.file_path_abs);Ce(k,{get imageURL(){return s(q)},get annotations(){return e.sample.annotations},get imageWidth(){return e.sample.width},get imageHeight(){return e.sample.height},get showOnlySelectedAnnotation(){return s(P)},get selectedAnnotation(){return s(p)}}),_(r),_(a),E(t,a)},$$slots:{default:!0}})},$$slots:{default:!0}}),_(x);var C=N(x,2),R=b(C);Le(R,{get sample(){return e.sample},get selectedAnnotation(){return s(p)},get showOnlySelectedAnnotation(){return s(P)},toggleShowOnlySelectedAnnotation:L}),_(C),_(M),_(Z),J(()=>et(S,`Filename: "${e.sample.file_name??""}"`)),E(n,Z),at(),u()}var fe=H('<div class="pointer-events-auto absolute bottom-0 left-1 z-20 flex select-none items-center gap-1 rounded-lg bg-muted bg-opacity-80 shadow-md backdrop-blur-sm"><!> <div class="h-6 w-px bg-white bg-opacity-20"></div> <!> <div class="w-[32px] text-center text-sm text-muted-foreground" data-testid="zoom-level"> </div> <!></div>');function ve(n,e){var o=fe(),u=b(o);gt(u,{variant:"ghost","data-testid":"zoom-reset",size:"sm",get onclick(){return e.onZoomReset},get disabled(){return e.isResetDisabled},children:(w,y)=>{qt();var T=Xt("Reset");E(w,T)},$$slots:{default:!0}});var m=N(u,4);gt(m,{title:"zoom out",variant:"ghost",size:"icon","data-testid":"zoom-out",get onclick(){return e.onZoomOut},get disabled(){return e.isZoominDisabled},children:(w,y)=>{ce(w,{class:"h-4 w-4"})},$$slots:{default:!0}});var f=N(m,2),d=b(f);_(f);var p=N(f,2);gt(p,{title:"zoom in",variant:"ghost",size:"icon","data-testid":"zoom-in",get onclick(){return e.onZoomIn},get disabled(){return e.isZoomoutDisabled},children:(w,y)=>{ue(w,{class:"h-4 w-4"})},$$slots:{default:!0}}),_(o),J(w=>et(d,`${w??""}%`),[()=>Math.round(e.scale*100)]),E(n,o)}function K(n){return typeof n=="string"?new wt([[document.querySelector(n)]],[document.documentElement]):new wt([[n]],Jt)}function ge(n){let e;for(;e=n.sourceEvent;)n=e;return n}function it(n,e){if(n=ge(n),e===void 0&&(e=n.currentTarget),e){var o=e.ownerSVGElement||e;if(o.createSVGPoint){var u=o.createSVGPoint();return u.x=n.clientX,u.y=n.clientY,u=u.matrixTransform(e.getScreenCTM().inverse()),[u.x,u.y]}if(e.getBoundingClientRect){var m=e.getBoundingClientRect();return[n.clientX-m.left-e.clientLeft,n.clientY-m.top-e.clientTop]}}return[n.pageX,n.pageY]}function pe(n){return new wt([document.querySelectorAll(n)],[document.documentElement])}const zt={capture:!0,passive:!1};function St(n){n.preventDefault(),n.stopImmediatePropagation()}function _e(n){var e=n.document.documentElement,o=K(n).on("dragstart.drag",St,zt);"onselectstart"in e?o.on("selectstart.drag",St,zt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function ye(n,e){var o=n.document.documentElement,u=K(n).on("dragstart.drag",null);e&&(u.on("click.drag",St,zt),setTimeout(function(){u.on("click.drag",null)},0)),"onselectstart"in o?u.on("selectstart.drag",null):(o.style.MozUserSelect=o.__noselect,delete o.__noselect)}var xe=1e-12;function Rt(n){return((n=Math.exp(n))+1/n)/2}function be(n){return((n=Math.exp(n))-1/n)/2}function we(n){return((n=Math.exp(2*n))-1)/(n+1)}const ze=function n(e,o,u){function m(f,d){var p=f[0],w=f[1],y=f[2],T=d[0],D=d[1],B=d[2],P=T-p,L=D-w,V=P*P+L*L,Z,l;if(V<xe)l=Math.log(B/y)/e,Z=function(M){return[p+M*P,w+M*L,y*Math.exp(e*M*l)]};else{var G=Math.sqrt(V),W=(B*B-y*y+u*V)/(2*y*o*G),X=(B*B-y*y-u*V)/(2*B*o*G),S=Math.log(Math.sqrt(W*W+1)-W),c=Math.log(Math.sqrt(X*X+1)-X);l=(c-S)/e,Z=function(M){var x=M*l,O=Rt(S),C=y/(o*G)*(O*we(e*x+S)-be(S));return[p+C*P,w+C*L,y*O/Rt(e*x+S)]}}return Z.duration=l*1e3*e/Math.SQRT2,Z}return m.rho=function(f){var d=Math.max(.001,+f),p=d*d,w=p*p;return n(d,p,w)},m}(Math.SQRT2,2,4),vt=n=>()=>n;function Se(n,{sourceEvent:e,target:o,transform:u,dispatch:m}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},transform:{value:u,enumerable:!0,configurable:!0},_:{value:m}})}function bt(n){n.stopImmediatePropagation()}function lt(n){n.preventDefault(),n.stopImmediatePropagation()}function Me(n){return(!n.ctrlKey||n.type==="wheel")&&!n.button}function Te(){var n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,n.hasAttribute("viewBox")?(n=n.viewBox.baseVal,[[n.x,n.y],[n.x+n.width,n.y+n.height]]):[[0,0],[n.width.baseVal.value,n.height.baseVal.value]]):[[0,0],[n.clientWidth,n.clientHeight]]}function Ht(){return this.__zoom||It}function Ae(n){return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*(n.ctrlKey?10:1)}function ke(){return navigator.maxTouchPoints||"ontouchstart"in this}function Pe(n,e,o){var u=n.invertX(e[0][0])-o[0][0],m=n.invertX(e[1][0])-o[1][0],f=n.invertY(e[0][1])-o[0][1],d=n.invertY(e[1][1])-o[1][1];return n.translate(m>u?(u+m)/2:Math.min(0,u)||Math.max(0,m),d>f?(f+d)/2:Math.min(0,f)||Math.max(0,d))}function Ie(){var n=Me,e=Te,o=Pe,u=Ae,m=ke,f=[0,1/0],d=[[-1/0,-1/0],[1/0,1/0]],p=250,w=ze,y=Qt("start","zoom","end"),T,D,B,P=500,L=150,V=0,Z=10;function l(t){t.property("__zoom",Ht).on("wheel.zoom",x,{passive:!1}).on("mousedown.zoom",O).on("dblclick.zoom",C).filter(m).on("touchstart.zoom",R).on("touchmove.zoom",I).on("touchend.zoom touchcancel.zoom",Y).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}l.transform=function(t,i,a,r){var h=t.selection?t.selection():t;h.property("__zoom",Ht),t!==h?S(t,i,a,r):h.interrupt().each(function(){c(this,arguments).event(r).start().zoom(null,typeof i=="function"?i.apply(this,arguments):i).end()})},l.scaleBy=function(t,i,a,r){l.scaleTo(t,function(){var h=this.__zoom.k,v=typeof i=="function"?i.apply(this,arguments):i;return h*v},a,r)},l.scaleTo=function(t,i,a,r){l.transform(t,function(){var h=e.apply(this,arguments),v=this.__zoom,g=a==null?X(h):typeof a=="function"?a.apply(this,arguments):a,z=v.invert(g),k=typeof i=="function"?i.apply(this,arguments):i;return o(W(G(v,k),g,z),h,d)},a,r)},l.translateBy=function(t,i,a,r){l.transform(t,function(){return o(this.__zoom.translate(typeof i=="function"?i.apply(this,arguments):i,typeof a=="function"?a.apply(this,arguments):a),e.apply(this,arguments),d)},null,r)},l.translateTo=function(t,i,a,r,h){l.transform(t,function(){var v=e.apply(this,arguments),g=this.__zoom,z=r==null?X(v):typeof r=="function"?r.apply(this,arguments):r;return o(It.translate(z[0],z[1]).scale(g.k).translate(typeof i=="function"?-i.apply(this,arguments):-i,typeof a=="function"?-a.apply(this,arguments):-a),v,d)},r,h)};function G(t,i){return i=Math.max(f[0],Math.min(f[1],i)),i===t.k?t:new yt(i,t.x,t.y)}function W(t,i,a){var r=i[0]-a[0]*t.k,h=i[1]-a[1]*t.k;return r===t.x&&h===t.y?t:new yt(t.k,r,h)}function X(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function S(t,i,a,r){t.on("start.zoom",function(){c(this,arguments).event(r).start()}).on("interrupt.zoom end.zoom",function(){c(this,arguments).event(r).end()}).tween("zoom",function(){var h=this,v=arguments,g=c(h,v).event(r),z=e.apply(h,v),k=a==null?X(z):typeof a=="function"?a.apply(h,v):a,q=Math.max(z[1][0]-z[0][0],z[1][1]-z[0][1]),A=h.__zoom,F=typeof i=="function"?i.apply(h,v):i,Q=w(A.invert(k).concat(q/A.k),F.invert(k).concat(q/F.k));return function(U){if(U===1)U=F;else{var $=Q(U),pt=q/$[2];U=new yt(pt,k[0]-$[0]*pt,k[1]-$[1]*pt)}g.zoom(null,U)}})}function c(t,i,a){return!a&&t.__zooming||new M(t,i)}function M(t,i){this.that=t,this.args=i,this.active=0,this.sourceEvent=null,this.extent=e.apply(t,i),this.taps=0}M.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,i){return this.mouse&&t!=="mouse"&&(this.mouse[1]=i.invert(this.mouse[0])),this.touch0&&t!=="touch"&&(this.touch0[1]=i.invert(this.touch0[0])),this.touch1&&t!=="touch"&&(this.touch1[1]=i.invert(this.touch1[0])),this.that.__zoom=i,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var i=K(this.that).datum();y.call(t,this.that,new Se(t,{sourceEvent:this.sourceEvent,target:l,transform:this.that.__zoom,dispatch:y}),i)}};function x(t,...i){if(!n.apply(this,arguments))return;var a=c(this,i).event(t),r=this.__zoom,h=Math.max(f[0],Math.min(f[1],r.k*Math.pow(2,u.apply(this,arguments)))),v=it(t);if(a.wheel)(a.mouse[0][0]!==v[0]||a.mouse[0][1]!==v[1])&&(a.mouse[1]=r.invert(a.mouse[0]=v)),clearTimeout(a.wheel);else{if(r.k===h)return;a.mouse=[v,r.invert(v)],xt(this),a.start()}lt(t),a.wheel=setTimeout(g,L),a.zoom("mouse",o(W(G(r,h),a.mouse[0],a.mouse[1]),a.extent,d));function g(){a.wheel=null,a.end()}}function O(t,...i){if(B||!n.apply(this,arguments))return;var a=t.currentTarget,r=c(this,i,!0).event(t),h=K(t.view).on("mousemove.zoom",k,!0).on("mouseup.zoom",q,!0),v=it(t,a),g=t.clientX,z=t.clientY;_e(t.view),bt(t),r.mouse=[v,this.__zoom.invert(v)],xt(this),r.start();function k(A){if(lt(A),!r.moved){var F=A.clientX-g,Q=A.clientY-z;r.moved=F*F+Q*Q>V}r.event(A).zoom("mouse",o(W(r.that.__zoom,r.mouse[0]=it(A,a),r.mouse[1]),r.extent,d))}function q(A){h.on("mousemove.zoom mouseup.zoom",null),ye(A.view,r.moved),lt(A),r.event(A).end()}}function C(t,...i){if(n.apply(this,arguments)){var a=this.__zoom,r=it(t.changedTouches?t.changedTouches[0]:t,this),h=a.invert(r),v=a.k*(t.shiftKey?.5:2),g=o(W(G(a,v),r,h),e.apply(this,i),d);lt(t),p>0?K(this).transition().duration(p).call(S,g,r,t):K(this).call(l.transform,g,r,t)}}function R(t,...i){if(n.apply(this,arguments)){var a=t.touches,r=a.length,h=c(this,i,t.changedTouches.length===r).event(t),v,g,z,k;for(bt(t),g=0;g<r;++g)z=a[g],k=it(z,this),k=[k,this.__zoom.invert(k),z.identifier],h.touch0?!h.touch1&&h.touch0[2]!==k[2]&&(h.touch1=k,h.taps=0):(h.touch0=k,v=!0,h.taps=1+!!T);T&&(T=clearTimeout(T)),v&&(h.taps<2&&(D=k[0],T=setTimeout(function(){T=null},P)),xt(this),h.start())}}function I(t,...i){if(this.__zooming){var a=c(this,i).event(t),r=t.changedTouches,h=r.length,v,g,z,k;for(lt(t),v=0;v<h;++v)g=r[v],z=it(g,this),a.touch0&&a.touch0[2]===g.identifier?a.touch0[0]=z:a.touch1&&a.touch1[2]===g.identifier&&(a.touch1[0]=z);if(g=a.that.__zoom,a.touch1){var q=a.touch0[0],A=a.touch0[1],F=a.touch1[0],Q=a.touch1[1],U=(U=F[0]-q[0])*U+(U=F[1]-q[1])*U,$=($=Q[0]-A[0])*$+($=Q[1]-A[1])*$;g=G(g,Math.sqrt(U/$)),z=[(q[0]+F[0])/2,(q[1]+F[1])/2],k=[(A[0]+Q[0])/2,(A[1]+Q[1])/2]}else if(a.touch0)z=a.touch0[0],k=a.touch0[1];else return;a.zoom("touch",o(W(g,z,k),a.extent,d))}}function Y(t,...i){if(this.__zooming){var a=c(this,i).event(t),r=t.changedTouches,h=r.length,v,g;for(bt(t),B&&clearTimeout(B),B=setTimeout(function(){B=null},P),v=0;v<h;++v)g=r[v],a.touch0&&a.touch0[2]===g.identifier?delete a.touch0:a.touch1&&a.touch1[2]===g.identifier&&delete a.touch1;if(a.touch1&&!a.touch0&&(a.touch0=a.touch1,delete a.touch1),a.touch0)a.touch0[1]=this.__zoom.invert(a.touch0[0]);else if(a.end(),a.taps===2&&(g=it(g,this),Math.hypot(D[0]-g[0],D[1]-g[1])<Z)){var z=K(this).on("dblclick.zoom");z&&z.apply(this,arguments)}}}return l.wheelDelta=function(t){return arguments.length?(u=typeof t=="function"?t:vt(+t),l):u},l.filter=function(t){return arguments.length?(n=typeof t=="function"?t:vt(!!t),l):n},l.touchable=function(t){return arguments.length?(m=typeof t=="function"?t:vt(!!t),l):m},l.extent=function(t){return arguments.length?(e=typeof t=="function"?t:vt([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),l):e},l.scaleExtent=function(t){return arguments.length?(f[0]=+t[0],f[1]=+t[1],l):[f[0],f[1]]},l.translateExtent=function(t){return arguments.length?(d[0][0]=+t[0][0],d[1][0]=+t[1][0],d[0][1]=+t[0][1],d[1][1]=+t[1][1],l):[[d[0][0],d[0][1]],[d[1][0],d[1][1]]]},l.constrain=function(t){return arguments.length?(o=t,l):o},l.duration=function(t){return arguments.length?(p=+t,l):p},l.interpolate=function(t){return arguments.length?(w=t,l):w},l.on=function(){var t=y.on.apply(y,arguments);return t===y?l:t},l.clickDistance=function(t){return arguments.length?(V=(t=+t)*t,l):Math.sqrt(V)},l.tapDistance=function(t){return arguments.length?(Z=+t,l):Z},l}function Ee(n,e){let o=n.scaleIndependentXForm;o||(o=n.scaleIndependentXForm=e.createSVGTransform(),n.transform.baseVal.appendItem(o));const u=n.parentNode;if(u){const m=u.getScreenCTM();if(m){const f=m.inverse().multiply(e.getScreenCTM());f.e=f.f=0,o.setMatrix(f)}}}var De=H('<div class="relative flex h-full w-full select-none items-center justify-center"><!> <svg class="z-10 h-full w-full cursor-grab" preserveAspectRatio="xMidYMid meet"><g><image></image><!></g></svg> <svg class="pointer-events-none absolute inset-0" preserveAspectRatio="xMidYMid meet"></svg></div>');function Ce(n,e){nt(e,!0);let o=st(null),u=st(null),m=st(800),f=st(600);Nt(()=>{if(!s(o))return;tt(m,ot(s(o).clientWidth)),tt(f,ot(s(o).clientHeight));const c=new ResizeObserver(()=>{s(o)&&(tt(m,ot(s(o).clientWidth)),tt(f,ot(s(o).clientHeight)))});return c.observe(s(o)),()=>c.disconnect()});const d=j(()=>e.selectedAnnotation&&e.showOnlySelectedAnnotation?[e.selectedAnnotation]:e.annotations),p=10,w=j(()=>{const c={x:0,y:0,width:e.imageWidth,height:e.imageHeight};if(e.selectedAnnotation){const{x:M,y:x,width:O,height:C}=e.selectedAnnotation;return{x:Math.round(Math.max(0,M-p)),y:Math.round(Math.max(0,x-p)),width:Math.round(Math.min(e.imageWidth-M,O+p*2)),height:Math.round(Math.min(e.imageHeight-x,C+p*2))}}return c});let y=st(ot({k:1,x:0,y:0}));const T=j(()=>{if(!s(o))return 1;const c=s(m)/e.imageWidth,M=s(f)/e.imageHeight,x=Math.min(c,M);return s(y).k*x});let D=st(null);const B=()=>{s(o)&&(tt(D,ot(Ie().on("zoom",c=>{tt(y,ot(c.transform))}).filter(c=>(!c.ctrlKey||c.type==="wheel")&&!c.button&&!(c.type==="mousedown"&&c.button===2)).wheelDelta(c=>-c.deltaY*.002))),K(s(o)).call(s(D)).on("dblclick.zoom",null))},P=c=>{if(!s(o)||!s(D))return;const M=c?1.5:.75;K(s(o)).transition().duration(300).call(s(D).scaleBy,M)},L=()=>{!s(o)||!s(D)||K(s(o)).transition().duration(300).call(s(D).transform,It)};Ut(()=>{B()}),Nt(()=>{s(y).k,pe(".unscaled").each(function(){Ee(this,s(u))})});var V=De(),Z=b(V);ve(Z,{get scale(){return s(T)},onZoomIn:()=>P(!0),onZoomOut:()=>P(!1),onZoomReset:L});var l=N(Z,2),G=b(l),W=b(G),X=N(W);ut(X,17,()=>s(d),c=>c.annotation_id,(c,M)=>{oe(c,{get annotation(){return s(M)},showLabel:!0,get imageWidth(){return e.imageWidth}})}),_(G),_(l),Bt(l,c=>tt(o,c),()=>s(o));var S=N(l,2);ct(S,"viewBox","0 0 1024 768"),Bt(S,c=>tt(u,c),()=>s(u)),_(V),J(()=>{ct(l,"viewBox",`${s(w).x} ${s(w).y} ${s(w).width} ${s(w).height}`),ct(G,"transform",`translate(${s(y).x}, ${s(y).y}) scale(${s(y).k})`),ct(W,"href",e.imageURL)}),E(n,V),at()}var Ne=H('<span class="text-sm"> </span> <span class="break-all text-sm"> </span>',1),Be=H('<div class="flex flex-col gap-4"><!> <div class="grid grid-cols-[6rem_1fr] gap-y-3 text-diffuse-foreground"></div></div>'),Oe=H("<div> </div>"),Ze=H('<div class="flex gap-1"></div>'),Ge=H('<div class="flex items-center justify-between gap-2 rounded-sm bg-card px-5 py-2"><div class="text-sm"> </div> <div class="text-sm"> </div></div>'),Re=H('<div class="flex flex-col gap-2"></div>'),He=H('<span class="text-sm"> </span> <span class="break-all text-sm"> </span>',1),Ve=H('<div class="grid grid-cols-[6rem_1fr] gap-y-3 text-diffuse-foreground"></div>'),We=H('<div class="flex-none"><div class="mb-2.5 text-lg font-semibold">Sample details</div> <!></div> <div class="flex h-full min-h-0 flex-col space-y-2 overflow-y-auto dark:[color-scheme:dark]"><!> <!> <!> <!></div>',1);function Le(n,e){nt(e,!0);const o=e.sample.tags,u=re(e.sample.annotations),m=[{label:"Height:",value:mt(e.sample.height)+"px"},{label:"Width:",value:mt(e.sample.width)+"px"},{label:"Filename:",value:e.sample.file_name},{label:"Filepath:",value:e.sample.file_path_abs}],f=j(()=>e.selectedAnnotation?[{label:"Height:",value:mt(Math.round(e.selectedAnnotation.height))+"px"},{label:"Width:",value:mt(Math.round(e.selectedAnnotation.width))+"px"},{label:"Annotation:",value:e.selectedAnnotation.annotation_label.annotation_label_name},{label:"Type:",value:"Bounding box"}]:[]);Wt(n,{className:"h-full",children:(d,p)=>{Lt(d,{className:"h-full flex flex-col",children:(w,y)=>{var T=We(),D=rt(T),B=N(b(D),2);Vt(B,{class:"mb-4 bg-border-hard"}),_(D);var P=N(D,2),L=b(P);{var V=S=>{ft(S,{title:"Selected annotation",children:(c,M)=>{var x=Be(),O=b(x);se(O,{name:"show-all",label:"Show only selected annotation",get isChecked(){return e.showOnlySelectedAnnotation},helperText:"Hides other annotations for clarity.",get onCheckedChange(){return e.toggleShowOnlySelectedAnnotation}});var C=N(O,2);ut(C,21,()=>s(f),({label:R,value:I})=>R,(R,I)=>{let Y=()=>s(I).label,t=()=>s(I).value;var i=Ne(),a=rt(i),r=b(a,!0);_(a);var h=N(a,2),v=b(h,!0);_(h),J(()=>{et(r,Y()),et(v,t())}),E(R,i)}),_(C),_(x),E(c,x)}})};dt(L,S=>{e.selectedAnnotation&&S(V)})}var Z=N(L,2);{var l=S=>{ft(S,{title:"Tags",icon:ee,children:(c,M)=>{var x=Ze();ut(x,21,()=>o,Ot,(O,C)=>{var R=Oe(),I=b(R,!0);_(R),J(Y=>{Ct(R,1,Y),et(I,s(C).name)},[()=>Et(Dt("inline rounded-lg bg-card px-2 py-2 text-xs"))]),E(O,R)}),_(x),E(c,x)}})};dt(Z,S=>{o.length>0&&S(l)})}var G=N(Z,2);{var W=S=>{ft(S,{title:"Annotations",children:(c,M)=>{var x=Re();ut(x,21,()=>u,Ot,(O,C)=>{var R=Ge(),I=b(R),Y=b(I,!0);_(I);var t=N(I,2),i=b(t);_(t),_(R),J(a=>{et(Y,s(C)[0]),$t(t,`color: ${a??""};`),et(i,`(${s(C)[1]??""})`)},[()=>ie(s(C)[0]).color]),E(O,R)}),_(x),E(c,x)}})};dt(G,S=>{u.size>0&&S(W)})}var X=N(G,2);ft(X,{title:"Metadata",children:(S,c)=>{var M=Ve();ut(M,21,()=>m,({label:x,value:O})=>x,(x,O)=>{let C=()=>s(O).label,R=()=>s(O).value;var I=He(),Y=rt(I),t=b(Y,!0);_(Y);var i=N(Y,2),a=b(i,!0);_(i),J(()=>{et(t,C()),et(a,R())}),E(x,I)}),_(M),E(S,M)}}),_(P),E(w,T)},$$slots:{default:!0}})},$$slots:{default:!0}}),at()}var Ye=H("<div><!></div>");function Wt(n,e){nt(e,!0);var o=Ye(),u=b(o);ht(u,()=>e.children),_(o),J(m=>Ct(o,1,m),[()=>Et(Dt("rounded-lg border border-gray-800 bg-black",e.className))]),E(n,o),at()}var Fe=H("<div><!></div>");function Lt(n,e){nt(e,!0);var o=Fe(),u=b(o);ht(u,()=>e.children),_(o),J(m=>Ct(o,1,m),[()=>Et(Dt("p-4",e.className))]),E(n,o),at()}const Xe=async({sample_id:n})=>{const e={data:void 0,error:void 0};try{const o=await Ft.GET("/api/samples/{sample_id}",{params:{path:{sample_id:n}}});if(o.error)throw new Error(JSON.stringify(o.error,null,2));if(!o.data)throw new Error("No data");e.data=o.data}catch(o){e.error="Error loading sample: "+String(o)}return e},qe=async({params:n,url:e})=>{const{sample_id:o}=n,{data:u,error:m}=await Xe({sample_id:o});return{sample:u,annotationId:e.searchParams.get("annotationId"),error:m}},dn=Object.freeze(Object.defineProperty({__proto__:null,load:qe},Symbol.toStringTag,{value:"Module"}));var Ue=H("<a>Go home</a>"),je=H('<div class="flex h-full w-full space-x-4 px-4 pb-4"><div class="h-full w-full space-y-6 rounded-[1vw] bg-card p-4"><!></div></div>');function hn(n,e){nt(e,!0);const o=te(),[u,m]=o;var f=je(),d=b(f),p=b(d);{var w=T=>{me(T,{get sample(){return e.data.sample}})},y=T=>{ne(T,{title:"Sample not found",children:(D,B)=>{var P=Ue();J(L=>ct(P,"href",L),[()=>u("/",void 0)]),E(D,P)}})};dt(p,T=>{e.data.sample?T(w):T(y,!1)})}_(d),_(f),E(n,f),at()}export{hn as component,dn as universal};
