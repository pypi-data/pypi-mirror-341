[build-system]
requires = [
    "pdm-backend",
]
build-backend = "pdm.backend"

[project]
name = "fastapi-channels"
dynamic = []
description = "This project provides a simple setup for creating WebSocket communication channels using FastAPI."
readme = "README.md"
requires-python = ">=3.8"
authors = [
    { name = "BXZDYG", email = "banxingzhedeyangguang@gmail.com" },
]
keywords = [
    "fastapi",
    "broadcaster",
    "pydantic",
    "fastapi-channels",
    "limits",
]
classifiers = [
    "Operating System :: OS Independent",
    "Intended Audience :: Information Technology",
    "Intended Audience :: System Administrators",
    "Typing :: Typed",
    "Development Status :: 4 - Beta",
    "Environment :: Web Environment",
    "Framework :: AsyncIO",
    "Framework :: FastAPI",
    "Framework :: Pydantic",
    "Framework :: Pydantic :: 1",
    "Intended Audience :: Developers",
    "License :: OSI Approved :: MIT License",
    "Programming Language :: Python",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3 :: Only",
    "Programming Language :: Python :: 3.8",
    "Programming Language :: Python :: 3.9",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Topic :: Internet",
    "Topic :: Internet :: WWW/HTTP",
    "Topic :: Internet :: WWW/HTTP :: HTTP Servers",
    "Topic :: Software Development",
    "Topic :: Software Development :: Libraries",
    "Topic :: Software Development :: Libraries :: Python Modules",
]
dependencies = [
    "fastapi>=0.110.0",
    "broadcaster>=0.3.1",
    "limits>=3.12.0",
    "pydantic>=1.7.4,!=1.8,!=1.8.1,!=2.0.0,!=2.0.1,!=2.1.0,<3.0.0",
    "typing-extensions>=4.8.0",
]
version = "0.0.1b2"

[project.urls]
Homepage = "https://github.com/YGuang233/fastapi-channels"
Documentation = "https://fc.bxzdyg.cn/"
Repository = "https://github.com/YGuang233/fastapi-channels"
Issues = "https://github.com/YGuang233/fastapi-channels/issues"
Changelog = "https:/fc.bxzdyg.cn/release-notes/"

[project.optional-dependencies]
standard = [
    "fastapi[standard] >=0.110.0",
]
all = [
    "fastapi[all] >=0.110.0",
]
redis = [
    "redis",
    "fastapi_limiter<=0.1.6",
]
postgres = [
    "asyncpg",
]
kafka = [
    "aiokafka",
]
test = [
    "pytest",
    "pytest-asyncio",
]

[tool.pdm]
distribution = true

[tool.pdm.version]
source = "file"
path = "fastapi_channels/__init__.py"

[tool.pdm.resolution]
allow-prereleases = true

[tool.pdm.build]
package-dir = "fastapi-channels"
includes = [
    "fastapi_channels/",
]
excludes = [
    "fastapi_channels/utils",
    "./**/*_d.py",
    ".gitignore",
    "tests",
    "./**/0.0.1b0",
]

[tool.mypy]
strict = true

[[tool.mypy.overrides]]
module = "tests.*"
ignore_missing_imports = true
check_untyped_defs = true

[[tool.mypy.overrides]]
module = "docs_src.*"
disallow_incomplete_defs = false
disallow_untyped_defs = false
disallow_untyped_calls = false

[tool.pytest.ini_options]
addopts = [
    "--strict-config",
    "--strict-markers",
    "--ignore=docs_src",
]
xfail_strict = true
junit_family = "xunit2"
filterwarnings = [
    "error",
    "ignore:starlette.middleware.wsgi is deprecated and will be removed in a future release\\..*:DeprecationWarning:starlette",
    "ignore:'crypt' is deprecated and slated for removal in Python 3.13:DeprecationWarning",
    "ignore:You seem to already have a custom.*:RuntimeWarning:trio",
    "ignore:datetime\\.datetime\\.utcfromtimestamp\\(\\) is deprecated and scheduled for removal in a future version\\..*:DeprecationWarning:sqlalchemy",
    "ignore:The `hash` argument is deprecated*:DeprecationWarning:trio",
]

[tool.coverage.run]
parallel = true
data_file = "coverage/.coverage"
source = [
    "docs_src",
    "tests",
    "fastapi_channels",
]
context = "${CONTEXT}"
dynamic_context = "test_function"
omit = [
    "docs_src/response_model/tutorial003_04.py",
    "docs_src/response_model/tutorial003_04_py310.py",
]

[tool.coverage.report]
show_missing = true
sort = "-Cover"

[tool.coverage.html]
show_contexts = true

[tool.ruff.lint]
select = [
    "E",
    "W",
    "F",
    "I",
    "B",
    "C4",
    "UP",
]
ignore = [
    "E501",
    "B008",
    "C901",
    "W191",
]

[tool.ruff.lint.per-file-ignores]
"__init__.py" = [
    "F401",
]

[tool.ruff.lint.isort]
known-third-party = [
    "fastapi",
    "pydantic",
    "starlette",
    "boradcaster",
    "limits",
    "fastapi-limiter",
    "websockets",
]

[tool.ruff.lint.pyupgrade]
keep-runtime-typing = true

[tool.inline-snapshot]
